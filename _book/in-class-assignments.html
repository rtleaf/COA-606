<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>22 In-Class Assignments | _main.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="22 In-Class Assignments | _main.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="22 In-Class Assignments | _main.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="two-way-independent-anova.html"/>

<script src="book_assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="book_assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="book_assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="book_assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="book_assets/kePrint-0.0.1/kePrint.js"></script>
<link href="book_assets/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Biometry for the Coastal Sciences (COA 606)</a></li>
<li class="chapter" data-level="2" data-path="univariate-data.html"><a href="univariate-data.html"><i class="fa fa-check"></i><b>2</b> Univariate Data</a></li>
<li class="chapter" data-level="3" data-path="best-practices-for-data-management.html"><a href="best-practices-for-data-management.html"><i class="fa fa-check"></i><b>3</b> Best Practices For Data Management</a></li>
<li class="chapter" data-level="4" data-path="working-in-r.html"><a href="working-in-r.html"><i class="fa fa-check"></i><b>4</b> Working in R</a></li>
<li class="chapter" data-level="5" data-path="data-classes-in-r.html"><a href="data-classes-in-r.html"><i class="fa fa-check"></i><b>5</b> Data Classes in R</a></li>
<li class="chapter" data-level="6" data-path="data-input-and-output-io.html"><a href="data-input-and-output-io.html"><i class="fa fa-check"></i><b>6</b> Data input and output (IO)</a></li>
<li class="chapter" data-level="7" data-path="sampling.html"><a href="sampling.html"><i class="fa fa-check"></i><b>7</b> Sampling</a></li>
<li class="chapter" data-level="8" data-path="central-limit-theorem.html"><a href="central-limit-theorem.html"><i class="fa fa-check"></i><b>8</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="9" data-path="measures-of-central-tendency.html"><a href="measures-of-central-tendency.html"><i class="fa fa-check"></i><b>9</b> Measures of Central Tendency</a></li>
<li class="chapter" data-level="10" data-path="measures-of-dispersion.html"><a href="measures-of-dispersion.html"><i class="fa fa-check"></i><b>10</b> Measures of Dispersion</a></li>
<li class="chapter" data-level="11" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html"><i class="fa fa-check"></i><b>11</b> The Normal Distribution</a></li>
<li class="chapter" data-level="12" data-path="confidence-interval.html"><a href="confidence-interval.html"><i class="fa fa-check"></i><b>12</b> Confidence Interval</a></li>
<li class="chapter" data-level="13" data-path="null-hypothesis-significance-testing-nhst.html"><a href="null-hypothesis-significance-testing-nhst.html"><i class="fa fa-check"></i><b>13</b> Null Hypothesis Significance Testing (NHST)</a></li>
<li class="chapter" data-level="14" data-path="one--and-two-tailed-tests.html"><a href="one--and-two-tailed-tests.html"><i class="fa fa-check"></i><b>14</b> One- and Two-Tailed Tests</a></li>
<li class="chapter" data-level="15" data-path="statistical-power.html"><a href="statistical-power.html"><i class="fa fa-check"></i><b>15</b> Statistical Power</a></li>
<li class="chapter" data-level="16" data-path="bivariate-relationships.html"><a href="bivariate-relationships.html"><i class="fa fa-check"></i><b>16</b> Bivariate Relationships</a></li>
<li class="chapter" data-level="17" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>17</b> Linear Regression</a></li>
<li class="chapter" data-level="18" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html"><i class="fa fa-check"></i><b>18</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="19" data-path="comparing-two-means-using-t-tests.html"><a href="comparing-two-means-using-t-tests.html"><i class="fa fa-check"></i><b>19</b> Comparing Two Means using <em>t</em>-tests</a></li>
<li class="chapter" data-level="20" data-path="analysis-of-variance-anova.html"><a href="analysis-of-variance-anova.html"><i class="fa fa-check"></i><b>20</b> Analysis of Variance (ANOVA)</a></li>
<li class="chapter" data-level="21" data-path="two-way-independent-anova.html"><a href="two-way-independent-anova.html"><i class="fa fa-check"></i><b>21</b> Two-Way Independent ANOVA</a></li>
<li class="chapter" data-level="22" data-path="in-class-assignments.html"><a href="in-class-assignments.html"><i class="fa fa-check"></i><b>22</b> In-Class Assignments</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="in-class-assignments" class="section level1 hasAnchor" number="22">
<h1><span class="header-section-number">22</span> In-Class Assignments<a href="in-class-assignments.html#in-class-assignments" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="r-class" class="section level2 hasAnchor" number="22.1">
<h2><span class="header-section-number">22.1</span> R Class<a href="in-class-assignments.html#r-class" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here are some programming questions based on the material we examined in class:</p>
<div id="arithmetic-operators-and-expressions" class="section level3 hasAnchor" number="22.1.1">
<h3><span class="header-section-number">22.1.1</span> Arithmetic Operators and Expressions<a href="in-class-assignments.html#arithmetic-operators-and-expressions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Calculate the result of <code>5 + 5 / 2</code>.</li>
<li>Evaluate <code>3 * 2^2</code>.</li>
<li>Compute the value of <code>(3*2)^2</code>.</li>
<li>Given <code>z &lt;- 5</code> and <code>w &lt;- c(3,7,9,2)</code>, what is the result of <code>z + w[3]</code>?</li>
</ol>
</div>
<div id="working-with-vectors" class="section level3 hasAnchor" number="22.1.2">
<h3><span class="header-section-number">22.1.2</span> Working with Vectors<a href="in-class-assignments.html#working-with-vectors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol start="5" style="list-style-type: decimal">
<li>Assign the variable <code>x</code> to be a vector containing the values 5, 5, 6, 2.</li>
<li>Assign the variable <code>y</code> to be a vector containing the values 3, 3, 1, 7.</li>
<li>Calculate the sum of vectors <code>x</code> and <code>y</code>.</li>
<li>Subtract vector <code>y</code> from vector <code>x</code>.</li>
<li>Assign vector <code>d</code> as the result of dividing vector <code>y</code> by vector <code>x</code>.</li>
</ol>
</div>
<div id="exponentiation-and-missing-values" class="section level3 hasAnchor" number="22.1.3">
<h3><span class="header-section-number">22.1.3</span> Exponentiation and Missing Values<a href="in-class-assignments.html#exponentiation-and-missing-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol start="12" style="list-style-type: decimal">
<li>Calculate <code>z^5 + 2</code>.</li>
<li>Compute <code>(s / 3 + 33)^0.5</code>.</li>
</ol>
</div>
<div id="dealing-with-missing-values-1" class="section level3 hasAnchor" number="22.1.4">
<h3><span class="header-section-number">22.1.4</span> Dealing with Missing Values<a href="in-class-assignments.html#dealing-with-missing-values-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol start="14" style="list-style-type: decimal">
<li>Given <code>dat.1 &lt;- c(-1,NA,1,1,-1)</code>, replace the missing values with zeros.</li>
<li>Calculate the mean of <code>dat.1</code> without removing missing values.</li>
<li>Calculate the mean of <code>dat.1</code> after removing missing values.</li>
</ol>
</div>
<div id="data-classes-and-basic-types" class="section level3 hasAnchor" number="22.1.5">
<h3><span class="header-section-number">22.1.5</span> Data Classes and Basic Types<a href="in-class-assignments.html#data-classes-and-basic-types" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol start="17" style="list-style-type: decimal">
<li>Create a numeric variable <code>num</code> with the value 1.2.</li>
<li>Convert 2.2 to an integer and assign it to the variable <code>int</code>.</li>
<li>Create a character variable <code>char</code> with the value “datacamp”.</li>
<li>Create a logical variable <code>log_true</code> with the value TRUE.</li>
</ol>
</div>
<div id="factors-and-lists" class="section level3 hasAnchor" number="22.1.6">
<h3><span class="header-section-number">22.1.6</span> Factors and Lists<a href="in-class-assignments.html#factors-and-lists" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol start="21" style="list-style-type: decimal">
<li>Create a factor variable <code>fac</code> with the levels “good”, “bad”, “ugly”.</li>
<li>Access the second level of the factor <code>fac</code>.</li>
<li>Create a list <code>combined_list</code> containing vectors <code>lis1</code>, <code>lis2</code>, and <code>lis3</code>.</li>
<li>Access the third element of the third vector in <code>combined_list</code>.</li>
</ol>
</div>
<div id="matrix-and-dataframe" class="section level3 hasAnchor" number="22.1.7">
<h3><span class="header-section-number">22.1.7</span> Matrix and DataFrame<a href="in-class-assignments.html#matrix-and-dataframe" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol start="25" style="list-style-type: decimal">
<li>Create a 2x3 matrix <code>M</code> with values from 1 to 6 filled by rows.</li>
<li>Create a 2x3 matrix <code>M</code> with values from 1 to 6 filled by columns.</li>
<li>Create a data frame <code>dataset</code> with columns: Person, Age, Weight, Height, Salary.</li>
<li>Calculate the number of rows in the data frame <code>dataset</code>.</li>
</ol>
</div>
<div id="data-input-and-output" class="section level3 hasAnchor" number="22.1.8">
<h3><span class="header-section-number">22.1.8</span> Data Input and Output<a href="in-class-assignments.html#data-input-and-output" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol start="29" style="list-style-type: decimal">
<li>Read the CSV file named “co2.csv” located in the “./Data/” directory.</li>
<li>Use the “read_xlsx” function to read the Excel sheet named “Sheet1” from the file “Codes.xlsx” in the “./Data/” directory.</li>
<li>How many different ways can you create a vector labeled <code>q</code> containing two 3’s and four 5’s?</li>
<li>Assign a vector of elements 3, 7, 9, and 2 to <code>w</code>.</li>
<li>Assign the third element of <code>w</code> to <code>s</code>, where <code>s</code> is equal to 6.</li>
<li>Calculate the length of a sequence that starts at 1.1, ends at 9.2, and has increments of 0.894.</li>
<li>What is the third value of the sequence you created?</li>
<li>Create a data frame <code>site.name</code> with values “Site.01” and “Site.02”.</li>
<li>Create a data frame <code>density</code> with values 2.3, 2.3, 2.3, 2.3, 2.3, 2.3.</li>
<li>Create a data frame <code>abundance</code> with values from 14.5 to 19.8 in equal intervals.</li>
<li>Create a logical vector <code>sampled.</code> with values FALSE, TRUE, FALSE, FALSE, TRUE, FALSE.</li>
<li>Create a data frame <code>y.data.frame</code> with columns site.name, density, abundance, and sampled.</li>
<li>Calculate the number of rows in the data frame <code>y.data.frame</code>.</li>
<li>Read the CSV file named “output.csv” from the “./Data/” directory.</li>
<li>Convert the data in the Excel file “Codes.xlsx” (Sheet1) to a data frame.</li>
<li>Download the CSV file from the given URL and save it as “output.csv” in the “./Data/” directory.</li>
</ol>
<p>Feel free to use these questions for practicing and testing your knowledge of R programming concepts. If you have any specific doubts or need further explanations, please let me know!</p>
</div>
</div>
<div id="sampling-1" class="section level2 hasAnchor" number="22.2">
<h2><span class="header-section-number">22.2</span> Sampling<a href="in-class-assignments.html#sampling-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="create-a-vector-consisting-of-random-draws-from-a-normal-distribution-with-mean-2-sd-1-with-at-least-20-samples." class="section level3 hasAnchor" number="22.2.1">
<h3><span class="header-section-number">22.2.1</span> Create a vector consisting of random draws from a normal distribution with (mean = 2, sd = 1) with at least 20 samples.<a href="in-class-assignments.html#create-a-vector-consisting-of-random-draws-from-a-normal-distribution-with-mean-2-sd-1-with-at-least-20-samples." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: lower-alpha">
<li><p>Take 5 samples (without replacement) from this distribution and calculate all of the sample statistics you can think of.</p></li>
<li><p>Now take an increasing large number of samples (without replacement), n = 8, 10,15, …20. For each iteration of random draws record the test statistics.</p></li>
<li><p>Make a table and comment on how the CV changes as the number of sakples increases.</p></li>
</ol>
</div>
<div id="your-turn-to-perform-a-simulation" class="section level3 hasAnchor" number="22.2.2">
<h3><span class="header-section-number">22.2.2</span> Your turn to perform a simulation<a href="in-class-assignments.html#your-turn-to-perform-a-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the function below I find that the taking more samples and that seems to give a more satisfactory result.</p>
<p>This is an evaluation of how sample size influences summary statistics. In your own words, how does increasing sample size change our understanding of the estimate of <span class="math inline">\(\bar{X}\)</span> and <span class="math inline">\(sd\)</span>?</p>
<p>Add some code to calculate and plot the CV for each of the samples. What do you conclude from the simulation?</p>
<p>Summary stats are descriptive statistics that describe the characteristics of distributions.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="in-class-assignments.html#cb89-1" tabindex="-1"></a><span class="co"># Here is another function to help us evaluate this:</span></span>
<span id="cb89-2"><a href="in-class-assignments.html#cb89-2" tabindex="-1"></a>samp.eval.fun <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">samples. =</span> <span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">500</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb89-3"><a href="in-class-assignments.html#cb89-3" tabindex="-1"></a>                          <span class="at">mean.val =</span> <span class="dv">2</span>,</span>
<span id="cb89-4"><a href="in-class-assignments.html#cb89-4" tabindex="-1"></a>                          <span class="at">sd.val =</span> <span class="dv">1</span>) {</span>
<span id="cb89-5"><a href="in-class-assignments.html#cb89-5" tabindex="-1"></a>  </span>
<span id="cb89-6"><a href="in-class-assignments.html#cb89-6" tabindex="-1"></a>  norm.dist <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">mean =</span> mean.val, <span class="at">sd =</span> sd.val)</span>
<span id="cb89-7"><a href="in-class-assignments.html#cb89-7" tabindex="-1"></a>  sum.mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(samples.), <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb89-8"><a href="in-class-assignments.html#cb89-8" tabindex="-1"></a>  </span>
<span id="cb89-9"><a href="in-class-assignments.html#cb89-9" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(samples.)) {</span>
<span id="cb89-10"><a href="in-class-assignments.html#cb89-10" tabindex="-1"></a>    samp.vect <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> norm.dist, <span class="at">size =</span> samples.[j], <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb89-11"><a href="in-class-assignments.html#cb89-11" tabindex="-1"></a>  sum.mat[j,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(samp.vect)</span>
<span id="cb89-12"><a href="in-class-assignments.html#cb89-12" tabindex="-1"></a>  sum.mat[j,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(samp.vect)</span>
<span id="cb89-13"><a href="in-class-assignments.html#cb89-13" tabindex="-1"></a>  sum.mat[j,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">min</span>(samp.vect)</span>
<span id="cb89-14"><a href="in-class-assignments.html#cb89-14" tabindex="-1"></a>  sum.mat[j,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">max</span>(samp.vect)</span>
<span id="cb89-15"><a href="in-class-assignments.html#cb89-15" tabindex="-1"></a>  }</span>
<span id="cb89-16"><a href="in-class-assignments.html#cb89-16" tabindex="-1"></a>  </span>
<span id="cb89-17"><a href="in-class-assignments.html#cb89-17" tabindex="-1"></a>  <span class="fu">plot</span>(samples., sum.mat[,<span class="dv">1</span>], </span>
<span id="cb89-18"><a href="in-class-assignments.html#cb89-18" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;Number of Samples&quot;</span>, </span>
<span id="cb89-19"><a href="in-class-assignments.html#cb89-19" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;Mean of Samples&quot;</span>, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>)</span>
<span id="cb89-20"><a href="in-class-assignments.html#cb89-20" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> mean.val, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb89-21"><a href="in-class-assignments.html#cb89-21" tabindex="-1"></a>  <span class="fu">plot</span>(samples., sum.mat[,<span class="dv">2</span>], </span>
<span id="cb89-22"><a href="in-class-assignments.html#cb89-22" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;Number of Samples&quot;</span>, </span>
<span id="cb89-23"><a href="in-class-assignments.html#cb89-23" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;SD of Samples&quot;</span>, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>)</span>
<span id="cb89-24"><a href="in-class-assignments.html#cb89-24" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> sd.val, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb89-25"><a href="in-class-assignments.html#cb89-25" tabindex="-1"></a>}</span>
<span id="cb89-26"><a href="in-class-assignments.html#cb89-26" tabindex="-1"></a></span>
<span id="cb89-27"><a href="in-class-assignments.html#cb89-27" tabindex="-1"></a><span class="co"># Copy this code into your console. You will notice that in your </span></span>
<span id="cb89-28"><a href="in-class-assignments.html#cb89-28" tabindex="-1"></a><span class="co"># history window samp.eval.fun will show up as a function...</span></span>
<span id="cb89-29"><a href="in-class-assignments.html#cb89-29" tabindex="-1"></a><span class="co"># Now you can change the argument &quot;samples.&quot;</span></span>
<span id="cb89-30"><a href="in-class-assignments.html#cb89-30" tabindex="-1"></a></span>
<span id="cb89-31"><a href="in-class-assignments.html#cb89-31" tabindex="-1"></a><span class="fu">samp.eval.fun</span>()</span></code></pre></div>
</div>
</div>
<div id="measures-of-dispersion-and-central-tendency" class="section level2 hasAnchor" number="22.3">
<h2><span class="header-section-number">22.3</span> Measures of dispersion and central tendency<a href="in-class-assignments.html#measures-of-dispersion-and-central-tendency" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>mtcars</code> dataset is part of the base R package <code>datasets</code>, the <code>flights</code> dataset is part of the <code>nycflights13</code> package. You’ll need to install and load <code>nycflights13</code> to access the <code>flights</code> dataset.</p>
<div id="measures-of-central-tendency-1" class="section level3 hasAnchor" number="22.3.1">
<h3><span class="header-section-number">22.3.1</span> Measures of central tendency<a href="in-class-assignments.html#measures-of-central-tendency-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><strong>Mean</strong></li>
</ol>
<ul>
<li>What is the average <code>mpg</code> (miles per gallon) for cars in the <code>mtcars</code> dataset?</li>
<li>Find the mean <code>air_time</code> of flights in the <code>flights</code> dataset.</li>
<li>Why might the mean not always be a representative measure of central tendency? How might outliers affect our perception of the “center” of the data?</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><strong>Median</strong></li>
</ol>
<ul>
<li>Identify the median <code>hp</code> (horsepower) in the <code>mtcars</code> dataset.</li>
<li>Calculate the median <code>departure delay</code> (<code>dep_delay</code>) for all flights in the <code>flights</code> dataset.</li>
<li>In what scenarios would the median be a more appropriate measure of central tendency than the mean, especially in skewed distributions or when outliers are present?</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><strong>Mode</strong></li>
</ol>
<ul>
<li>Determine the mode of the <code>gear</code> column in the <code>mtcars</code> dataset.</li>
<li>What is the most common departure hour (<code>hour</code> column) in the <code>flights</code> dataset?</li>
<li>How might the mode, as the most frequent value, fail to capture the overall nature of a dataset? Why isn’t the mode as commonly used as the mean or median for numerical data?</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li><strong>Putting it all together</strong></li>
</ol>
<ul>
<li>For the <code>wt</code> (weight) column in <code>mtcars</code>, find the mean, median, and mode.</li>
<li>Calculate the mean, median, and mode for the <code>distance</code> column in the <code>flights</code> dataset.</li>
<li>Using the information you obtained above, yhen might looking at all three measures (mean, median, mode) together provide a clearer picture of data distribution? How can discrepancies among these measures guide data interpretation? Making histograms or boxplot may help…</li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li><strong>Transformations and Central Tendency</strong></li>
</ol>
<ul>
<li>Calculate the mean <code>mpg</code> in the <code>mtcars</code> dataset before and after applying a logarithmic transformation.</li>
<li>Find the median <code>arrival delay</code> (<code>arr_delay</code>) in the <code>flights</code> dataset for both raw and squared values.</li>
<li>Make a histogram, which (transformed or untransformed) provides the best understanding of central tendency? Why might certain transformations be used, and how do they influence data interpretation?</li>
</ul>
</div>
<div id="measures-of-dispersion-1" class="section level3 hasAnchor" number="22.3.2">
<h3><span class="header-section-number">22.3.2</span> Measures of dispersion<a href="in-class-assignments.html#measures-of-dispersion-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><strong>Range</strong></li>
</ol>
<ul>
<li>What is the range of <code>mpg</code> (miles per gallon) in the <code>mtcars</code> dataset?</li>
<li>Find the range of flight durations (<code>arr_time</code> - <code>dep_time</code>) in the <code>flights</code> dataset.</li>
<li>In what situations might the range be a misleading measure of dispersion?</li>
<li>Discuss the potential pitfalls of only using the range as a measure of data spread.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><strong>Quantiles</strong></li>
</ol>
<ul>
<li>Calculate the interquartile range (IQR) for <code>hp</code> (horsepower) in the <code>mtcars</code> dataset.</li>
<li>What are the 10th and 90th percentiles of the <code>distance</code> column in the <code>flights</code> dataset?</li>
<li>How do quantiles provide a more nuanced understanding of data distribution compared to the range?</li>
<li>In what situations would median (or other quantiles) be preferred over the mean, and why?</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><strong>Mean Deviation</strong></li>
</ol>
<ul>
<li>Compute the mean absolute deviation of <code>wt</code> (weight) in the <code>mtcars</code> dataset.</li>
<li>What is the mean deviation of <code>air_time</code> in the <code>flights</code> dataset?</li>
<li>Why isn’t the mean absolute deviation as commonly used in standard statistical methods as variance or standard deviation, even though it might be more intuitively understood?</li>
<li>How might outliers impact the mean deviation compared to other measures of dispersion?</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li><strong>Variance</strong></li>
</ol>
<ul>
<li>Find the variance of <code>mpg</code> in the <code>mtcars</code> dataset.</li>
<li>Calculate the variance of <code>arr_delay</code> in the <code>flights</code> dataset.</li>
<li>How do variance and standard deviation relate, and in which situations might one be preferred over the other?</li>
<li>Why is variance, a squared measure, useful, even if it doesn’t have the same unit as the original data?</li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li><strong>Sample SS (Sum of Squares)</strong></li>
</ol>
<ul>
<li>Compute the sum of squares for the <code>drat</code> (rear axle ratio) column in the <code>mtcars</code> dataset.</li>
<li>Find the sum of squares for <code>dep_delay</code> in the <code>flights</code> dataset.</li>
<li>Philosophically, why do we square differences when calculating the sample sum of squares? What are the implications of this?</li>
<li>How might the sum of squares be influenced by extreme values, and what does this tell us about the underlying data?</li>
</ul>
<ol start="6" style="list-style-type: decimal">
<li><strong>Standard Deviation</strong></li>
</ol>
<ul>
<li>What is the standard deviation of <code>qsec</code> (1/4 mile time) in the <code>mtcars</code> dataset?</li>
<li>Find the standard deviation of <code>flight</code> (flight number) in the <code>flights</code> dataset.</li>
</ul>
<ol start="7" style="list-style-type: decimal">
<li><strong>Coefficient of Variation</strong></li>
</ol>
<ul>
<li>Calculate the coefficient of variation for <code>cyl</code> (number of cylinders) in the <code>mtcars</code> dataset.</li>
<li>What is the coefficient of variation for <code>carrier_delay</code> in the <code>flights</code> dataset?</li>
<li>What insights can the coefficient of variation provide that standard deviation cannot?</li>
<li>Under what circumstances would it be more appropriate to use the coefficient of variation instead of the standard deviation to compare the spread of two datasets?</li>
</ul>
<ol start="8" style="list-style-type: decimal">
<li><strong>General</strong></li>
</ol>
<ul>
<li>Which cars hav above-average <code>hp</code> in the <code>mtcars</code> dataset?</li>
<li>For which month is the <code>dep_delay</code> variability the highest in the <code>flights</code> dataset?</li>
<li>Which car model in the <code>mtcars</code> dataset has a <code>wt</code> closest to the median weight?</li>
<li>Identify the airline (carrier) with the most consistent <code>arr_delay</code> times in the <code>flights</code> dataset.</li>
<li>How does the variance of <code>mpg</code> for 4-cylinder cars compare to 6-cylinder cars in the <code>mtcars</code> dataset?</li>
<li>Determine the day of the week in the <code>flights</code> dataset with the highest IQR for <code>dep_delay</code>.</li>
<li>Is there a difference in the dispersion of <code>air_time</code> between flights destined for Los Angeles (<code>LAX</code>) vs. San Francisco (<code>SFO</code>)?</li>
<li>Compute the range of <code>hp</code> for cars with an automatic transmission versus those with a manual transmission in the <code>mtcars</code> dataset.</li>
<li>Find the month with the lowest mean absolute deviation of <code>arr_delay</code> in the <code>flights</code> dataset.</li>
<li>Which origin airport in the <code>flights</code> dataset has the highest variability in the number of flights per day?</li>
</ul>
<ol start="9" style="list-style-type: decimal">
<li><strong>Some questions for you to consider:</strong></li>
</ol>
<ul>
<li>How do measures of central tendency and dispersion together provide a more comprehensive understanding of a dataset?</li>
<li>Discuss the implications of relying solely on measures of dispersion without considering the context or underlying distribution of the data.</li>
<li>How do the assumptions underlying each measure of dispersion influence its applicability and interpretation?</li>
<li>In what situations might measures of dispersion fail to capture the true complexity or nature of data distribution?</li>
<li>How do transformations of data (e.g., logarithmic or square root transformations) influence measures of dispersion, and what are the philosophical considerations when choosing such transformations?</li>
</ul>
</div>
</div>
<div id="likelihood" class="section level2 hasAnchor" number="22.4">
<h2><span class="header-section-number">22.4</span> Likelihood<a href="in-class-assignments.html#likelihood" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="why-do-we-use-likelihood" class="section level3 hasAnchor" number="22.4.1">
<h3><span class="header-section-number">22.4.1</span> Why do we use likelihood?<a href="in-class-assignments.html#why-do-we-use-likelihood" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We know well that there is a analytic solution to this problem, the problem being parameter estimation - think of how to determine the mean and sd of a vector of numbers…</p>
<p>From Gribble: “The point of MLE is to show that as long as you have a model of the probability of the data given a guess at the parameter(s), you can use an optimizer to find the parameter value(s) that maximize the likelihood (minimize the negative log-likelihood) of the data given the parameter(s)”</p>
<p>1a. What does this mean and what is the relevance for parameter estimation?</p>
<p>1b. Also, this may not be clear but the likelihood approach allows us to calculate confidence intervals around our parameters, how?</p>
<p>1c. Why is this a desirable feature?</p>
</div>
<div id="we-can-compute-the-probability-of-the-data-x-given-parameters-mu-and-sigma2-using-the-equation-for-the-normal-distribution-pdf." class="section level3 hasAnchor" number="22.4.2">
<h3><span class="header-section-number">22.4.2</span> We can compute the probability of the data x given parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> using the equation for the normal distribution pdf.<a href="in-class-assignments.html#we-can-compute-the-probability-of-the-data-x-given-parameters-mu-and-sigma2-using-the-equation-for-the-normal-distribution-pdf." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>2a. Translate into words both the left and right sides of Gribble equation 8. How do you convert the equation to values?</p>
</div>
<div id="lets-start-with-ms-excel-to-investigate-this-issue-of-parameter-estimation-where-you-will-find-parameters-of-a-model-that-provide-the-best-fit-to-the-data." class="section level3 hasAnchor" number="22.4.3">
<h3><span class="header-section-number">22.4.3</span> Lets start with MS Excel to investigate this issue of parameter estimation, where you will find parameters of a model that provide the best fit to the data.<a href="in-class-assignments.html#lets-start-with-ms-excel-to-investigate-this-issue-of-parameter-estimation-where-you-will-find-parameters-of-a-model-that-provide-the-best-fit-to-the-data." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For any probability distribution, the probability of observing a data point <span class="math inline">\(Y_i\)</span>, given a particular parameter value,<em>p</em>, is: Pr(<span class="math inline">\(Y_i\)</span>|<em>p</em>).</p>
<p>In this case we will use the normal distribution use the file “Maximum Likelihood Example.xlsx”</p>
<p>3a. What are the values in column A?</p>
<p>3b. What are the values in column B?</p>
<p>3c. What are the values in column C?</p>
<p>3d. What are the values in column D?</p>
<p>3e. Change the values of the estimated <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>… what happens to the resulting sum logL?**</p>
</div>
<div id="lets-look-at-some-examples-in-rbasically-lets-code-the-xlsx-file" class="section level3 hasAnchor" number="22.4.4">
<h3><span class="header-section-number">22.4.4</span> Lets look at some examples in R…Basically lets code the xlsx file:<a href="in-class-assignments.html#lets-look-at-some-examples-in-rbasically-lets-code-the-xlsx-file" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="in-class-assignments.html#cb90-1" tabindex="-1"></a><span class="co"># We can make an R analog of the Maximum Likelihood Example.xlsx file:</span></span>
<span id="cb90-2"><a href="in-class-assignments.html#cb90-2" tabindex="-1"></a><span class="co"># Our approach is to make some data with underlying properties we understand. The data come from a normal distribution... We will change the value of our candidate values and determine how the negative log likelihood changes.</span></span>
<span id="cb90-3"><a href="in-class-assignments.html#cb90-3" tabindex="-1"></a></span>
<span id="cb90-4"><a href="in-class-assignments.html#cb90-4" tabindex="-1"></a><span class="co"># Here is some &quot;pseudo code&quot;</span></span>
<span id="cb90-5"><a href="in-class-assignments.html#cb90-5" tabindex="-1"></a><span class="co"># 1. Write code to make a normal distribution with mean.val and sd.val objects</span></span>
<span id="cb90-6"><a href="in-class-assignments.html#cb90-6" tabindex="-1"></a><span class="co"># rand.vect &lt;- ???</span></span>
<span id="cb90-7"><a href="in-class-assignments.html#cb90-7" tabindex="-1"></a></span>
<span id="cb90-8"><a href="in-class-assignments.html#cb90-8" tabindex="-1"></a><span class="co"># 2. Make a vector that has the density values, assuming that the distribution follows:</span></span>
<span id="cb90-9"><a href="in-class-assignments.html#cb90-9" tabindex="-1"></a></span>
<span id="cb90-10"><a href="in-class-assignments.html#cb90-10" tabindex="-1"></a><span class="co"># mean.val.cand and sd.val.cand.</span></span>
<span id="cb90-11"><a href="in-class-assignments.html#cb90-11" tabindex="-1"></a></span>
<span id="cb90-12"><a href="in-class-assignments.html#cb90-12" tabindex="-1"></a><span class="co"># prob.vect &lt;- the density of the observed data at the given point? </span></span>
<span id="cb90-13"><a href="in-class-assignments.html#cb90-13" tabindex="-1"></a></span>
<span id="cb90-14"><a href="in-class-assignments.html#cb90-14" tabindex="-1"></a><span class="co"># How is this calculated in theory and in practice?</span></span>
<span id="cb90-15"><a href="in-class-assignments.html#cb90-15" tabindex="-1"></a></span>
<span id="cb90-16"><a href="in-class-assignments.html#cb90-16" tabindex="-1"></a><span class="co"># 3. Determine the likelihood - you need to determine the natural log of the elements in the vector and then...?</span></span>
<span id="cb90-17"><a href="in-class-assignments.html#cb90-17" tabindex="-1"></a></span>
<span id="cb90-18"><a href="in-class-assignments.html#cb90-18" tabindex="-1"></a><span class="co"># 4. What happens when you change the candidate values of the parameters?</span></span></code></pre></div>
</div>
<div id="lets-push-our-understanding" class="section level3 hasAnchor" number="22.4.5">
<h3><span class="header-section-number">22.4.5</span> Lets push our understanding<a href="in-class-assignments.html#lets-push-our-understanding" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="in-class-assignments.html#cb91-1" tabindex="-1"></a><span class="co"># Get products of probabilities, find the MLE</span></span>
<span id="cb91-2"><a href="in-class-assignments.html#cb91-2" tabindex="-1"></a>mu.val <span class="ot">&lt;-</span> <span class="dv">22</span></span>
<span id="cb91-3"><a href="in-class-assignments.html#cb91-3" tabindex="-1"></a>sig.val <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb91-4"><a href="in-class-assignments.html#cb91-4" tabindex="-1"></a></span>
<span id="cb91-5"><a href="in-class-assignments.html#cb91-5" tabindex="-1"></a>rand.draws <span class="ot">&lt;-</span> (<span class="fu">rnorm</span>(<span class="dv">500</span>,<span class="at">mean =</span> mu.val, <span class="at">sd =</span> sig.val))  </span>
<span id="cb91-6"><a href="in-class-assignments.html#cb91-6" tabindex="-1"></a><span class="fu">hist</span>(rand.draws)</span></code></pre></div>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="in-class-assignments.html#cb92-1" tabindex="-1"></a>likhd <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb92-2"><a href="in-class-assignments.html#cb92-2" tabindex="-1"></a>best.guess.mu <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">15</span>,<span class="dv">25</span>,<span class="at">by =</span> <span class="fl">0.1</span>) </span>
<span id="cb92-3"><a href="in-class-assignments.html#cb92-3" tabindex="-1"></a>best.guess.sig <span class="ot">&lt;-</span> sig.val</span>
<span id="cb92-4"><a href="in-class-assignments.html#cb92-4" tabindex="-1"></a></span>
<span id="cb92-5"><a href="in-class-assignments.html#cb92-5" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(best.guess.mu)) {</span>
<span id="cb92-6"><a href="in-class-assignments.html#cb92-6" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(rand.draws,best.guess.mu[k],best.guess.sig) </span>
<span id="cb92-7"><a href="in-class-assignments.html#cb92-7" tabindex="-1"></a>likhd[k] <span class="ot">&lt;-</span> <span class="sc">-</span>(<span class="fu">sum</span>(<span class="fu">log</span>(prob))) }</span>
<span id="cb92-8"><a href="in-class-assignments.html#cb92-8" tabindex="-1"></a></span>
<span id="cb92-9"><a href="in-class-assignments.html#cb92-9" tabindex="-1"></a><span class="fu">plot</span>(best.guess.mu, likhd)</span>
<span id="cb92-10"><a href="in-class-assignments.html#cb92-10" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> mu.val)</span></code></pre></div>
</div>
</div>
<div id="z-score" class="section level2 hasAnchor" number="22.5">
<h2><span class="header-section-number">22.5</span> Z-score<a href="in-class-assignments.html#z-score" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="make-a-vector-of-10-randomly-drawn-numbers-from-a-normal-distribution." class="section level3 hasAnchor" number="22.5.1">
<h3><span class="header-section-number">22.5.1</span> Make a vector of 10 randomly drawn numbers from a normal distribution.<a href="in-class-assignments.html#make-a-vector-of-10-randomly-drawn-numbers-from-a-normal-distribution." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: lower-alpha">
<li>Calculate the z-scores of each value</li>
<li>Plot the z- scores and the vector of numbers</li>
</ol>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="in-class-assignments.html#cb93-1" tabindex="-1"></a><span class="co"># Here is another function to help us evaluate this:</span></span>
<span id="cb93-2"><a href="in-class-assignments.html#cb93-2" tabindex="-1"></a>vals.zscores <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb93-3"><a href="in-class-assignments.html#cb93-3" tabindex="-1"></a> rnorm.vect <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb93-4"><a href="in-class-assignments.html#cb93-4" tabindex="-1"></a> <span class="fu">plot</span>(rnorm.vect, (rnorm.vect <span class="sc">-</span> <span class="fu">mean</span>(rnorm.vect))<span class="sc">/</span><span class="fu">sd</span>(rnorm.vect),</span>
<span id="cb93-5"><a href="in-class-assignments.html#cb93-5" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;Original Vector&quot;</span>,</span>
<span id="cb93-6"><a href="in-class-assignments.html#cb93-6" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;Z-score&quot;</span>)</span>
<span id="cb93-7"><a href="in-class-assignments.html#cb93-7" tabindex="-1"></a> <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb93-8"><a href="in-class-assignments.html#cb93-8" tabindex="-1"></a> <span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(rnorm.vect), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb93-9"><a href="in-class-assignments.html#cb93-9" tabindex="-1"></a>}</span>
<span id="cb93-10"><a href="in-class-assignments.html#cb93-10" tabindex="-1"></a></span>
<span id="cb93-11"><a href="in-class-assignments.html#cb93-11" tabindex="-1"></a><span class="co"># Copy this code into your console. You will notice that in your </span></span>
<span id="cb93-12"><a href="in-class-assignments.html#cb93-12" tabindex="-1"></a><span class="co"># history window vals.zscores will show up as a function...</span></span>
<span id="cb93-13"><a href="in-class-assignments.html#cb93-13" tabindex="-1"></a></span>
<span id="cb93-14"><a href="in-class-assignments.html#cb93-14" tabindex="-1"></a><span class="fu">vals.zscores</span>()</span></code></pre></div>
</div>
</div>
<div id="normal-distribution" class="section level2 hasAnchor" number="22.6">
<h2><span class="header-section-number">22.6</span> Normal Distribution<a href="in-class-assignments.html#normal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="the-shape-of-the-normal-distribution" class="section level3 hasAnchor" number="22.6.1">
<h3><span class="header-section-number">22.6.1</span> The shape of the normal distribution<a href="in-class-assignments.html#the-shape-of-the-normal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>What parameters control the shape of the normal distribution?</p>
<p>Make some histograms of different normal distributions, in each, alter the parameter values in a systematic way to understand how these control the shape of the distribution. Interpret you results in words using the terms “precision” and “central tendency”.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="in-class-assignments.html#cb94-1" tabindex="-1"></a><span class="co"># Here is some code to help you. You will copy the code and paste it in - </span></span>
<span id="cb94-2"><a href="in-class-assignments.html#cb94-2" tabindex="-1"></a><span class="co"># I have written it as a function... </span></span>
<span id="cb94-3"><a href="in-class-assignments.html#cb94-3" tabindex="-1"></a>mean.eval.fun <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">mean. =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">5</span>)) {</span>
<span id="cb94-4"><a href="in-class-assignments.html#cb94-4" tabindex="-1"></a>  </span>
<span id="cb94-5"><a href="in-class-assignments.html#cb94-5" tabindex="-1"></a>  n.val <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb94-6"><a href="in-class-assignments.html#cb94-6" tabindex="-1"></a>  sim.mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> n.val, <span class="at">ncol =</span> <span class="fu">length</span>(mean.))</span>
<span id="cb94-7"><a href="in-class-assignments.html#cb94-7" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="fu">ceiling</span>(<span class="fu">length</span>(mean.)<span class="sc">/</span><span class="dv">2</span>),<span class="dv">2</span>))</span>
<span id="cb94-8"><a href="in-class-assignments.html#cb94-8" tabindex="-1"></a>  </span>
<span id="cb94-9"><a href="in-class-assignments.html#cb94-9" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(mean.)) {</span>
<span id="cb94-10"><a href="in-class-assignments.html#cb94-10" tabindex="-1"></a>    sim.mat[,j] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n.val, <span class="at">mean =</span> mean.[j], <span class="at">sd =</span> <span class="dv">1</span>) }</span>
<span id="cb94-11"><a href="in-class-assignments.html#cb94-11" tabindex="-1"></a>  </span>
<span id="cb94-12"><a href="in-class-assignments.html#cb94-12" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(mean.)) {</span>
<span id="cb94-13"><a href="in-class-assignments.html#cb94-13" tabindex="-1"></a>    <span class="fu">hist</span>(sim.mat[,j],</span>
<span id="cb94-14"><a href="in-class-assignments.html#cb94-14" tabindex="-1"></a>         <span class="at">xlim =</span> <span class="fu">range</span>(sim.mat),</span>
<span id="cb94-15"><a href="in-class-assignments.html#cb94-15" tabindex="-1"></a>         <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Mean value of distribution = &quot;</span>, mean.[j]))</span>
<span id="cb94-16"><a href="in-class-assignments.html#cb94-16" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v =</span> mean.[j], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb94-17"><a href="in-class-assignments.html#cb94-17" tabindex="-1"></a>  }</span>
<span id="cb94-18"><a href="in-class-assignments.html#cb94-18" tabindex="-1"></a>}</span>
<span id="cb94-19"><a href="in-class-assignments.html#cb94-19" tabindex="-1"></a></span>
<span id="cb94-20"><a href="in-class-assignments.html#cb94-20" tabindex="-1"></a><span class="co"># Copy this code into your console. You will notice that in your </span></span>
<span id="cb94-21"><a href="in-class-assignments.html#cb94-21" tabindex="-1"></a><span class="co"># history window mean.eval.fun will show up as a function...</span></span>
<span id="cb94-22"><a href="in-class-assignments.html#cb94-22" tabindex="-1"></a><span class="co"># Now you can change the argument &quot;mean.&quot;</span></span>
<span id="cb94-23"><a href="in-class-assignments.html#cb94-23" tabindex="-1"></a></span>
<span id="cb94-24"><a href="in-class-assignments.html#cb94-24" tabindex="-1"></a><span class="fu">mean.eval.fun</span>(<span class="at">mean. =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>))</span>
<span id="cb94-25"><a href="in-class-assignments.html#cb94-25" tabindex="-1"></a><span class="fu">mean.eval.fun</span>(<span class="at">mean. =</span> <span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">14</span>))</span></code></pre></div>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="in-class-assignments.html#cb95-1" tabindex="-1"></a><span class="co"># I would recommend not plotting too many at one time...</span></span></code></pre></div>
<p>So, now we can see what happens to the distribution when we change the mean, the mean is the measure of the central tendency.</p>
<p>Here is a function to evaluate how changing <span class="math inline">\(s\)</span> impacts the distribution</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="in-class-assignments.html#cb96-1" tabindex="-1"></a><span class="co"># Here is some code to help you. You will copy the code and paste it in - </span></span>
<span id="cb96-2"><a href="in-class-assignments.html#cb96-2" tabindex="-1"></a><span class="co"># I have written it as a function... </span></span>
<span id="cb96-3"><a href="in-class-assignments.html#cb96-3" tabindex="-1"></a>sd.eval.fun <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">sd. =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">5</span>)) {</span>
<span id="cb96-4"><a href="in-class-assignments.html#cb96-4" tabindex="-1"></a>  </span>
<span id="cb96-5"><a href="in-class-assignments.html#cb96-5" tabindex="-1"></a>  n.val <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb96-6"><a href="in-class-assignments.html#cb96-6" tabindex="-1"></a>  sim.mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> n.val, <span class="at">ncol =</span> <span class="fu">length</span>(sd.))</span>
<span id="cb96-7"><a href="in-class-assignments.html#cb96-7" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="fu">ceiling</span>(<span class="fu">length</span>(sd.)<span class="sc">/</span><span class="dv">2</span>),<span class="dv">2</span>))</span>
<span id="cb96-8"><a href="in-class-assignments.html#cb96-8" tabindex="-1"></a>  </span>
<span id="cb96-9"><a href="in-class-assignments.html#cb96-9" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sd.)) {</span>
<span id="cb96-10"><a href="in-class-assignments.html#cb96-10" tabindex="-1"></a>    sim.mat[,j] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n.val, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sd.[j]) }</span>
<span id="cb96-11"><a href="in-class-assignments.html#cb96-11" tabindex="-1"></a>  </span>
<span id="cb96-12"><a href="in-class-assignments.html#cb96-12" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sd.)) {</span>
<span id="cb96-13"><a href="in-class-assignments.html#cb96-13" tabindex="-1"></a>    <span class="fu">hist</span>(sim.mat[,j],</span>
<span id="cb96-14"><a href="in-class-assignments.html#cb96-14" tabindex="-1"></a>         <span class="at">xlim =</span> <span class="fu">range</span>(sim.mat),</span>
<span id="cb96-15"><a href="in-class-assignments.html#cb96-15" tabindex="-1"></a>         <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;St. Dev. value of distribution = &quot;</span>, sd.[j]))</span>
<span id="cb96-16"><a href="in-class-assignments.html#cb96-16" tabindex="-1"></a>  }</span>
<span id="cb96-17"><a href="in-class-assignments.html#cb96-17" tabindex="-1"></a>}</span>
<span id="cb96-18"><a href="in-class-assignments.html#cb96-18" tabindex="-1"></a></span>
<span id="cb96-19"><a href="in-class-assignments.html#cb96-19" tabindex="-1"></a><span class="co"># Copy this code into your console. You will notice that in your </span></span>
<span id="cb96-20"><a href="in-class-assignments.html#cb96-20" tabindex="-1"></a><span class="co"># history window sd.eval.fun will show up as a function...</span></span>
<span id="cb96-21"><a href="in-class-assignments.html#cb96-21" tabindex="-1"></a><span class="co"># Now you can change the argument &quot;sd.&quot;</span></span>
<span id="cb96-22"><a href="in-class-assignments.html#cb96-22" tabindex="-1"></a></span>
<span id="cb96-23"><a href="in-class-assignments.html#cb96-23" tabindex="-1"></a><span class="fu">sd.eval.fun</span>(<span class="at">sd. =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>))</span>
<span id="cb96-24"><a href="in-class-assignments.html#cb96-24" tabindex="-1"></a><span class="fu">sd.eval.fun</span>(<span class="at">sd. =</span> <span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">14</span>))</span></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="in-class-assignments.html#cb97-1" tabindex="-1"></a><span class="co"># I would recommend not plotting too many at one time...</span></span></code></pre></div>
</div>
<div id="your-turn" class="section level3 hasAnchor" number="22.6.2">
<h3><span class="header-section-number">22.6.2</span> Your turn<a href="in-class-assignments.html#your-turn" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Create a vector consisting of random draws from a normal distribution with (mean = 2, sd = 1) with at least 20 samples, using rnorm.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Take 5 samples (without replacement) from this distribution and calculate some summary statistics.</p></li>
<li><p>Now take an increasing large number of samples (without replacement), n = 8, 10,15, …20. For each iteration of random draws record the summary statistics.</p></li>
</ol>
</div>
<div id="simulation" class="section level3 hasAnchor" number="22.6.3">
<h3><span class="header-section-number">22.6.3</span> Simulation<a href="in-class-assignments.html#simulation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the function below I find that the taking more samples and that seems to give a more satisfactory result. Okay, so basically this is an evaluation of how sample size influences summary statistics…</p>
<p>Summary stats are descriptive statistics that describe the characteristics of distributions.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="in-class-assignments.html#cb98-1" tabindex="-1"></a><span class="co"># Here is another function to help us evaluate this:</span></span>
<span id="cb98-2"><a href="in-class-assignments.html#cb98-2" tabindex="-1"></a>samp.eval.fun <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">samples. =</span> <span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">500</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb98-3"><a href="in-class-assignments.html#cb98-3" tabindex="-1"></a>                          <span class="at">mean.val =</span> <span class="dv">2</span>,</span>
<span id="cb98-4"><a href="in-class-assignments.html#cb98-4" tabindex="-1"></a>                          <span class="at">sd.val =</span> <span class="dv">1</span>) {</span>
<span id="cb98-5"><a href="in-class-assignments.html#cb98-5" tabindex="-1"></a>  </span>
<span id="cb98-6"><a href="in-class-assignments.html#cb98-6" tabindex="-1"></a>  norm.dist <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">mean =</span> mean.val, <span class="at">sd =</span> sd.val)</span>
<span id="cb98-7"><a href="in-class-assignments.html#cb98-7" tabindex="-1"></a>  sum.mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(samples.), <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb98-8"><a href="in-class-assignments.html#cb98-8" tabindex="-1"></a>  </span>
<span id="cb98-9"><a href="in-class-assignments.html#cb98-9" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(samples.)) {</span>
<span id="cb98-10"><a href="in-class-assignments.html#cb98-10" tabindex="-1"></a>    samp.vect <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> norm.dist, <span class="at">size =</span> samples.[j], <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb98-11"><a href="in-class-assignments.html#cb98-11" tabindex="-1"></a>  sum.mat[j,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(samp.vect)</span>
<span id="cb98-12"><a href="in-class-assignments.html#cb98-12" tabindex="-1"></a>  sum.mat[j,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(samp.vect)</span>
<span id="cb98-13"><a href="in-class-assignments.html#cb98-13" tabindex="-1"></a>  sum.mat[j,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">min</span>(samp.vect)</span>
<span id="cb98-14"><a href="in-class-assignments.html#cb98-14" tabindex="-1"></a>  sum.mat[j,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">max</span>(samp.vect)</span>
<span id="cb98-15"><a href="in-class-assignments.html#cb98-15" tabindex="-1"></a>  }</span>
<span id="cb98-16"><a href="in-class-assignments.html#cb98-16" tabindex="-1"></a>  </span>
<span id="cb98-17"><a href="in-class-assignments.html#cb98-17" tabindex="-1"></a>  <span class="fu">plot</span>(samples., sum.mat[,<span class="dv">1</span>], </span>
<span id="cb98-18"><a href="in-class-assignments.html#cb98-18" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;Number of Samples&quot;</span>, </span>
<span id="cb98-19"><a href="in-class-assignments.html#cb98-19" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;Mean of Samples&quot;</span>, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>)</span>
<span id="cb98-20"><a href="in-class-assignments.html#cb98-20" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> mean.val, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb98-21"><a href="in-class-assignments.html#cb98-21" tabindex="-1"></a>  <span class="fu">plot</span>(samples., sum.mat[,<span class="dv">2</span>], </span>
<span id="cb98-22"><a href="in-class-assignments.html#cb98-22" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;Number of Samples&quot;</span>, </span>
<span id="cb98-23"><a href="in-class-assignments.html#cb98-23" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;SD of Samples&quot;</span>, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>)</span>
<span id="cb98-24"><a href="in-class-assignments.html#cb98-24" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> sd.val, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb98-25"><a href="in-class-assignments.html#cb98-25" tabindex="-1"></a>}</span>
<span id="cb98-26"><a href="in-class-assignments.html#cb98-26" tabindex="-1"></a></span>
<span id="cb98-27"><a href="in-class-assignments.html#cb98-27" tabindex="-1"></a><span class="co"># Copy this code into your console. You will notice that in your </span></span>
<span id="cb98-28"><a href="in-class-assignments.html#cb98-28" tabindex="-1"></a><span class="co"># history window samp.eval.fun will show up as a function...</span></span>
<span id="cb98-29"><a href="in-class-assignments.html#cb98-29" tabindex="-1"></a><span class="co"># Now you can change the argument &quot;samples.&quot;</span></span>
<span id="cb98-30"><a href="in-class-assignments.html#cb98-30" tabindex="-1"></a></span>
<span id="cb98-31"><a href="in-class-assignments.html#cb98-31" tabindex="-1"></a><span class="fu">samp.eval.fun</span>()</span></code></pre></div>
</div>
<div id="calculate-the-summary-statistics" class="section level3 hasAnchor" number="22.6.4">
<h3><span class="header-section-number">22.6.4</span> Calculate the summary statistics<a href="in-class-assignments.html#calculate-the-summary-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: lower-alpha">
<li>Calculate the z-scores of each value</li>
<li>Plot the z- scores and the vector of numbers</li>
</ol>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="in-class-assignments.html#cb99-1" tabindex="-1"></a><span class="co"># Here is another function to help us evaluate this:</span></span>
<span id="cb99-2"><a href="in-class-assignments.html#cb99-2" tabindex="-1"></a>vals.zscores <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb99-3"><a href="in-class-assignments.html#cb99-3" tabindex="-1"></a> rnorm.vect <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb99-4"><a href="in-class-assignments.html#cb99-4" tabindex="-1"></a> <span class="fu">plot</span>(rnorm.vect, (rnorm.vect <span class="sc">-</span> <span class="fu">mean</span>(rnorm.vect))<span class="sc">/</span><span class="fu">sd</span>(rnorm.vect),</span>
<span id="cb99-5"><a href="in-class-assignments.html#cb99-5" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;Original Vector&quot;</span>,</span>
<span id="cb99-6"><a href="in-class-assignments.html#cb99-6" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;Z-score&quot;</span>)</span>
<span id="cb99-7"><a href="in-class-assignments.html#cb99-7" tabindex="-1"></a> <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb99-8"><a href="in-class-assignments.html#cb99-8" tabindex="-1"></a> <span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(rnorm.vect), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb99-9"><a href="in-class-assignments.html#cb99-9" tabindex="-1"></a>}</span>
<span id="cb99-10"><a href="in-class-assignments.html#cb99-10" tabindex="-1"></a></span>
<span id="cb99-11"><a href="in-class-assignments.html#cb99-11" tabindex="-1"></a><span class="co"># Copy this code into your console. You will notice that in your </span></span>
<span id="cb99-12"><a href="in-class-assignments.html#cb99-12" tabindex="-1"></a><span class="co"># history window vals.zscores will show up as a function...</span></span>
<span id="cb99-13"><a href="in-class-assignments.html#cb99-13" tabindex="-1"></a></span>
<span id="cb99-14"><a href="in-class-assignments.html#cb99-14" tabindex="-1"></a><span class="fu">vals.zscores</span>()</span></code></pre></div>
</div>
</div>
<div id="probabilities-and-random-variables" class="section level2 hasAnchor" number="22.7">
<h2><span class="header-section-number">22.7</span> Probabilities and random variables:<a href="in-class-assignments.html#probabilities-and-random-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here are some examples of useful functions to calculate the value of the cumulative distribution function at (or the probability to the left of) a given number.</p>
<p>Given a number or a list it computes the probability that a normally distributed random number will be less than that number. This function is the “cumulative distribution function.”</p>
<div id="examine-the-properties-of-the-normal-distribution" class="section level3 hasAnchor" number="22.7.1">
<h3><span class="header-section-number">22.7.1</span> Examine the properties of the Normal Distribution:<a href="in-class-assignments.html#examine-the-properties-of-the-normal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="in-class-assignments.html#cb100-1" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">0</span>)</span>
<span id="cb100-2"><a href="in-class-assignments.html#cb100-2" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">1</span>)</span>
<span id="cb100-3"><a href="in-class-assignments.html#cb100-3" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">0</span>,<span class="at">mean=</span><span class="dv">2</span>)</span>
<span id="cb100-4"><a href="in-class-assignments.html#cb100-4" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">0</span>,<span class="at">mean=</span><span class="dv">2</span>,<span class="at">sd=</span><span class="dv">3</span>)</span>
<span id="cb100-5"><a href="in-class-assignments.html#cb100-5" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)         </span>
<span id="cb100-6"><a href="in-class-assignments.html#cb100-6" tabindex="-1"></a><span class="fu">pnorm</span>(v)</span>
<span id="cb100-7"><a href="in-class-assignments.html#cb100-7" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>,<span class="at">by=</span>.<span class="dv">1</span>)</span>
<span id="cb100-8"><a href="in-class-assignments.html#cb100-8" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(x) </span>
<span id="cb100-9"><a href="in-class-assignments.html#cb100-9" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span></code></pre></div>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="in-class-assignments.html#cb101-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(x,<span class="at">mean=</span><span class="dv">3</span>,<span class="at">sd=</span><span class="dv">4</span>) </span>
<span id="cb101-2"><a href="in-class-assignments.html#cb101-2" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span></code></pre></div>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="in-class-assignments.html#cb102-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb102-2"><a href="in-class-assignments.html#cb102-2" tabindex="-1"></a>x</span>
<span id="cb102-3"><a href="in-class-assignments.html#cb102-3" tabindex="-1"></a><span class="fu">pnorm</span>(x)</span></code></pre></div>
</div>
<div id="calculate-the-following-probabilities" class="section level3 hasAnchor" number="22.7.2">
<h3><span class="header-section-number">22.7.2</span> Calculate the following probabilities:<a href="in-class-assignments.html#calculate-the-following-probabilities" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>1a. Probability that a normal random variable with mean 22 and variance 25 lies between 16.2 and 27.5</p>
<p>1b. is greater than 29</p>
<p>1c. is less than 17</p>
<p>1d. is less than 15 or greater than 25</p>
</div>
<div id="qnorm" class="section level3 hasAnchor" number="22.7.3">
<h3><span class="header-section-number">22.7.3</span> qnorm<a href="in-class-assignments.html#qnorm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The idea behind qnorm is that you give it a probability, and it returns the number whose cumulative distribution matches the probability.</p>
<p>For example, if you have a normally distributed random variable with mean zero and standard deviation one, then if you give the function a probability it returns the associated Z-score - qnorm which is the inverse of pnorm.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="in-class-assignments.html#cb103-1" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.5</span>)</span>
<span id="cb103-2"><a href="in-class-assignments.html#cb103-2" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.5</span>,<span class="at">mean=</span><span class="dv">1</span>)</span>
<span id="cb103-3"><a href="in-class-assignments.html#cb103-3" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.5</span>,<span class="at">mean=</span><span class="dv">1</span>,<span class="at">sd=</span><span class="dv">2</span>)</span>
<span id="cb103-4"><a href="in-class-assignments.html#cb103-4" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.5</span>,<span class="at">mean=</span><span class="dv">2</span>,<span class="at">sd=</span><span class="dv">2</span>)</span>
<span id="cb103-5"><a href="in-class-assignments.html#cb103-5" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.5</span>,<span class="at">mean=</span><span class="dv">2</span>,<span class="at">sd=</span><span class="dv">4</span>)</span>
<span id="cb103-6"><a href="in-class-assignments.html#cb103-6" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.25</span>,<span class="at">mean=</span><span class="dv">2</span>,<span class="at">sd=</span><span class="dv">2</span>)</span>
<span id="cb103-7"><a href="in-class-assignments.html#cb103-7" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.333</span>)</span>
<span id="cb103-8"><a href="in-class-assignments.html#cb103-8" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.333</span>,<span class="at">sd=</span><span class="dv">3</span>)</span>
<span id="cb103-9"><a href="in-class-assignments.html#cb103-9" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.75</span>,<span class="at">mean=</span><span class="dv">5</span>,<span class="at">sd=</span><span class="dv">2</span>)</span>
<span id="cb103-10"><a href="in-class-assignments.html#cb103-10" tabindex="-1"></a>v <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.3</span>,<span class="fl">0.75</span>)</span>
<span id="cb103-11"><a href="in-class-assignments.html#cb103-11" tabindex="-1"></a><span class="fu">qnorm</span>(v)</span>
<span id="cb103-12"><a href="in-class-assignments.html#cb103-12" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span>.<span class="dv">05</span>)</span>
<span id="cb103-13"><a href="in-class-assignments.html#cb103-13" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(x)</span>
<span id="cb103-14"><a href="in-class-assignments.html#cb103-14" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span></code></pre></div>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="in-class-assignments.html#cb104-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(x,<span class="at">mean=</span><span class="dv">3</span>,<span class="at">sd=</span><span class="dv">2</span>)</span>
<span id="cb104-2"><a href="in-class-assignments.html#cb104-2" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span></code></pre></div>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="in-class-assignments.html#cb105-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(x,<span class="at">mean=</span><span class="dv">3</span>,<span class="at">sd=</span><span class="fl">0.1</span>)</span>
<span id="cb105-2"><a href="in-class-assignments.html#cb105-2" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span></code></pre></div>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="in-class-assignments.html#cb106-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">01</span>,.<span class="dv">05</span>,.<span class="dv">1</span>,.<span class="dv">2</span>,.<span class="dv">5</span>,.<span class="dv">8</span>,.<span class="dv">95</span>,.<span class="dv">99</span>)</span>
<span id="cb106-2"><a href="in-class-assignments.html#cb106-2" tabindex="-1"></a><span class="fu">qnorm</span>(y, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="rnorm" class="section level3 hasAnchor" number="22.7.4">
<h3><span class="header-section-number">22.7.4</span> rnorm<a href="in-class-assignments.html#rnorm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In rnorm the argument that you give it is the number of random numbers that you want, and it has optional arguments to specify the mean and standard deviation.</p>
<p>The first sample is from <span class="math inline">\(N(0,1)\)</span> distribution and the next one from <span class="math inline">\(N(5,1)\)</span> distribution.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="in-class-assignments.html#cb107-1" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb107-2"><a href="in-class-assignments.html#cb107-2" tabindex="-1"></a>z</span>
<span id="cb107-3"><a href="in-class-assignments.html#cb107-3" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="at">mean=</span><span class="dv">5</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb107-4"><a href="in-class-assignments.html#cb107-4" tabindex="-1"></a><span class="fu">hist</span>(w)</span></code></pre></div>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="in-class-assignments.html#cb108-1" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">4</span>)</span>
<span id="cb108-2"><a href="in-class-assignments.html#cb108-2" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">4</span>,<span class="at">mean=</span><span class="dv">3</span>)</span>
<span id="cb108-3"><a href="in-class-assignments.html#cb108-3" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">4</span>,<span class="at">mean=</span><span class="dv">3</span>,<span class="at">sd=</span><span class="dv">3</span>)</span>
<span id="cb108-4"><a href="in-class-assignments.html#cb108-4" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">4</span>,<span class="at">mean=</span><span class="dv">3</span>,<span class="at">sd=</span><span class="dv">3</span>)</span>
<span id="cb108-5"><a href="in-class-assignments.html#cb108-5" tabindex="-1"></a></span>
<span id="cb108-6"><a href="in-class-assignments.html#cb108-6" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">200</span>)</span>
<span id="cb108-7"><a href="in-class-assignments.html#cb108-7" tabindex="-1"></a><span class="fu">hist</span>(y)</span></code></pre></div>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="in-class-assignments.html#cb109-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">200</span>,<span class="at">mean=</span><span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb109-2"><a href="in-class-assignments.html#cb109-2" tabindex="-1"></a><span class="fu">hist</span>(y)</span></code></pre></div>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="in-class-assignments.html#cb110-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">200</span>,<span class="at">mean=</span><span class="sc">-</span><span class="dv">2</span>,<span class="at">sd=</span><span class="dv">4</span>)</span>
<span id="cb110-2"><a href="in-class-assignments.html#cb110-2" tabindex="-1"></a><span class="fu">hist</span>(y)</span></code></pre></div>
</div>
<div id="plotting-the-probability-density-function-pdf-of-a-normal-distribution" class="section level3 hasAnchor" number="22.7.5">
<h3><span class="header-section-number">22.7.5</span> Plotting the probability density function (pdf) of a Normal distribution :<a href="in-class-assignments.html#plotting-the-probability-density-function-pdf-of-a-normal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="in-class-assignments.html#cb111-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">4.5</span>,<span class="fl">4.5</span>,.<span class="dv">1</span>)</span>
<span id="cb111-2"><a href="in-class-assignments.html#cb111-2" tabindex="-1"></a>normdensity <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb111-3"><a href="in-class-assignments.html#cb111-3" tabindex="-1"></a><span class="co"># plot(x,normdensity,type=&quot;l&quot;)</span></span></code></pre></div>
</div>
<div id="some-more-simulation-practice" class="section level3 hasAnchor" number="22.7.6">
<h3><span class="header-section-number">22.7.6</span> Some more simulation practice:<a href="in-class-assignments.html#some-more-simulation-practice" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s a some simulation: the variable of interest is X with <em>X</em> ~ <em>N</em>(<span class="math inline">\(\mu\)</span> = 2, <span class="math inline">\(\sigma\)</span> = 4).</p>
<p>We will investigate some properties of the sample mean and variance when taking a random sample of size <em>n</em>. In other words, we use R to generate <em>n</em> random draws from the distribution <em>X</em>. This happens in each simulation step.</p>
<p>Perform 10 simulations and take a sample of size = 10 in each simulation step. Save the sample mean and variance in a vector. In that way, you are able to investigate the results of all simulation steps.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="in-class-assignments.html#cb112-1" tabindex="-1"></a>mu <span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb112-2"><a href="in-class-assignments.html#cb112-2" tabindex="-1"></a>sigma <span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb112-3"><a href="in-class-assignments.html#cb112-3" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb112-4"><a href="in-class-assignments.html#cb112-4" tabindex="-1"></a>asim <span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb112-5"><a href="in-class-assignments.html#cb112-5" tabindex="-1"></a>xbar <span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb112-6"><a href="in-class-assignments.html#cb112-6" tabindex="-1"></a>xvar <span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb112-7"><a href="in-class-assignments.html#cb112-7" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>asim)</span>
<span id="cb112-8"><a href="in-class-assignments.html#cb112-8" tabindex="-1"></a>{</span>
<span id="cb112-9"><a href="in-class-assignments.html#cb112-9" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,mu,sigma) <span class="co"># x contains a random sample of size n of the variable X</span></span>
<span id="cb112-10"><a href="in-class-assignments.html#cb112-10" tabindex="-1"></a>xbar[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb112-11"><a href="in-class-assignments.html#cb112-11" tabindex="-1"></a>xvar[i] <span class="ot">&lt;-</span> <span class="fu">var</span>(x)</span>
<span id="cb112-12"><a href="in-class-assignments.html#cb112-12" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="is-the-sample-mean-a-good-estimator-for-the-population-mean" class="section level3 hasAnchor" number="22.7.7">
<h3><span class="header-section-number">22.7.7</span> Is the sample mean a good estimator for the population mean?<a href="in-class-assignments.html#is-the-sample-mean-a-good-estimator-for-the-population-mean" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>How can you check this property using the above simulation?</p>
<p>Increase the number of simulations to 100 and then finally to 1000. What do you notice?</p>
</div>
</div>
<div id="students-t-distribution" class="section level2 hasAnchor" number="22.8">
<h2><span class="header-section-number">22.8</span> Student’s <span class="math inline">\(t\)</span> distribution<a href="in-class-assignments.html#students-t-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Generate 500 samples from Student’s <span class="math inline">\(t\)</span> distribution with 5 degrees of freedom and plot the historgam. Note: <span class="math inline">\(t\)</span> distribution is going to be covered in some detail later, but here is some initial practice.</p>
<p>There are four functions that can be used to generate the values associated with the tdistribution. You can get a full list of them and their options using the help command.</p>
<p>These commands work just like the commands for the normal distribution. One difference is that the commands assume that the values are normalized to mean zero and standard deviation one, so you have to use a little algebra to use these functions in practice. The other difference is that you have to specify the number of degrees of freedom. The commands follow the same kind of naming convention, and the names of the commands are dt, pt, qt, and rt.</p>
<p>A few examples are given below to show how to use the different commands. First we have the distribution function, dt.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="in-class-assignments.html#cb113-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>,<span class="at">by=</span>.<span class="dv">5</span>)</span>
<span id="cb113-2"><a href="in-class-assignments.html#cb113-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">dt</span>(x,<span class="at">df=</span><span class="dv">10</span>)</span>
<span id="cb113-3"><a href="in-class-assignments.html#cb113-3" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span></code></pre></div>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="in-class-assignments.html#cb114-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">dt</span>(x,<span class="at">df=</span><span class="dv">50</span>)</span>
<span id="cb114-2"><a href="in-class-assignments.html#cb114-2" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span></code></pre></div>
<p>Next we have the cumulative probability distribution function:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="in-class-assignments.html#cb115-1" tabindex="-1"></a><span class="fu">pt</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="at">df=</span><span class="dv">10</span>)</span>
<span id="cb115-2"><a href="in-class-assignments.html#cb115-2" tabindex="-1"></a><span class="fu">pt</span>(<span class="dv">3</span>,<span class="at">df=</span><span class="dv">10</span>)</span>
<span id="cb115-3"><a href="in-class-assignments.html#cb115-3" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="dv">3</span>,<span class="at">df=</span><span class="dv">10</span>)</span>
<span id="cb115-4"><a href="in-class-assignments.html#cb115-4" tabindex="-1"></a><span class="fu">pt</span>(<span class="dv">3</span>,<span class="at">df=</span><span class="dv">20</span>)</span>
<span id="cb115-5"><a href="in-class-assignments.html#cb115-5" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb115-6"><a href="in-class-assignments.html#cb115-6" tabindex="-1"></a><span class="fu">pt</span>((<span class="fu">mean</span>(x)<span class="sc">-</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sd</span>(x),<span class="at">df=</span><span class="dv">20</span>)</span>
<span id="cb115-7"><a href="in-class-assignments.html#cb115-7" tabindex="-1"></a><span class="fu">pt</span>((<span class="fu">mean</span>(x)<span class="sc">-</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sd</span>(x),<span class="at">df=</span><span class="dv">40</span>)</span></code></pre></div>
<p>Next we have the inverse cumulative probability distribution function:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="in-class-assignments.html#cb116-1" tabindex="-1"></a><span class="fu">qt</span>(<span class="fl">0.05</span>,<span class="at">df=</span><span class="dv">10</span>)</span>
<span id="cb116-2"><a href="in-class-assignments.html#cb116-2" tabindex="-1"></a><span class="fu">qt</span>(<span class="fl">0.95</span>,<span class="at">df=</span><span class="dv">10</span>)</span>
<span id="cb116-3"><a href="in-class-assignments.html#cb116-3" tabindex="-1"></a><span class="fu">qt</span>(<span class="fl">0.05</span>,<span class="at">df=</span><span class="dv">20</span>)</span>
<span id="cb116-4"><a href="in-class-assignments.html#cb116-4" tabindex="-1"></a><span class="fu">qt</span>(<span class="fl">0.95</span>,<span class="at">df=</span><span class="dv">20</span>)</span>
<span id="cb116-5"><a href="in-class-assignments.html#cb116-5" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.005</span>,.<span class="dv">025</span>,.<span class="dv">05</span>)</span>
<span id="cb116-6"><a href="in-class-assignments.html#cb116-6" tabindex="-1"></a><span class="fu">qt</span>(v,<span class="at">df=</span><span class="dv">253</span>)</span>
<span id="cb116-7"><a href="in-class-assignments.html#cb116-7" tabindex="-1"></a><span class="fu">qt</span>(v,<span class="at">df=</span><span class="dv">25</span>)</span></code></pre></div>
<p>Finally random numbers can be generated according to the t distribution:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="in-class-assignments.html#cb117-1" tabindex="-1"></a><span class="fu">rt</span>(<span class="dv">3</span>,<span class="at">df=</span><span class="dv">10</span>)</span>
<span id="cb117-2"><a href="in-class-assignments.html#cb117-2" tabindex="-1"></a><span class="fu">rt</span>(<span class="dv">3</span>,<span class="at">df=</span><span class="dv">20</span>)</span>
<span id="cb117-3"><a href="in-class-assignments.html#cb117-3" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rt</span>(<span class="dv">30</span>,<span class="at">df=</span><span class="dv">20</span>))</span></code></pre></div>
<div id="your-turn-1" class="section level3 hasAnchor" number="22.8.1">
<h3><span class="header-section-number">22.8.1</span> Your Turn<a href="in-class-assignments.html#your-turn-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Using what you know about the probabilities of the normal and t-distributions how and can you display these graphically.</p>
</div>
</div>
<div id="confidence-intervals" class="section level2 hasAnchor" number="22.9">
<h2><span class="header-section-number">22.9</span> Confidence Intervals<a href="in-class-assignments.html#confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>What is a confidence interval and how is it used in statistical analysis?</li>
<li>How does the confidence level relate to the value of <span class="math inline">\(\alpha\)</span>?</li>
<li>Why can’t we ever truly know the magnitude of the true error of our estimated value?</li>
<li>Explain the importance of the Z-score in the context of confidence intervals.</li>
<li>What is the standard error of the mean and how is it different from the standard deviation?</li>
<li>Describe the t-distribution. When is it preferable over the Z-distribution?</li>
<li>How does the shape of the t-distribution change with degrees of freedom?</li>
<li>Why are the tails of the t-distribution thicker compared to the normal distribution?</li>
<li>How do you interpret the mean and variance of the t-distribution?</li>
<li>What are the differences between standard deviation and standard error?</li>
</ol>
<p>Using the mtcars dataset in R, compute the mean mpg. What is the 95% confidence interval for the mean mpg using Z-distribution?</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="in-class-assignments.html#cb118-1" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb118-2"><a href="in-class-assignments.html#cb118-2" tabindex="-1"></a>mean_mpg <span class="ot">&lt;-</span> <span class="fu">mean</span>(mtcars<span class="sc">$</span>mpg)</span>
<span id="cb118-3"><a href="in-class-assignments.html#cb118-3" tabindex="-1"></a>sd_mpg <span class="ot">&lt;-</span> <span class="fu">sd</span>(mtcars<span class="sc">$</span>mpg)</span>
<span id="cb118-4"><a href="in-class-assignments.html#cb118-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(mtcars<span class="sc">$</span>mpg)</span>
<span id="cb118-5"><a href="in-class-assignments.html#cb118-5" tabindex="-1"></a>z_value <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb118-6"><a href="in-class-assignments.html#cb118-6" tabindex="-1"></a><span class="co"># And you fill in the rest of the code...</span></span></code></pre></div>
<p>Using the same mtcars dataset, compute the 95% confidence interval for the mean mpg using the t-distribution.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="in-class-assignments.html#cb119-1" tabindex="-1"></a>t_value <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb119-2"><a href="in-class-assignments.html#cb119-2" tabindex="-1"></a><span class="co"># And you fill in the rest...</span></span></code></pre></div>
<p>How does the confidence interval width change when increasing the sample size? Simulate datasets with sizes 10, 50, 100, 500, and 1000, then compute the 95% confidence interval for each.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="in-class-assignments.html#cb120-1" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span></code></pre></div>
<p>For the mtcars dataset, calculate the 90% confidence interval for the mean hp (horsepower) using the t-distribution.</p>
</div>
<div id="nhst" class="section level2 hasAnchor" number="22.10">
<h2><span class="header-section-number">22.10</span> NHST<a href="in-class-assignments.html#nhst" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Describe the main steps involved in Null Hypothesis Significance Testing (NHST). Why is it essential in statistical inference?</li>
<li>Explain the difference between a null hypothesis and an alternative hypothesis.</li>
<li>What is the significance level (<span class="math inline">\(\alpha\)</span>), and how is it used in hypothesis testing?</li>
<li>Describe the concept of a p-value in the context of hypothesis testing.</li>
<li>Why is the Z-score used in testing significance? Under what conditions is it most appropriate?</li>
<li>Discuss Fisher’s recommendation of using <span class="math inline">\(\alpha = 0.05\)</span>.</li>
<li>Describe the Kolmogorov-Smirnov test. When is it used, and what are its hypotheses?</li>
<li>What is the Shapiro-Wilk test, and how does it compare to the Kolmogorov-Smirnov test in assessing normality?</li>
<li>Why might a researcher choose to use a one-tailed test instead of a two-tailed test?</li>
</ol>
<p>Shapiro-Wilk Test: Check if a given dataset follows a normal distribution. In additon to the statistical test, use some qualitative methods for determining normality.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="in-class-assignments.html#cb121-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>Kolmogorov-Smirnov Test: Test a dataset against a standard normal distribution of data1 and data2. In additon to the statistical test, use some qualitative methods for determining normality.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="in-class-assignments.html#cb122-1" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>)</span>
<span id="cb122-2"><a href="in-class-assignments.html#cb122-2" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>), <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">4</span>, <span class="at">sd =</span> <span class="dv">2</span>))</span></code></pre></div>
<p>Confidence Interval Calculation: Calculate a 95% confidence interval for a given dataset.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="in-class-assignments.html#cb123-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">155</span>, <span class="dv">152</span>, <span class="dv">158</span>, <span class="dv">153</span>, <span class="dv">156</span>, <span class="dv">159</span>, <span class="dv">157</span>)</span>
<span id="cb123-2"><a href="in-class-assignments.html#cb123-2" tabindex="-1"></a>confidence_level <span class="ot">&lt;-</span> <span class="fl">0.95</span></span>
<span id="cb123-3"><a href="in-class-assignments.html#cb123-3" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">qt</span>(confidence_level <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>confidence_level)<span class="sc">/</span><span class="dv">2</span>, <span class="fu">length</span>(data)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sd</span>(data)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(data))</span></code></pre></div>
</div>
<div id="correlation" class="section level2 hasAnchor" number="22.11">
<h2><span class="header-section-number">22.11</span> Correlation<a href="in-class-assignments.html#correlation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="aspects-of-correlation-and-learning-objectives" class="section level3 hasAnchor" number="22.11.1">
<h3><span class="header-section-number">22.11.1</span> Aspects of correlation and learning objectives:<a href="in-class-assignments.html#aspects-of-correlation-and-learning-objectives" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Inspect data using R functionality, describe its structure, ranges, and relationships.</li>
<li>Understand the mathematics of the calculations for variance, covariance, and correlation.</li>
<li>Review the assumptions of parametric statistical tests</li>
<li>Perform a statistical test.</li>
<li>Look at the resulting power of tests.</li>
</ol>
</div>
<div id="we-are-interested-in-understanding-the-relationships-of-two-variables-that-may-or-may-not-covary." class="section level3 hasAnchor" number="22.11.2">
<h3><span class="header-section-number">22.11.2</span> We are interested in understanding the relationships of two variables that may, or may not, covary.<a href="in-class-assignments.html#we-are-interested-in-understanding-the-relationships-of-two-variables-that-may-or-may-not-covary." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lets use some R functionality to examine the data.</p>
</div>
<div id="for-this-lab-we-will-use-mtcars-data-set-in-the-package-datasets-version-3.5.0." class="section level3 hasAnchor" number="22.11.3">
<h3><span class="header-section-number">22.11.3</span> For this lab we will use mtcars data set in the package ‘datasets’ version 3.5.0.<a href="in-class-assignments.html#for-this-lab-we-will-use-mtcars-data-set-in-the-package-datasets-version-3.5.0." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lets look at the data and use the function ‘summary’</p>
<p>What are the summary statistics of these variables?</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="in-class-assignments.html#cb124-1" tabindex="-1"></a><span class="co"># Run this code in your R console</span></span>
<span id="cb124-2"><a href="in-class-assignments.html#cb124-2" tabindex="-1"></a><span class="fu">require</span>(datasets)</span>
<span id="cb124-3"><a href="in-class-assignments.html#cb124-3" tabindex="-1"></a><span class="fu">library</span>(<span class="at">help =</span> <span class="st">&quot;datasets&quot;</span>) <span class="co"># See all of the data sets available in R.</span></span>
<span id="cb124-4"><a href="in-class-assignments.html#cb124-4" tabindex="-1"></a><span class="fu">summary</span>(datasets<span class="sc">::</span>mtcars)</span></code></pre></div>
<p>Summary statistics describe the mean, range, variance, distribution, ect. of the univariate vectors.</p>
<p>[, 1] mpg Miles/(US) gallon</p>
<p>[, 2] cyl Number of cylinders</p>
<p>[, 3] disp Displacement (cu.in.)</p>
<p>[, 4] hp Gross horsepower</p>
<p>[, 5] drat Rear axle ratio</p>
<p>[, 6] wt Weight (1000 lbs)</p>
<p>[, 7] qsec 1/4 mile time</p>
<p>[, 8] vs Engine (0 = V-shaped, 1 = straight)</p>
<p>[, 9] am Transmission (0 = automatic, 1 = manual)</p>
<p>[,10] gear Number of forward gears</p>
<p>[,11] carb Number of carburetors</p>
<p>Lets look at the data in a figure</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="in-class-assignments.html#cb125-1" tabindex="-1"></a><span class="co"># Run this code in your R console</span></span>
<span id="cb125-2"><a href="in-class-assignments.html#cb125-2" tabindex="-1"></a><span class="fu">pairs</span>(mtcars)</span>
<span id="cb125-3"><a href="in-class-assignments.html#cb125-3" tabindex="-1"></a><span class="fu">pairs</span>(mtcars[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)])</span></code></pre></div>
<p>Explore and describe the data - what variables are linearly correlated in a qualitative sense?</p>
<p>We particularly focus on continuous variables, why?</p>
<p>What is the purpose of inspecting data using R functionality when performing parametric correlation analysis, and how does it help in the analysis?</p>
<p>Describe the key statistics provided by the summary function in R when applied to a dataset, such as the mtcars dataset. How can these statistics be useful for understanding the data’s structure and relationships?</p>
<p>We are going to perform parametric statistical analysis (calculation of the Pearson’s <span class="math inline">\(\rho\)</span> and related statistical analysis). So, we will will need to fulfill the assumptions of parametric statistics.</p>
<p><em>Data in each comparison group show a Normal distribution.</em></p>
<ul>
<li><p>The <em>p</em> value for parametric tests depends upon a normal sampling distribution. If the sample size is large enough and the actual sample data point value are approximately normally distributed, then the central limit theorem ensures a normally distributed sampling distribution.</p></li>
<li><p>In regression analysis and in general linear models, it is the errors that need to be normally distributed.</p></li>
</ul>
<p>Data in each comparison group exhibit similar degrees of homoscedasticity, or homogeneity of Variance.</p>
<ul>
<li>This refers to the need for a similarity in the variance throughout the data. This means that the variable in the populations from which the samples were taken have a similar variance in these populations. In the case of regression, the variance of one variable should be the same as all the other variables.</li>
</ul>
<p>Each of these are testable hypotheses and we can set them up that way:</p>
</div>
<div id="test-of-normality" class="section level3 hasAnchor" number="22.11.4">
<h3><span class="header-section-number">22.11.4</span> Test of normality<a href="in-class-assignments.html#test-of-normality" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>Tests</em> can be performed in two ways, a qualitative examination and a quantitative (statistical test).</p>
</div>
<div id="qualitative-examination-of-normality" class="section level3 hasAnchor" number="22.11.5">
<h3><span class="header-section-number">22.11.5</span> Qualitative examination of normality<a href="in-class-assignments.html#qualitative-examination-of-normality" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="in-class-assignments.html#cb126-1" tabindex="-1"></a>hb <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb126-2"><a href="in-class-assignments.html#cb126-2" tabindex="-1"></a><span class="fu">hist</span>(hb, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;Histogram of hemoglobin values&quot;</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xlab =</span> <span class="st">&quot;Hemoglobin&quot;</span>)</span>
<span id="cb126-3"><a href="in-class-assignments.html#cb126-3" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(hb))</span></code></pre></div>
<p>From the plot above it seems obvious that the data are normally distributed.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="in-class-assignments.html#cb127-1" tabindex="-1"></a>hb <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb127-2"><a href="in-class-assignments.html#cb127-2" tabindex="-1"></a><span class="fu">qqnorm</span>(hb, <span class="at">main =</span> <span class="st">&quot;QQ plot of hemoglobin values&quot;</span>)</span>
<span id="cb127-3"><a href="in-class-assignments.html#cb127-3" tabindex="-1"></a><span class="fu">qqline</span>(hb)</span></code></pre></div>
<p>The QQ plot below plots the sample quantile of each data point value against its theoretical quantile. A line is added for clarity. The closer the data point values follow the line, the more likely that our assumption has been met.</p>
</div>
<div id="use-a-statistical-test-to-evaluate-normality" class="section level3 hasAnchor" number="22.11.6">
<h3><span class="header-section-number">22.11.6</span> Use a statistical test to evaluate normality<a href="in-class-assignments.html#use-a-statistical-test-to-evaluate-normality" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here we will use the Shapiro-Wilks test</p>
<p>The null hypothesis is that the observations are normally distributed.</p>
<p>A <em>p</em> value of less than <span class="math inline">\(\alpha\)</span> indicates that the assumption for normality is NOT met.</p>
<p>Below the hb variables is passed as argument to the shapiro.test() command, resulting in the same test statistic and <em>p</em> value as above.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="in-class-assignments.html#cb128-1" tabindex="-1"></a>hb <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb128-2"><a href="in-class-assignments.html#cb128-2" tabindex="-1"></a><span class="fu">shapiro.test</span>(hb)</span></code></pre></div>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="in-class-assignments.html#cb129-1" tabindex="-1"></a>hb <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">100</span>)</span>
<span id="cb129-2"><a href="in-class-assignments.html#cb129-2" tabindex="-1"></a><span class="fu">shapiro.test</span>(hb)</span></code></pre></div>
<p>Why is it essential to examine the normality of data when conducting parametric correlation analysis?</p>
<p>What are the assumptions that need to be met for parametric statistical tests, including correlation analysis? Explain why these assumptions are crucial for accurate results.</p>
<p>How can you test the normality of a dataset quantitatively using statistical tests like the Shapiro-Wilk test in R? What does a significant p-value in this test indicate?</p>
<p>What is the purpose of testing the homogeneity of variance when performing correlation analysis? How can you conduct the Levene test in R to assess homogeneity of variance?</p>
</div>
<div id="test-the-homogeneity-of-variance" class="section level3 hasAnchor" number="22.11.7">
<h3><span class="header-section-number">22.11.7</span> Test the homogeneity of variance<a href="in-class-assignments.html#test-the-homogeneity-of-variance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Levene test is used to test for homogeneity of variance.</p>
<p>The null hypothesis states equality of variances. In order to conduct Levene’s test, the Companion to Applied Regression, car, package is required.</p>
<p>The car::leveneTest() command requires the use of a data.frame object. So, both variables must be in the same dataframe. So we need to do some manipulation.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="in-class-assignments.html#cb130-1" tabindex="-1"></a>test.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb130-2"><a href="in-class-assignments.html#cb130-2" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">y =</span> mtcars<span class="sc">$</span>mpg, <span class="at">group =</span> <span class="dv">1</span>),</span>
<span id="cb130-3"><a href="in-class-assignments.html#cb130-3" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">y =</span> mtcars<span class="sc">$</span>qsec, <span class="at">group =</span> <span class="dv">2</span>))</span>
<span id="cb130-4"><a href="in-class-assignments.html#cb130-4" tabindex="-1"></a>test.data<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(test.data<span class="sc">$</span>group)</span>
<span id="cb130-5"><a href="in-class-assignments.html#cb130-5" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">leveneTest</span>(test.data<span class="sc">$</span>y, test.data<span class="sc">$</span>group)</span></code></pre></div>
</div>
<div id="lets-perform-the-statistical-investigation-of-correlation" class="section level3 hasAnchor" number="22.11.8">
<h3><span class="header-section-number">22.11.8</span> Lets perform the statistical investigation of correlation<a href="in-class-assignments.html#lets-perform-the-statistical-investigation-of-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>What is the hypothesis that we will test?</p>
<p>What are the steps we need to do this?</p>
<p>To determine if we will “accept” or “fail to reject” we will determine the <em>p</em>-value of the data given the null hypothesis.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="in-class-assignments.html#cb131-1" tabindex="-1"></a><span class="co"># Some code for you to explore</span></span>
<span id="cb131-2"><a href="in-class-assignments.html#cb131-2" tabindex="-1"></a>?cor</span>
<span id="cb131-3"><a href="in-class-assignments.html#cb131-3" tabindex="-1"></a><span class="fu">cor</span>(mtcars<span class="sc">$</span>mpg, mtcars<span class="sc">$</span>hp)</span>
<span id="cb131-4"><a href="in-class-assignments.html#cb131-4" tabindex="-1"></a></span>
<span id="cb131-5"><a href="in-class-assignments.html#cb131-5" tabindex="-1"></a>?cor.test</span>
<span id="cb131-6"><a href="in-class-assignments.html#cb131-6" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="at">x =</span> mtcars<span class="sc">$</span>mpg, <span class="at">y =</span> mtcars<span class="sc">$</span>hp, <span class="at">method =</span> <span class="st">&#39;pearson&#39;</span>)</span>
<span id="cb131-7"><a href="in-class-assignments.html#cb131-7" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="at">x =</span> mtcars<span class="sc">$</span>mpg, <span class="at">y =</span> mtcars<span class="sc">$</span>hp, <span class="at">method =</span> <span class="st">&#39;spearman&#39;</span>)</span></code></pre></div>
<p>Explain the concept of covariance and its significance in correlation analysis. How is it calculated, and what information does it provide about the relationship between two variables?</p>
<p>What is the Pearson’s correlation coefficient, and how does it quantify the strength and direction of a linear relationship between two variables? How is it calculated in R?</p>
<p>Describe the steps involved in hypothesis testing for correlation analysis. What null and alternative hypotheses are typically used when assessing the correlation between two variables?</p>
<p>How do you calculate the coefficient of determination (r-squared) in correlation analysis? What does it represent, and how is it interpreted in the context of the correlation between two variables?</p>
</div>
<div id="correlation-simulation" class="section level3 hasAnchor" number="22.11.9">
<h3><span class="header-section-number">22.11.9</span> Correlation Simulation<a href="in-class-assignments.html#correlation-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Function to explore the correlation structure and resulting Spearman and Pearson Correlation rejection rates for user specified number of data points and correlation values.Note bivariate correlation structure is determined using the normal distribiution. This function requires the “MASS” package for successful execution.</p>
<p>Paste the code so that you can run the function ‘corr.power.simul’</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="in-class-assignments.html#cb132-1" tabindex="-1"></a><span class="fu">require</span>(mvtnorm)</span>
<span id="cb132-2"><a href="in-class-assignments.html#cb132-2" tabindex="-1"></a><span class="fu">require</span>(MASS)</span>
<span id="cb132-3"><a href="in-class-assignments.html#cb132-3" tabindex="-1"></a></span>
<span id="cb132-4"><a href="in-class-assignments.html#cb132-4" tabindex="-1"></a>corr.power.simul <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">cor.val =</span> <span class="fl">0.5</span>, <span class="at">number.pts =</span> <span class="dv">20</span>) {</span>
<span id="cb132-5"><a href="in-class-assignments.html#cb132-5" tabindex="-1"></a>  cor.data.frame <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">nrow =</span> <span class="dv">100</span>)</span>
<span id="cb132-6"><a href="in-class-assignments.html#cb132-6" tabindex="-1"></a>  </span>
<span id="cb132-7"><a href="in-class-assignments.html#cb132-7" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb132-8"><a href="in-class-assignments.html#cb132-8" tabindex="-1"></a>    Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb132-9"><a href="in-class-assignments.html#cb132-9" tabindex="-1"></a>    Sigma[<span class="dv">1</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> Sigma[<span class="dv">2</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> cor.val</span>
<span id="cb132-10"><a href="in-class-assignments.html#cb132-10" tabindex="-1"></a>    </span>
<span id="cb132-11"><a href="in-class-assignments.html#cb132-11" tabindex="-1"></a>    rawvars <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="at">n=</span>number.pts, <span class="at">mu=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">Sigma=</span>Sigma)</span>
<span id="cb132-12"><a href="in-class-assignments.html#cb132-12" tabindex="-1"></a>    </span>
<span id="cb132-13"><a href="in-class-assignments.html#cb132-13" tabindex="-1"></a>    cor.data.frame[j,<span class="dv">1</span>] <span class="ot">&lt;-</span> cor.val</span>
<span id="cb132-14"><a href="in-class-assignments.html#cb132-14" tabindex="-1"></a>    cor.data.frame[j,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">cor</span>(rawvars, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb132-15"><a href="in-class-assignments.html#cb132-15" tabindex="-1"></a>    cor.data.frame[j,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(rawvars[,<span class="dv">1</span>], rawvars[,<span class="dv">2</span>], </span>
<span id="cb132-16"><a href="in-class-assignments.html#cb132-16" tabindex="-1"></a>                                    <span class="st">&quot;pearson&quot;</span>, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb132-17"><a href="in-class-assignments.html#cb132-17" tabindex="-1"></a>    cor.data.frame[j,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">cor</span>(rawvars, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb132-18"><a href="in-class-assignments.html#cb132-18" tabindex="-1"></a>    cor.data.frame[j,<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(rawvars[,<span class="dv">1</span>], rawvars[,<span class="dv">2</span>], </span>
<span id="cb132-19"><a href="in-class-assignments.html#cb132-19" tabindex="-1"></a>                                    <span class="st">&quot;spearman&quot;</span>, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb132-20"><a href="in-class-assignments.html#cb132-20" tabindex="-1"></a>  }</span>
<span id="cb132-21"><a href="in-class-assignments.html#cb132-21" tabindex="-1"></a>  </span>
<span id="cb132-22"><a href="in-class-assignments.html#cb132-22" tabindex="-1"></a>  cor.data.frame <span class="ot">&lt;-</span> <span class="fu">round</span>(cor.data.frame,<span class="dv">4</span>)</span>
<span id="cb132-23"><a href="in-class-assignments.html#cb132-23" tabindex="-1"></a>  cor.data.frame <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(cor.data.frame)</span>
<span id="cb132-24"><a href="in-class-assignments.html#cb132-24" tabindex="-1"></a>  <span class="fu">names</span>(cor.data.frame) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Correlation&quot;</span>, <span class="st">&quot;Pearson.Cor.&quot;</span>,<span class="st">&quot;Pearson.prob.&quot;</span>, </span>
<span id="cb132-25"><a href="in-class-assignments.html#cb132-25" tabindex="-1"></a>                             <span class="st">&quot;Spearman.Cor.&quot;</span>, <span class="st">&quot;Spearman.prob.&quot;</span>)</span>
<span id="cb132-26"><a href="in-class-assignments.html#cb132-26" tabindex="-1"></a>  </span>
<span id="cb132-27"><a href="in-class-assignments.html#cb132-27" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Pearson test fails to reject (accepts) null hypothesis&quot;</span>, </span>
<span id="cb132-28"><a href="in-class-assignments.html#cb132-28" tabindex="-1"></a>              <span class="fu">length</span>(<span class="fu">which</span>(cor.data.frame<span class="sc">$</span>Pearson.prob. <span class="sc">&gt;=</span> <span class="fl">0.05</span>)), <span class="st">&quot;out of 100 trials&quot;</span>))</span>
<span id="cb132-29"><a href="in-class-assignments.html#cb132-29" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Spearman test fails to reject (accepts) null hypothesis&quot;</span>, </span>
<span id="cb132-30"><a href="in-class-assignments.html#cb132-30" tabindex="-1"></a>              <span class="fu">length</span>(<span class="fu">which</span>(cor.data.frame<span class="sc">$</span>Spearman.prob. <span class="sc">&gt;=</span> <span class="fl">0.05</span>)), <span class="st">&quot;out of 100 trials&quot;</span>))</span>
<span id="cb132-31"><a href="in-class-assignments.html#cb132-31" tabindex="-1"></a>  </span>
<span id="cb132-32"><a href="in-class-assignments.html#cb132-32" tabindex="-1"></a>  </span>
<span id="cb132-33"><a href="in-class-assignments.html#cb132-33" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>)) </span>
<span id="cb132-34"><a href="in-class-assignments.html#cb132-34" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb132-35"><a href="in-class-assignments.html#cb132-35" tabindex="-1"></a>  <span class="fu">plot</span>(rawvars[,<span class="dv">1</span>], rawvars[,<span class="dv">2</span>],<span class="at">xlab =</span> <span class="st">&#39;x&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;y&#39;</span>)</span>
<span id="cb132-36"><a href="in-class-assignments.html#cb132-36" tabindex="-1"></a>  </span>
<span id="cb132-37"><a href="in-class-assignments.html#cb132-37" tabindex="-1"></a>  <span class="fu">plot</span>(cor.data.frame[,<span class="dv">2</span>], cor.data.frame[,<span class="dv">3</span>], <span class="at">xlab =</span> <span class="st">&quot;Pearson.Cor.&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Pearson.prob.&quot;</span>)</span>
<span id="cb132-38"><a href="in-class-assignments.html#cb132-38" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.05</span>)</span>
<span id="cb132-39"><a href="in-class-assignments.html#cb132-39" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&#39;topright&#39;</span>, <span class="at">legend =</span> <span class="fu">rbind</span>(<span class="fu">paste</span>(<span class="st">&quot;Pearson test reject null hypothesis&quot;</span>, </span>
<span id="cb132-40"><a href="in-class-assignments.html#cb132-40" tabindex="-1"></a>                                          <span class="dv">100</span> <span class="sc">-</span> <span class="fu">length</span>(<span class="fu">which</span>(cor.data.frame<span class="sc">$</span>Pearson.prob. <span class="sc">&gt;=</span> <span class="fl">0.05</span>)), <span class="st">&quot;out of 100 trials&quot;</span>), <span class="fu">paste</span>(<span class="st">&#39;Simulated data using r =&#39;</span>,cor.val,<span class="st">&quot;from&quot;</span>,number.pts,<span class="st">&quot;points&quot;</span>)))</span>
<span id="cb132-41"><a href="in-class-assignments.html#cb132-41" tabindex="-1"></a>  </span>
<span id="cb132-42"><a href="in-class-assignments.html#cb132-42" tabindex="-1"></a>  <span class="fu">points</span>(cor.data.frame[<span class="fu">which</span>(cor.data.frame[,<span class="dv">3</span>] <span class="sc">&gt;</span> <span class="fl">0.05</span>),<span class="dv">2</span>], </span>
<span id="cb132-43"><a href="in-class-assignments.html#cb132-43" tabindex="-1"></a>         cor.data.frame[<span class="fu">which</span>(cor.data.frame[,<span class="dv">3</span>] <span class="sc">&gt;</span> <span class="fl">0.05</span>),<span class="dv">3</span>],</span>
<span id="cb132-44"><a href="in-class-assignments.html#cb132-44" tabindex="-1"></a>         <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb132-45"><a href="in-class-assignments.html#cb132-45" tabindex="-1"></a>  </span>
<span id="cb132-46"><a href="in-class-assignments.html#cb132-46" tabindex="-1"></a></span>
<span id="cb132-47"><a href="in-class-assignments.html#cb132-47" tabindex="-1"></a>  <span class="fu">plot</span>(cor.data.frame[,<span class="dv">4</span>], cor.data.frame[,<span class="dv">5</span>], <span class="at">xlab =</span> <span class="st">&quot;Spearman.Cor.&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Spearman.prob.&quot;</span>)</span>
<span id="cb132-48"><a href="in-class-assignments.html#cb132-48" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.05</span>)</span>
<span id="cb132-49"><a href="in-class-assignments.html#cb132-49" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&#39;topright&#39;</span>, <span class="at">legend =</span> <span class="fu">rbind</span>(<span class="fu">paste</span>(<span class="st">&quot;Spearman test reject null hypothesis&quot;</span>, </span>
<span id="cb132-50"><a href="in-class-assignments.html#cb132-50" tabindex="-1"></a>                                          <span class="dv">100</span> <span class="sc">-</span> <span class="fu">length</span>(<span class="fu">which</span>(cor.data.frame<span class="sc">$</span>Spearman.prob. <span class="sc">&gt;=</span> <span class="fl">0.05</span>)), <span class="st">&quot;out of 100 trials&quot;</span>), <span class="fu">paste</span>(<span class="st">&#39;Simulated data using r =&#39;</span>,cor.val,<span class="st">&quot;from&quot;</span>,number.pts,<span class="st">&quot;points&quot;</span>)))</span>
<span id="cb132-51"><a href="in-class-assignments.html#cb132-51" tabindex="-1"></a>  </span>
<span id="cb132-52"><a href="in-class-assignments.html#cb132-52" tabindex="-1"></a>    <span class="fu">points</span>(cor.data.frame[<span class="fu">which</span>(cor.data.frame[,<span class="dv">5</span>] <span class="sc">&gt;</span> <span class="fl">0.05</span>),<span class="dv">4</span>], </span>
<span id="cb132-53"><a href="in-class-assignments.html#cb132-53" tabindex="-1"></a>         cor.data.frame[<span class="fu">which</span>(cor.data.frame[,<span class="dv">5</span>] <span class="sc">&gt;</span> <span class="fl">0.05</span>),<span class="dv">5</span>],</span>
<span id="cb132-54"><a href="in-class-assignments.html#cb132-54" tabindex="-1"></a>         <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb132-55"><a href="in-class-assignments.html#cb132-55" tabindex="-1"></a>  </span>
<span id="cb132-56"><a href="in-class-assignments.html#cb132-56" tabindex="-1"></a>  </span>
<span id="cb132-57"><a href="in-class-assignments.html#cb132-57" tabindex="-1"></a>  <span class="co"># return(cor.data.frame)</span></span>
<span id="cb132-58"><a href="in-class-assignments.html#cb132-58" tabindex="-1"></a>}</span>
<span id="cb132-59"><a href="in-class-assignments.html#cb132-59" tabindex="-1"></a></span>
<span id="cb132-60"><a href="in-class-assignments.html#cb132-60" tabindex="-1"></a></span>
<span id="cb132-61"><a href="in-class-assignments.html#cb132-61" tabindex="-1"></a><span class="fu">corr.power.simul</span>(<span class="at">cor.val =</span> <span class="fl">0.75</span>, <span class="at">number.pts =</span> <span class="dv">10</span>)</span>
<span id="cb132-62"><a href="in-class-assignments.html#cb132-62" tabindex="-1"></a><span class="fu">corr.power.simul</span>(<span class="at">cor.val =</span> <span class="fl">0.55</span>, <span class="at">number.pts =</span> <span class="dv">10</span>)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p><strong>Power Calculation in Pearson Correlation:</strong> How can you calculate the statistical power of a Pearson correlation test, and what factors should be considered in this calculation? How does the chosen significance level (alpha) influence the power of the test?</p></li>
<li><p><strong>Interpreting Type I and Type II Errors:</strong> Explain the consequences of committing a Type I error in Pearson correlation analysis, especially in fields like clinical research. How might a researcher minimize the risk of Type I errors without increasing Type II errors?</p></li>
<li><p><strong>Sample Size Determination:</strong> In a graduate-level research study using Pearson correlation analysis, describe the process of determining an appropriate sample size to achieve a desired level of power. How does effect size play a role in this determination?</p></li>
<li><p><strong>Spearman Correlation and Nonlinearity:</strong> How does the Spearman correlation handle nonlinear relationships between variables, and what impact does this have on the likelihood of Type I and Type II errors compared to Pearson correlation? Develope some simulation to illustrate the differences.</p></li>
<li><p><strong>Practical Considerations for Real Data:</strong> In applied research, researchers often deal with imperfect data, outliers, and non-normality. Discuss how these factors can affect the power, Type I, and Type II error rates in both Pearson and Spearman correlation analyses. What strategies can be employed to address these challenges?</p></li>
</ol>
</div>
</div>
<div id="simple-linear-regression" class="section level2 hasAnchor" number="22.12">
<h2><span class="header-section-number">22.12</span> Simple linear regression<a href="in-class-assignments.html#simple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this in class assignment we will be focusing on using an analysis appropriate for a quantitative outcome and a single quantitative explanatory variable.</p>
<p>outcome = model + error</p>
<p>We postulate a linear relationship between the population mean of the outcome and the value of the explanatory variable. If we let Y be some outcome, and X be some explanatory variable, then we can express the structural model using a linear model.</p>
<div id="assumptions" class="section level3 hasAnchor" number="22.12.1">
<h3><span class="header-section-number">22.12.1</span> Assumptions<a href="in-class-assignments.html#assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Assumptions of simple linear regression:</p>
<p>1a. Linear relationship of y and x</p>
<p>1b. It is OK to transform x or Y, and that allows many non-linear relationships to be represented on a new scale that makes the relationship linear.</p>
<ol start="2" style="list-style-type: decimal">
<li><p>Generally, it is not recommended to perform extrapolation to make predictions outside of the range of x values</p></li>
<li><p>All assumptions consistent with parametric statistics</p></li>
</ol>
</div>
<div id="computation-example" class="section level3 hasAnchor" number="22.12.2">
<h3><span class="header-section-number">22.12.2</span> Computation Example<a href="in-class-assignments.html#computation-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider a survey of daily air quality measurements in New York, May to September 1973.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="in-class-assignments.html#cb133-1" tabindex="-1"></a><span class="co"># Import the data</span></span>
<span id="cb133-2"><a href="in-class-assignments.html#cb133-2" tabindex="-1"></a><span class="fu">require</span>(datasets)</span>
<span id="cb133-3"><a href="in-class-assignments.html#cb133-3" tabindex="-1"></a></span>
<span id="cb133-4"><a href="in-class-assignments.html#cb133-4" tabindex="-1"></a><span class="co"># Lets look at the data &quot;airquality&quot;</span></span>
<span id="cb133-5"><a href="in-class-assignments.html#cb133-5" tabindex="-1"></a><span class="fu">head</span>(airquality)</span>
<span id="cb133-6"><a href="in-class-assignments.html#cb133-6" tabindex="-1"></a><span class="fu">names</span>(airquality)</span>
<span id="cb133-7"><a href="in-class-assignments.html#cb133-7" tabindex="-1"></a></span>
<span id="cb133-8"><a href="in-class-assignments.html#cb133-8" tabindex="-1"></a><span class="co">#We will reduce the size of the data</span></span>
<span id="cb133-9"><a href="in-class-assignments.html#cb133-9" tabindex="-1"></a>airquality<span class="fl">.2</span> <span class="ot">&lt;-</span> airquality[<span class="fu">complete.cases</span>(airquality),]</span>
<span id="cb133-10"><a href="in-class-assignments.html#cb133-10" tabindex="-1"></a></span>
<span id="cb133-11"><a href="in-class-assignments.html#cb133-11" tabindex="-1"></a><span class="co"># Lets construct a linear model.</span></span>
<span id="cb133-12"><a href="in-class-assignments.html#cb133-12" tabindex="-1"></a><span class="co"># The response variable in the regression is Ozone. What do you think is the best predictor.</span></span>
<span id="cb133-13"><a href="in-class-assignments.html#cb133-13" tabindex="-1"></a></span>
<span id="cb133-14"><a href="in-class-assignments.html#cb133-14" tabindex="-1"></a><span class="co"># Plot it:</span></span>
<span id="cb133-15"><a href="in-class-assignments.html#cb133-15" tabindex="-1"></a><span class="fu">plot</span>(airquality<span class="fl">.2</span><span class="sc">$</span>Wind, airquality<span class="fl">.2</span><span class="sc">$</span>Ozone)</span></code></pre></div>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="in-class-assignments.html#cb134-1" tabindex="-1"></a><span class="fu">plot</span>(airquality<span class="fl">.2</span><span class="sc">$</span>Solar.R, airquality<span class="fl">.2</span><span class="sc">$</span>Ozone)</span></code></pre></div>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="in-class-assignments.html#cb135-1" tabindex="-1"></a><span class="fu">plot</span>(airquality<span class="fl">.2</span><span class="sc">$</span>Temp, airquality<span class="fl">.2</span><span class="sc">$</span>Ozone)</span></code></pre></div>
<p>Choose a predictor variable that you think will best describe patterns of Ozone in NYC</p>
<p>Use your knowledge of parametric statstics to ensure that the assumptions are met</p>
<p>Now we can build the model:</p>
<p>We will use the stereotyped format in R (by stereotyped I mean that ALL of the models you build in R follow this syntax).</p>
<p>The function used for building linear models is lm().</p>
<p>The lm() function takes two main arguments:</p>
<ol style="list-style-type: decimal">
<li><p>Formula</p></li>
<li><p>Data. The data is typically a data.frame and the formula is a object of class formula.</p></li>
</ol>
<p>But the most common convention is to write out the formula directly in place of the argument as written below.</p>
<p>linearMod &lt;- lm(Y ~ X, data=Your.Data)</p>
<p>We will use the “lm” function to make the model and assign it to an object. Look at the anatomy of the function.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="in-class-assignments.html#cb136-1" tabindex="-1"></a><span class="fu">lm</span>(Ozone <span class="sc">~</span> Temp, <span class="at">data =</span> airquality<span class="fl">.2</span>)</span></code></pre></div>
<p>Parameter estimates can be derived from least-squares analysis. We will be minimizing the sum of squared differences (the residuals) and we will let the computer do this for us.</p>
<p>We will want to evaluate the patterns in the residuals (deviations). What does the runs of positive and negative residuals mean?</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="in-class-assignments.html#cb137-1" tabindex="-1"></a><span class="co"># Run this code in your R console - we will investigate the model object</span></span>
<span id="cb137-2"><a href="in-class-assignments.html#cb137-2" tabindex="-1"></a></span>
<span id="cb137-3"><a href="in-class-assignments.html#cb137-3" tabindex="-1"></a>lm.mod.obj <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ozone <span class="sc">~</span> Temp, <span class="at">data =</span> airquality<span class="fl">.2</span>)</span>
<span id="cb137-4"><a href="in-class-assignments.html#cb137-4" tabindex="-1"></a></span>
<span id="cb137-5"><a href="in-class-assignments.html#cb137-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">oma =</span> <span class="fu">rep</span>(<span class="fl">1.5</span>,<span class="dv">4</span>), <span class="at">mar =</span> <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">4</span>))</span>
<span id="cb137-6"><a href="in-class-assignments.html#cb137-6" tabindex="-1"></a><span class="fu">plot</span>(airquality<span class="fl">.2</span><span class="sc">$</span>Temp, airquality<span class="fl">.2</span><span class="sc">$</span>Ozone)</span>
<span id="cb137-7"><a href="in-class-assignments.html#cb137-7" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="st">&quot;Regression Model&quot;</span>)</span>
<span id="cb137-8"><a href="in-class-assignments.html#cb137-8" tabindex="-1"></a><span class="fu">abline</span>(lm.mod.obj)</span>
<span id="cb137-9"><a href="in-class-assignments.html#cb137-9" tabindex="-1"></a></span>
<span id="cb137-10"><a href="in-class-assignments.html#cb137-10" tabindex="-1"></a><span class="fu">summary</span>(lm.mod.obj)</span>
<span id="cb137-11"><a href="in-class-assignments.html#cb137-11" tabindex="-1"></a></span>
<span id="cb137-12"><a href="in-class-assignments.html#cb137-12" tabindex="-1"></a><span class="co"># We see that B0 = -146.9955 and B1 = 2.4287</span></span>
<span id="cb137-13"><a href="in-class-assignments.html#cb137-13" tabindex="-1"></a><span class="fu">plot</span>(airquality<span class="fl">.2</span><span class="sc">$</span>Temp, lm.mod.obj<span class="sc">$</span>residuals, <span class="at">type =</span> <span class="st">&#39;h&#39;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb137-14"><a href="in-class-assignments.html#cb137-14" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="st">&quot;Residual deviations&quot;</span>)</span>
<span id="cb137-15"><a href="in-class-assignments.html#cb137-15" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span>
<span id="cb137-16"><a href="in-class-assignments.html#cb137-16" tabindex="-1"></a></span>
<span id="cb137-17"><a href="in-class-assignments.html#cb137-17" tabindex="-1"></a><span class="fu">hist</span>(lm.mod.obj<span class="sc">$</span>residuals, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb137-18"><a href="in-class-assignments.html#cb137-18" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="st">&quot;Histogram of Residual deviations&quot;</span>)</span></code></pre></div>
<p>Lets look at the ANOVA table</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="in-class-assignments.html#cb138-1" tabindex="-1"></a><span class="co"># Run this code in your R console - we will investigate the model object</span></span>
<span id="cb138-2"><a href="in-class-assignments.html#cb138-2" tabindex="-1"></a><span class="fu">anova</span>(lm.mod.obj)</span>
<span id="cb138-3"><a href="in-class-assignments.html#cb138-3" tabindex="-1"></a><span class="fu">coef</span>(lm.mod.obj)</span></code></pre></div>
</div>
<div id="failure-to-meet-assumptions" class="section level3 hasAnchor" number="22.12.3">
<h3><span class="header-section-number">22.12.3</span> Failure to meet assumptions<a href="in-class-assignments.html#failure-to-meet-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>What if the relationship of y and x are not linear?</p>
<p>Log-transforming Only the Predictor for SLR</p>
<p>In this section, we learn how to build and use a simple linear regression model by transforming the values.
This might be the first thing that you try if you find a non-linear trend in your data.</p>
<p>Note, though, that it may be necessary to correct the non-linearity before you can assess the normality and equal variance assumptions. Also, while some assumptions may appear to hold prior to applying a transformation, they may no longer hold once a transformation is applied. In other words, using transformations is part of an iterative process where all the linear regression assumptions are re-checked after each iteration.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="in-class-assignments.html#cb139-1" tabindex="-1"></a><span class="fu">require</span>(<span class="st">&#39;openintro&#39;</span>)</span></code></pre></div>
<pre><code>## Loading required package: openintro</code></pre>
<pre><code>## Loading required package: airports</code></pre>
<pre><code>## Loading required package: cherryblossom</code></pre>
<pre><code>## Loading required package: usdata</code></pre>
<pre><code>## 
## Attaching package: &#39;openintro&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:MASS&#39;:
## 
##     housing, mammals</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="in-class-assignments.html#cb146-1" tabindex="-1"></a><span class="fu">hist</span>(openintro<span class="sc">::</span>mammals<span class="sc">$</span>body_wt)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-198-1.png" width="672" /></p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="in-class-assignments.html#cb147-1" tabindex="-1"></a><span class="fu">hist</span>(openintro<span class="sc">::</span>mammals<span class="sc">$</span>brain_wt)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-198-2.png" width="672" /></p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="in-class-assignments.html#cb148-1" tabindex="-1"></a><span class="fu">plot</span>(openintro<span class="sc">::</span>mammals<span class="sc">$</span>body_wt, openintro<span class="sc">::</span>mammals<span class="sc">$</span>brain_wt)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-198-3.png" width="672" /></p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="in-class-assignments.html#cb149-1" tabindex="-1"></a>lm.model <span class="ot">=</span> <span class="fu">lm</span>(brain_wt <span class="sc">~</span> body_wt, <span class="at">data =</span> openintro<span class="sc">::</span>mammals)</span>
<span id="cb149-2"><a href="in-class-assignments.html#cb149-2" tabindex="-1"></a><span class="fu">anova</span>(lm.model)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: brain_wt
##           Df   Sum Sq  Mean Sq F value    Pr(&gt;F)    
## body_wt    1 46068314 46068314  411.19 &lt; 2.2e-16 ***
## Residuals 60  6722239   112037                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="in-class-assignments.html#cb151-1" tabindex="-1"></a><span class="fu">summary</span>(lm.model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = brain_wt ~ body_wt, data = openintro::mammals)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -810.07  -88.52  -79.64  -13.02 2050.33 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 91.00440   43.55258    2.09   0.0409 *  
## body_wt      0.96650    0.04766   20.28   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 334.7 on 60 degrees of freedom
## Multiple R-squared:  0.8727, Adjusted R-squared:  0.8705 
## F-statistic: 411.2 on 1 and 60 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Notice how the residual standard error is high: 334.7.</p>
<p>Maybe a log-transformation in the values might help us to improve the model. For that, we will use the log function, which, by default, computes the natural logarithm of a given number or set of numbers.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="in-class-assignments.html#cb153-1" tabindex="-1"></a><span class="fu">require</span>(<span class="st">&#39;openintro&#39;</span>)</span>
<span id="cb153-2"><a href="in-class-assignments.html#cb153-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(openintro<span class="sc">::</span>mammals<span class="sc">$</span>body_wt), <span class="fu">log</span>(openintro<span class="sc">::</span>mammals<span class="sc">$</span>brain_wt))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-199-1.png" width="672" /></p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="in-class-assignments.html#cb154-1" tabindex="-1"></a>lm.model <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(brain_wt) <span class="sc">~</span> <span class="fu">log</span>(body_wt), <span class="at">data =</span> openintro<span class="sc">::</span>mammals)</span>
<span id="cb154-2"><a href="in-class-assignments.html#cb154-2" tabindex="-1"></a><span class="fu">anova</span>(lm.model)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: log(brain_wt)
##              Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## log(body_wt)  1 336.19  336.19  697.42 &lt; 2.2e-16 ***
## Residuals    60  28.92    0.48                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="in-class-assignments.html#cb156-1" tabindex="-1"></a><span class="fu">summary</span>(lm.model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(brain_wt) ~ log(body_wt), data = openintro::mammals)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.71550 -0.49228 -0.06162  0.43597  1.94829 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   2.13479    0.09604   22.23   &lt;2e-16 ***
## log(body_wt)  0.75169    0.02846   26.41   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6943 on 60 degrees of freedom
## Multiple R-squared:  0.9208, Adjusted R-squared:  0.9195 
## F-statistic: 697.4 on 1 and 60 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><br />
</p>
</div>
</div>
<div id="logistic-regression" class="section level2 hasAnchor" number="22.13">
<h2><span class="header-section-number">22.13</span> Logistic Regression<a href="in-class-assignments.html#logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>1.) estimate a logistic regression</p>
<p>2.) interpret coefficients (as they affect odds and probability)</p>
<p>3.) understand how glm() handles categorical variables</p>
<p>4.) make predictions</p>
<div id="we-are-interested-in-understanding-the-relationships-of-two-variables" class="section level3 hasAnchor" number="22.13.1">
<h3><span class="header-section-number">22.13.1</span> We are interested in understanding the relationships of two variables<a href="in-class-assignments.html#we-are-interested-in-understanding-the-relationships-of-two-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Logistic regression is a method for fitting a regression curve, <span class="math inline">\(y\)</span> = <span class="math inline">\(f(x)\)</span>, when <span class="math inline">\(y\)</span> is a categorical variable. The typical use of this model is predicting <span class="math inline">\(Y\)</span> given a set of predictors <span class="math inline">\(X\)</span>. The predictors can be continuous, categorical or a mix of both (in the case of including multiple <span class="math inline">\(\beta\)</span> values.</p>
<p>Recall simple linear regression:</p>
<p><span class="math inline">\(Y_i = \beta_0 + \beta_1X_i\)</span>.</p>
<p>We will now predict the probability that <span class="math inline">\(y\)</span> will occur given the known values of <span class="math inline">\(X\)</span>.</p>
<p><span class="math inline">\(P(Y_i) = \frac{1}{1 + e^-(\beta_0 + \beta_1X_i)}\)</span></p>
<p>The categorical variable <span class="math inline">\(y\)</span>, in general, can assume different values. In the simplest case scenario the dependent variable <span class="math inline">\(y\)</span> is binary meaning that it can assumes a value 1 or 0.</p>
</div>
<div id="logistic-regression-analysis" class="section level3 hasAnchor" number="22.13.2">
<h3><span class="header-section-number">22.13.2</span> Logistic regression analysis<a href="in-class-assignments.html#logistic-regression-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider a study that looks at survival (of some organism) as a function of body size. In ploikiotherms we often think of survival increasing with body size, does that hold true?</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="in-class-assignments.html#cb158-1" tabindex="-1"></a><span class="co"># First, we&#39;ll create a data set of 20 individuals of different body sizes:</span></span>
<span id="cb158-2"><a href="in-class-assignments.html#cb158-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb158-3"><a href="in-class-assignments.html#cb158-3" tabindex="-1"></a>bodysize <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">10</span>)), <span class="fu">round</span>(<span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>,<span class="dv">10</span>,<span class="dv">30</span>))) <span class="co"># sorts these values in ascending order.</span></span>
<span id="cb158-4"><a href="in-class-assignments.html#cb158-4" tabindex="-1"></a>survive <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="fl">0.7</span>)), <span class="fu">round</span>(<span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>,<span class="fl">0.4</span>,<span class="fl">1.3</span>))) <span class="co"># assign &#39;survival&#39; to these 20 individuals non-randomly</span></span>
<span id="cb158-5"><a href="in-class-assignments.html#cb158-5" tabindex="-1"></a></span>
<span id="cb158-6"><a href="in-class-assignments.html#cb158-6" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(bodysize,survive)) <span class="co"># saves dataframe with two columns: body size &amp; survival</span></span>
<span id="cb158-7"><a href="in-class-assignments.html#cb158-7" tabindex="-1"></a>dat <span class="co"># Print the data to screen</span></span>
<span id="cb158-8"><a href="in-class-assignments.html#cb158-8" tabindex="-1"></a></span>
<span id="cb158-9"><a href="in-class-assignments.html#cb158-9" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> dat<span class="sc">$</span>bodysize, <span class="at">y =</span> dat<span class="sc">$</span>survive,</span>
<span id="cb158-10"><a href="in-class-assignments.html#cb158-10" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Body size&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Probability of survival&quot;</span>) <span class="co"># plot with body size on x-axis and survival (0 or 1) on y-axis</span></span></code></pre></div>
<p>The basic regression analysis uses fairly simple formulas to get estimates of model parameters. These estimates can be derived from least-squares analysis. We will be minimizing the sum of squared differences (the residuals).</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="in-class-assignments.html#cb159-1" tabindex="-1"></a><span class="co"># Now lets fit the model, run a logistic regression model (in this case, generalized linear model with logit link). see ?glm</span></span>
<span id="cb159-2"><a href="in-class-assignments.html#cb159-2" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">glm</span>(survive<span class="sc">~</span>bodysize,<span class="at">family=</span>binomial,dat) </span>
<span id="cb159-3"><a href="in-class-assignments.html#cb159-3" tabindex="-1"></a></span>
<span id="cb159-4"><a href="in-class-assignments.html#cb159-4" tabindex="-1"></a><span class="co"># draws a curve based on prediction from logistic regression model</span></span>
<span id="cb159-5"><a href="in-class-assignments.html#cb159-5" tabindex="-1"></a>predict.y <span class="ot">&lt;-</span> g<span class="sc">$</span>fitted.values</span>
<span id="cb159-6"><a href="in-class-assignments.html#cb159-6" tabindex="-1"></a></span>
<span id="cb159-7"><a href="in-class-assignments.html#cb159-7" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> dat<span class="sc">$</span>bodysize, <span class="at">y =</span> dat<span class="sc">$</span>survive,</span>
<span id="cb159-8"><a href="in-class-assignments.html#cb159-8" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Body size&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Probability of survival&quot;</span>) <span class="co"># plot with body size on x-axis and survival (0 or 1) on y-axis</span></span>
<span id="cb159-9"><a href="in-class-assignments.html#cb159-9" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">predict</span>(g,<span class="fu">data.frame</span>(<span class="at">bodysize=</span>x),<span class="at">type=</span><span class="st">&quot;resp&quot;</span>),<span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb159-10"><a href="in-class-assignments.html#cb159-10" tabindex="-1"></a>  </span>
<span id="cb159-11"><a href="in-class-assignments.html#cb159-11" tabindex="-1"></a><span class="fu">points</span>(bodysize,<span class="fu">fitted</span>(g),<span class="at">pch=</span><span class="dv">20</span>)</span></code></pre></div>
<p>Examine the model, we are estimating the survival</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="in-class-assignments.html#cb160-1" tabindex="-1"></a><span class="fu">summary</span>(g)</span></code></pre></div>
<p>Compare the above summary statistic to the summary statistic of the model below. The below model is fit to a different data set. What is your expectation?</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="in-class-assignments.html#cb161-1" tabindex="-1"></a><span class="co"># Examine the deviance statistic</span></span>
<span id="cb161-2"><a href="in-class-assignments.html#cb161-2" tabindex="-1"></a><span class="co"># Now re-run the model with these data - examine the plot, what is the &quot;strength&quot; of the relationship body size and survival.</span></span>
<span id="cb161-3"><a href="in-class-assignments.html#cb161-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb161-4"><a href="in-class-assignments.html#cb161-4" tabindex="-1"></a>bodysize<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">22</span>)), <span class="fu">round</span>(<span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>,<span class="dv">10</span>,<span class="dv">30</span>))) <span class="co"># sorts these values in ascending order.</span></span>
<span id="cb161-5"><a href="in-class-assignments.html#cb161-5" tabindex="-1"></a>survive<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="fl">0.7</span>)), <span class="fu">round</span>(<span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>,<span class="fl">0.3</span>,<span class="fl">1.3</span>))) <span class="co"># assign &#39;survival&#39; to these 20 individuals non-randomly</span></span>
<span id="cb161-6"><a href="in-class-assignments.html#cb161-6" tabindex="-1"></a></span>
<span id="cb161-7"><a href="in-class-assignments.html#cb161-7" tabindex="-1"></a>dat<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(bodysize<span class="fl">.2</span>, survive<span class="fl">.2</span>)) <span class="co"># saves dataframe with two columns: body size &amp; survival</span></span>
<span id="cb161-8"><a href="in-class-assignments.html#cb161-8" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> dat<span class="fl">.2</span><span class="sc">$</span>bodysize<span class="fl">.2</span>, </span>
<span id="cb161-9"><a href="in-class-assignments.html#cb161-9" tabindex="-1"></a>     <span class="at">y =</span> dat<span class="fl">.2</span><span class="sc">$</span>survive<span class="fl">.2</span>,</span>
<span id="cb161-10"><a href="in-class-assignments.html#cb161-10" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Body size&quot;</span>, </span>
<span id="cb161-11"><a href="in-class-assignments.html#cb161-11" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Probability of survival&quot;</span>) <span class="co"># plot with body size on x-axis and survival (0 or 1) on y-axis</span></span></code></pre></div>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="in-class-assignments.html#cb162-1" tabindex="-1"></a>g<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(survive<span class="fl">.2</span><span class="sc">~</span>bodysize<span class="fl">.2</span>,<span class="at">family=</span>binomial,dat<span class="fl">.2</span>) </span>
<span id="cb162-2"><a href="in-class-assignments.html#cb162-2" tabindex="-1"></a>predict.y<span class="fl">.2</span> <span class="ot">&lt;-</span> g<span class="fl">.2</span><span class="sc">$</span>fitted.values</span>
<span id="cb162-3"><a href="in-class-assignments.html#cb162-3" tabindex="-1"></a><span class="fu">summary</span>(g<span class="fl">.2</span>)</span></code></pre></div>
<p>Using Fields 8.3.2 make some statements about he deviance.</p>
<p>Using Fields 8.3.6 make some statements about the odds ratio, derived from the slope parameter.</p>
</div>
</div>
<div id="multiple-linear-regression-2" class="section level2 hasAnchor" number="22.14">
<h2><span class="header-section-number">22.14</span> Multiple Linear Regression<a href="in-class-assignments.html#multiple-linear-regression-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="in-this-in-class-assignment-we-will" class="section level3 hasAnchor" number="22.14.1">
<h3><span class="header-section-number">22.14.1</span> In this in class assignment we will:<a href="in-class-assignments.html#in-this-in-class-assignment-we-will" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>1.) Understand the assumptions of this parametric statistical approach</p>
<p>2.) Understand the structure and calculations of the multiple linear regression</p>
<p>Note, you will need to install the package “plot3d”</p>
</div>
<div id="the-assumptions-of-the-parameteric-multiple-linear-regression" class="section level3 hasAnchor" number="22.14.2">
<h3><span class="header-section-number">22.14.2</span> The assumptions of the parameteric multiple linear regression<a href="in-class-assignments.html#the-assumptions-of-the-parameteric-multiple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>1.) The variables independent</p>
<p>2.) The variables are normally distributed</p>
<p>We are interested in detecting whether there is a relationship of dependent variables to two or more independent variables
Given a linear relationship of the dependent variable and independent variables:</p>
<p><span class="math inline">\(y_i = \beta_0 + \beta_1X_{1i} + \beta_2X_{2i} + ...\beta_nX_{ni}\)</span></p>
<p>we would like to test the null hypothesis that:</p>
<p><span class="math inline">\(\beta_1 = 0\)</span>,</p>
<p><span class="math inline">\(\beta_2 = 0\)</span>,</p>
<p>and <span class="math inline">\(\beta_n = 0\)</span>.</p>
<p>Generally we are not concerned with testing the hypothesis that <span class="math inline">\(\beta_0 = 0\)</span>. The reason is that we can scale the y values to <span class="math inline">\(\overline{y} = 0\)</span>, this would ensure that <span class="math inline">\(\beta_0 = 0\)</span>. Though not often done, this is why the statistical test of <span class="math inline">\(\beta_1 = 0\)</span> is trivial.</p>
</div>
<div id="a-test-of-the-model-and-a-test-of-the-parameters" class="section level3 hasAnchor" number="22.14.3">
<h3><span class="header-section-number">22.14.3</span> A test of the model and a test of the parameters<a href="in-class-assignments.html#a-test-of-the-model-and-a-test-of-the-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In addition to testing the signicance of the parameters of the candidate linear model we will also want to test whether the model fit is a good one - does the model fit the data “well”. In our case, does the model fit the data better than a model that has an expectation of “no relationship” of the independent and dependent variables.</p>
</div>
<div id="f-test-its-not-just-for-anova" class="section level3 hasAnchor" number="22.14.4">
<h3><span class="header-section-number">22.14.4</span> F-test, its not just for ANOVA<a href="in-class-assignments.html#f-test-its-not-just-for-anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To test model fit, we will examine how the value of the F statistic is calculated:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="in-class-assignments.html#cb163-1" tabindex="-1"></a><span class="co"># First, we&#39;ll create some data</span></span>
<span id="cb163-2"><a href="in-class-assignments.html#cb163-2" tabindex="-1"></a>pig.dat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">round</span>(<span class="fu">jitter</span>(<span class="fu">seq</span>(<span class="dv">20</span>,<span class="dv">50</span>)),<span class="dv">2</span>), </span>
<span id="cb163-3"><a href="in-class-assignments.html#cb163-3" tabindex="-1"></a>                 <span class="dv">3</span><span class="sc">*</span><span class="fu">round</span>(<span class="fu">jitter</span>(<span class="fu">seq</span>(<span class="dv">20</span>,<span class="dv">50</span>)),<span class="dv">2</span>) <span class="sc">-</span> <span class="fu">runif</span>(<span class="dv">31</span>,<span class="sc">-</span><span class="dv">50</span>,<span class="dv">50</span>))</span>
<span id="cb163-4"><a href="in-class-assignments.html#cb163-4" tabindex="-1"></a></span>
<span id="cb163-5"><a href="in-class-assignments.html#cb163-5" tabindex="-1"></a>pig.dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pig.dat)</span>
<span id="cb163-6"><a href="in-class-assignments.html#cb163-6" tabindex="-1"></a><span class="fu">names</span>(pig.dat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;diet&quot;</span>,<span class="st">&quot;weight&quot;</span>)</span>
<span id="cb163-7"><a href="in-class-assignments.html#cb163-7" tabindex="-1"></a>pig.dat<span class="sc">$</span>weight <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(pig.dat<span class="sc">$</span>weight))</span>
<span id="cb163-8"><a href="in-class-assignments.html#cb163-8" tabindex="-1"></a></span>
<span id="cb163-9"><a href="in-class-assignments.html#cb163-9" tabindex="-1"></a><span class="co"># Perform your analysis of the data here and convince yourself that it be analyzed </span></span>
<span id="cb163-10"><a href="in-class-assignments.html#cb163-10" tabindex="-1"></a><span class="co"># with parameteric statistics? Necessary for doing in your own work, </span></span>
<span id="cb163-11"><a href="in-class-assignments.html#cb163-11" tabindex="-1"></a><span class="co"># but we can examine the data quickly:</span></span>
<span id="cb163-12"><a href="in-class-assignments.html#cb163-12" tabindex="-1"></a></span>
<span id="cb163-13"><a href="in-class-assignments.html#cb163-13" tabindex="-1"></a><span class="fu">plot</span>(pig.dat<span class="sc">$</span>weight <span class="sc">~</span> pig.dat<span class="sc">$</span>diet, </span>
<span id="cb163-14"><a href="in-class-assignments.html#cb163-14" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Concentration of Additive in Diet&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Weight&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="in-class-assignments.html#cb164-1" tabindex="-1"></a><span class="co"># First, we&#39;ll look at the different components of the model</span></span>
<span id="cb164-2"><a href="in-class-assignments.html#cb164-2" tabindex="-1"></a><span class="fu">plot</span>(pig.dat<span class="sc">$</span>weight <span class="sc">~</span> pig.dat<span class="sc">$</span>diet, <span class="at">xlab =</span> <span class="st">&quot; &quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Weight&quot;</span>, </span>
<span id="cb164-3"><a href="in-class-assignments.html#cb164-3" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb164-4"><a href="in-class-assignments.html#cb164-4" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(pig.dat<span class="sc">$</span>weight))</span>
<span id="cb164-5"><a href="in-class-assignments.html#cb164-5" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> pig.dat<span class="sc">$</span>diet, <span class="at">y0 =</span> <span class="fu">mean</span>(pig.dat<span class="sc">$</span>weight), </span>
<span id="cb164-6"><a href="in-class-assignments.html#cb164-6" tabindex="-1"></a>         <span class="at">x1 =</span> pig.dat<span class="sc">$</span>diet, <span class="at">y1 =</span> pig.dat<span class="sc">$</span>weight, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb164-7"><a href="in-class-assignments.html#cb164-7" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, </span>
<span id="cb164-8"><a href="in-class-assignments.html#cb164-8" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;SST&quot;</span>, <span class="st">&quot;Diff. between observed data and mean of observed data&quot;</span>), </span>
<span id="cb164-9"><a href="in-class-assignments.html#cb164-9" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">&#39;n&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="in-class-assignments.html#cb165-1" tabindex="-1"></a><span class="fu">plot</span>(pig.dat<span class="sc">$</span>weight <span class="sc">~</span> pig.dat<span class="sc">$</span>diet, <span class="at">xlab =</span> <span class="st">&quot; &quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Weight&quot;</span>, </span>
<span id="cb165-2"><a href="in-class-assignments.html#cb165-2" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb165-3"><a href="in-class-assignments.html#cb165-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(pig.dat<span class="sc">$</span>weight <span class="sc">~</span> pig.dat<span class="sc">$</span>diet))</span>
<span id="cb165-4"><a href="in-class-assignments.html#cb165-4" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> pig.dat<span class="sc">$</span>diet, <span class="at">y0 =</span> pig.dat<span class="sc">$</span>weight, </span>
<span id="cb165-5"><a href="in-class-assignments.html#cb165-5" tabindex="-1"></a>         <span class="at">x1 =</span> pig.dat<span class="sc">$</span>diet, <span class="at">y1 =</span> <span class="fu">predict</span>(<span class="fu">lm</span>(pig.dat<span class="sc">$</span>weight <span class="sc">~</span> pig.dat<span class="sc">$</span>diet)), </span>
<span id="cb165-6"><a href="in-class-assignments.html#cb165-6" tabindex="-1"></a>         <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb165-7"><a href="in-class-assignments.html#cb165-7" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, </span>
<span id="cb165-8"><a href="in-class-assignments.html#cb165-8" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;SSR&quot;</span>, <span class="st">&quot;Diff. between the observed data and the regression line&quot;</span>), </span>
<span id="cb165-9"><a href="in-class-assignments.html#cb165-9" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">&#39;n&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="in-class-assignments.html#cb166-1" tabindex="-1"></a><span class="fu">plot</span>(pig.dat<span class="sc">$</span>weight <span class="sc">~</span> pig.dat<span class="sc">$</span>diet, <span class="at">xlab =</span> <span class="st">&quot; &quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Weight&quot;</span>, </span>
<span id="cb166-2"><a href="in-class-assignments.html#cb166-2" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb166-3"><a href="in-class-assignments.html#cb166-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(pig.dat<span class="sc">$</span>weight <span class="sc">~</span> pig.dat<span class="sc">$</span>diet))</span>
<span id="cb166-4"><a href="in-class-assignments.html#cb166-4" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(pig.dat<span class="sc">$</span>weight))</span>
<span id="cb166-5"><a href="in-class-assignments.html#cb166-5" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> pig.dat<span class="sc">$</span>diet, </span>
<span id="cb166-6"><a href="in-class-assignments.html#cb166-6" tabindex="-1"></a>         <span class="at">y0 =</span> <span class="fu">mean</span>(pig.dat<span class="sc">$</span>weight), </span>
<span id="cb166-7"><a href="in-class-assignments.html#cb166-7" tabindex="-1"></a>         <span class="at">x1 =</span> pig.dat<span class="sc">$</span>diet, </span>
<span id="cb166-8"><a href="in-class-assignments.html#cb166-8" tabindex="-1"></a>         <span class="at">y1 =</span> <span class="fu">predict</span>(<span class="fu">lm</span>(pig.dat<span class="sc">$</span>weight <span class="sc">~</span> pig.dat<span class="sc">$</span>diet)), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb166-9"><a href="in-class-assignments.html#cb166-9" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, </span>
<span id="cb166-10"><a href="in-class-assignments.html#cb166-10" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;SSM&quot;</span>, <span class="st">&quot;Diff. between the mean value of Y and the regression line&quot;</span>), </span>
<span id="cb166-11"><a href="in-class-assignments.html#cb166-11" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">&#39;n&#39;</span>)</span></code></pre></div>
<p>We are using the relationship of the variance explained by each component to determine our model fit.</p>
<p><span class="math inline">\(R^2 = \frac{{SSM}}{SST}\)</span> to evaluate the quality of our regression - obviously this example is for simple linear regression but we can use the same principles as we move forward.</p>
<p>We then used the derived properties <span class="math inline">\(MS_M\)</span> and <span class="math inline">\(MS_R\)</span> to determine the <span class="math inline">\(F_{statistic}\)</span></p>
<p>So, what does it mean that the SSM &gt;&gt; SST?</p>
<p>What does it mean that the SSM is small relative to the SST?</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="in-class-assignments.html#cb167-1" tabindex="-1"></a><span class="co"># We can expand our data, lets make some data that is based on a feeding study</span></span>
<span id="cb167-2"><a href="in-class-assignments.html#cb167-2" tabindex="-1"></a><span class="co"># of Hogfish &quot;pigs&quot;, with two different concentrations of fatty acids, </span></span>
<span id="cb167-3"><a href="in-class-assignments.html#cb167-3" tabindex="-1"></a><span class="co"># called &quot;1&quot; and &quot;2&quot;.</span></span>
<span id="cb167-4"><a href="in-class-assignments.html#cb167-4" tabindex="-1"></a></span>
<span id="cb167-5"><a href="in-class-assignments.html#cb167-5" tabindex="-1"></a>pig.dat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">round</span>(<span class="fu">jitter</span>(<span class="fu">seq</span>(<span class="dv">20</span>,<span class="dv">50</span>)),<span class="dv">2</span>),</span>
<span id="cb167-6"><a href="in-class-assignments.html#cb167-6" tabindex="-1"></a>                 <span class="sc">-</span><span class="fl">0.3</span><span class="sc">*</span><span class="fu">round</span>(<span class="fu">jitter</span>(<span class="fu">seq</span>(<span class="dv">20</span>,<span class="dv">50</span>)),<span class="dv">2</span>) <span class="sc">-</span> <span class="fu">runif</span>(<span class="dv">31</span>,<span class="sc">-</span><span class="dv">50</span>,<span class="dv">50</span>)<span class="sc">+</span><span class="dv">100</span>,</span>
<span id="cb167-7"><a href="in-class-assignments.html#cb167-7" tabindex="-1"></a>                 <span class="dv">3</span><span class="sc">*</span><span class="fu">round</span>(<span class="fu">jitter</span>(<span class="fu">seq</span>(<span class="dv">20</span>,<span class="dv">50</span>)),<span class="dv">2</span>) <span class="sc">-</span> <span class="fu">runif</span>(<span class="dv">31</span>,<span class="sc">-</span><span class="dv">50</span>,<span class="dv">50</span>))</span>
<span id="cb167-8"><a href="in-class-assignments.html#cb167-8" tabindex="-1"></a></span>
<span id="cb167-9"><a href="in-class-assignments.html#cb167-9" tabindex="-1"></a>pig.dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pig.dat)</span>
<span id="cb167-10"><a href="in-class-assignments.html#cb167-10" tabindex="-1"></a><span class="fu">names</span>(pig.dat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FFA.1&quot;</span>, <span class="st">&quot;FFA.2&quot;</span>,<span class="st">&quot;weight&quot;</span>)</span>
<span id="cb167-11"><a href="in-class-assignments.html#cb167-11" tabindex="-1"></a>pig.dat<span class="sc">$</span>weight <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(pig.dat<span class="sc">$</span>weight))</span></code></pre></div>
<p>We would like to know if <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span> are predictors of weight:</p>
<p><span class="math inline">\(weight_i = \beta_1{FFA.1_i} + \beta_1{FFA.2_i}\)</span>.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="in-class-assignments.html#cb168-1" tabindex="-1"></a><span class="co"># Lets do some preliminary examination of the data</span></span>
<span id="cb168-2"><a href="in-class-assignments.html#cb168-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb168-3"><a href="in-class-assignments.html#cb168-3" tabindex="-1"></a><span class="fu">hist</span>(pig.dat<span class="sc">$</span>FFA<span class="fl">.1</span>)</span>
<span id="cb168-4"><a href="in-class-assignments.html#cb168-4" tabindex="-1"></a><span class="fu">hist</span>(pig.dat<span class="sc">$</span>FFA<span class="fl">.2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="in-class-assignments.html#cb169-1" tabindex="-1"></a><span class="co"># We will want to evaluate the correlation of the independent variables...</span></span>
<span id="cb169-2"><a href="in-class-assignments.html#cb169-2" tabindex="-1"></a><span class="fu">cor</span>(pig.dat<span class="sc">$</span>FFA<span class="fl">.1</span>, pig.dat<span class="sc">$</span>FFA<span class="fl">.2</span>)</span>
<span id="cb169-3"><a href="in-class-assignments.html#cb169-3" tabindex="-1"></a></span>
<span id="cb169-4"><a href="in-class-assignments.html#cb169-4" tabindex="-1"></a><span class="co"># what can you conclude from this?</span></span></code></pre></div>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="in-class-assignments.html#cb170-1" tabindex="-1"></a><span class="co"># Lets perform the multiple linear regression</span></span>
<span id="cb170-2"><a href="in-class-assignments.html#cb170-2" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> FFA<span class="fl">.1</span> <span class="sc">+</span> FFA<span class="fl">.2</span>, <span class="at">data =</span> pig.dat)</span>
<span id="cb170-3"><a href="in-class-assignments.html#cb170-3" tabindex="-1"></a>fit</span>
<span id="cb170-4"><a href="in-class-assignments.html#cb170-4" tabindex="-1"></a></span>
<span id="cb170-5"><a href="in-class-assignments.html#cb170-5" tabindex="-1"></a><span class="co"># Other useful functions </span></span>
<span id="cb170-6"><a href="in-class-assignments.html#cb170-6" tabindex="-1"></a><span class="fu">coefficients</span>(fit) <span class="co"># model coefficients</span></span>
<span id="cb170-7"><a href="in-class-assignments.html#cb170-7" tabindex="-1"></a><span class="fu">confint</span>(fit, <span class="at">level=</span><span class="fl">0.95</span>) <span class="co"># CIs for model parameters </span></span>
<span id="cb170-8"><a href="in-class-assignments.html#cb170-8" tabindex="-1"></a></span>
<span id="cb170-9"><a href="in-class-assignments.html#cb170-9" tabindex="-1"></a><span class="co"># Using the analysis above - what can we say about the 95% CI and mean of the beta values?</span></span>
<span id="cb170-10"><a href="in-class-assignments.html#cb170-10" tabindex="-1"></a><span class="co"># What is being returned here? Can you write out the linear model (rounding is fine).</span></span></code></pre></div>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="in-class-assignments.html#cb171-1" tabindex="-1"></a><span class="co"># Lets look at the ANOVA table</span></span>
<span id="cb171-2"><a href="in-class-assignments.html#cb171-2" tabindex="-1"></a><span class="fu">summary</span>(reg.obj)</span>
<span id="cb171-3"><a href="in-class-assignments.html#cb171-3" tabindex="-1"></a></span>
<span id="cb171-4"><a href="in-class-assignments.html#cb171-4" tabindex="-1"></a><span class="co"># What is our interpretation of the modeled coefficients?</span></span></code></pre></div>
</div>
<div id="stepwise-selection-approach" class="section level3 hasAnchor" number="22.14.5">
<h3><span class="header-section-number">22.14.5</span> Stepwise Selection Approach<a href="in-class-assignments.html#stepwise-selection-approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lets look at using stepwise regression on the mtcars data. We will predict mpg from the other variables. We don’t know what the best fit model is, so we can use “stepwise regression techniques”</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="in-class-assignments.html#cb172-1" tabindex="-1"></a><span class="co"># Let&#39;s first look at the first six columns</span></span>
<span id="cb172-2"><a href="in-class-assignments.html#cb172-2" tabindex="-1"></a>car.dat <span class="ot">&lt;-</span> mtcars[,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb172-3"><a href="in-class-assignments.html#cb172-3" tabindex="-1"></a><span class="fu">head</span>(car.dat)</span>
<span id="cb172-4"><a href="in-class-assignments.html#cb172-4" tabindex="-1"></a></span>
<span id="cb172-5"><a href="in-class-assignments.html#cb172-5" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">step</span>(<span class="fu">lm</span>(car.dat<span class="sc">$</span>mpg <span class="sc">~</span> car.dat<span class="sc">$</span>cyl <span class="sc">+</span> </span>
<span id="cb172-6"><a href="in-class-assignments.html#cb172-6" tabindex="-1"></a>                  car.dat<span class="sc">$</span>disp <span class="sc">+</span> car.dat<span class="sc">$</span>hp <span class="sc">+</span> car.dat<span class="sc">$</span>drat <span class="sc">+</span> car.dat<span class="sc">$</span>wt))</span>
<span id="cb172-7"><a href="in-class-assignments.html#cb172-7" tabindex="-1"></a><span class="co"># What is being returned?</span></span>
<span id="cb172-8"><a href="in-class-assignments.html#cb172-8" tabindex="-1"></a><span class="co"># Write and interpret the model, 7.8.3.2</span></span>
<span id="cb172-9"><a href="in-class-assignments.html#cb172-9" tabindex="-1"></a></span>
<span id="cb172-10"><a href="in-class-assignments.html#cb172-10" tabindex="-1"></a><span class="co"># Compare the results of the nested model to that of the full model</span></span>
<span id="cb172-11"><a href="in-class-assignments.html#cb172-11" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(car.dat<span class="sc">$</span>mpg <span class="sc">~</span> car.dat<span class="sc">$</span>cyl <span class="sc">+</span> car.dat<span class="sc">$</span>disp <span class="sc">+</span> car.dat<span class="sc">$</span>hp <span class="sc">+</span> </span>
<span id="cb172-12"><a href="in-class-assignments.html#cb172-12" tabindex="-1"></a>             car.dat<span class="sc">$</span>drat <span class="sc">+</span> car.dat<span class="sc">$</span>wt)</span>
<span id="cb172-13"><a href="in-class-assignments.html#cb172-13" tabindex="-1"></a></span>
<span id="cb172-14"><a href="in-class-assignments.html#cb172-14" tabindex="-1"></a><span class="co"># compare models, what is going on here? Fields 7.4.8.2</span></span>
<span id="cb172-15"><a href="in-class-assignments.html#cb172-15" tabindex="-1"></a><span class="fu">anova</span>(fit1, fit2)</span></code></pre></div>
</div>
<div id="scaling-your-independent-variables" class="section level3 hasAnchor" number="22.14.6">
<h3><span class="header-section-number">22.14.6</span> Scaling your independent variables<a href="in-class-assignments.html#scaling-your-independent-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Gelman (a famous contemporary statistician) suggests scaling the independent variables when using linear models</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="in-class-assignments.html#cb173-1" tabindex="-1"></a><span class="co"># Let&#39;s first look at the first six columns</span></span>
<span id="cb173-2"><a href="in-class-assignments.html#cb173-2" tabindex="-1"></a>car.dat <span class="ot">&lt;-</span> mtcars[,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb173-3"><a href="in-class-assignments.html#cb173-3" tabindex="-1"></a>car.dat.scale <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(car.dat))</span>
<span id="cb173-4"><a href="in-class-assignments.html#cb173-4" tabindex="-1"></a><span class="fu">names</span>(car.dat.scale) <span class="ot">&lt;-</span> <span class="fu">names</span>(car.dat)</span>
<span id="cb173-5"><a href="in-class-assignments.html#cb173-5" tabindex="-1"></a></span>
<span id="cb173-6"><a href="in-class-assignments.html#cb173-6" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb173-7"><a href="in-class-assignments.html#cb173-7" tabindex="-1"></a><span class="fu">hist</span>(car.dat<span class="sc">$</span>disp)</span>
<span id="cb173-8"><a href="in-class-assignments.html#cb173-8" tabindex="-1"></a><span class="fu">hist</span>(car.dat.scale<span class="sc">$</span>disp)</span>
<span id="cb173-9"><a href="in-class-assignments.html#cb173-9" tabindex="-1"></a></span>
<span id="cb173-10"><a href="in-class-assignments.html#cb173-10" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(car.dat<span class="sc">$</span>mpg <span class="sc">~</span> car.dat<span class="sc">$</span>disp <span class="sc">+</span> car.dat<span class="sc">$</span>hp)</span>
<span id="cb173-11"><a href="in-class-assignments.html#cb173-11" tabindex="-1"></a><span class="fu">coefficients</span>(fit1)</span>
<span id="cb173-12"><a href="in-class-assignments.html#cb173-12" tabindex="-1"></a></span>
<span id="cb173-13"><a href="in-class-assignments.html#cb173-13" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(car.dat.scale<span class="sc">$</span>mpg <span class="sc">~</span> car.dat.scale<span class="sc">$</span>disp <span class="sc">+</span> car.dat.scale<span class="sc">$</span>hp)</span>
<span id="cb173-14"><a href="in-class-assignments.html#cb173-14" tabindex="-1"></a><span class="fu">coefficients</span>(fit2)</span>
<span id="cb173-15"><a href="in-class-assignments.html#cb173-15" tabindex="-1"></a></span>
<span id="cb173-16"><a href="in-class-assignments.html#cb173-16" tabindex="-1"></a><span class="co"># This allows coefficients on different scales to be evaluated - </span></span>
<span id="cb173-17"><a href="in-class-assignments.html#cb173-17" tabindex="-1"></a><span class="co"># they are centered and scales to zero. </span></span>
<span id="cb173-18"><a href="in-class-assignments.html#cb173-18" tabindex="-1"></a><span class="co"># So, now they are not in their original units but instead are converted to </span></span>
<span id="cb173-19"><a href="in-class-assignments.html#cb173-19" tabindex="-1"></a><span class="co"># standard deviation units. The beta coefficients can be evaluated in this way:</span></span>
<span id="cb173-20"><a href="in-class-assignments.html#cb173-20" tabindex="-1"></a></span>
<span id="cb173-21"><a href="in-class-assignments.html#cb173-21" tabindex="-1"></a><span class="fu">coefficients</span>(fit2)[<span class="dv">2</span>]<span class="sc">/</span><span class="fu">coefficients</span>(fit2)[<span class="dv">3</span>]</span>
<span id="cb173-22"><a href="in-class-assignments.html#cb173-22" tabindex="-1"></a></span>
<span id="cb173-23"><a href="in-class-assignments.html#cb173-23" tabindex="-1"></a><span class="co"># A one unit change in displacement has a greater impact than a one unit change in hp?</span></span>
<span id="cb173-24"><a href="in-class-assignments.html#cb173-24" tabindex="-1"></a><span class="co"># how much different? 2.2 X...</span></span></code></pre></div>
</div>
</div>
<div id="t-test" class="section level2 hasAnchor" number="22.15">
<h2><span class="header-section-number">22.15</span> <span class="math inline">\(t\)</span>-test<a href="in-class-assignments.html#t-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>1.) Understand the assumptions of the parameteric statistical approach called the <span class="math inline">\(t\)</span>-test</p>
<p>2.) Examine a few different types of <span class="math inline">\(t\)</span>-tests</p>
<p>3.) Evaluate data using <span class="math inline">\(t\)</span>-test, GLM tools, and non-parametric approaches</p>
<p>5.) Understand the derivation of confidence intervals</p>
<div id="the-assumptions-of-the-parameteric-t-test-approach" class="section level3 hasAnchor" number="22.15.1">
<h3><span class="header-section-number">22.15.1</span> The assumptions of the parameteric <span class="math inline">\(t\)</span>-test approach<a href="in-class-assignments.html#the-assumptions-of-the-parameteric-t-test-approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>1.) The variables are continuous and independent.</p>
<p>2.) The variables are normally distributed.</p>
<p>3.) The variances in each group are homogeneous.</p>
</div>
<div id="we-are-interested-in-understanding-and-describing-parameters-of-two-popuations." class="section level3 hasAnchor" number="22.15.2">
<h3><span class="header-section-number">22.15.2</span> We are interested in understanding and describing parameters of two popuations.<a href="in-class-assignments.html#we-are-interested-in-understanding-and-describing-parameters-of-two-popuations." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fields and Zar both have comprehensive explanations of why and how we perform a <em>t</em>-test (Fields p. 373 to 375 is especially good). I will not review it here exhaustively, but will say that the goal of the mathematics of the calculation is to determine the amount of variance explained by the model.</p>
<p>The proportion of variance explained by the model is the ratio of the difference in sample means and the estimate of the standard error of the difference in the sample means.</p>
<p>This is the amount of structured error, relative to the amount of unstructured error.</p>
<p><span class="math inline">\(t=\frac{\bar{Y}_1-\bar{Y}_2}{\sqrt{\frac{S^2_p}{n_1}+\frac{S^2_p}{n_2}}}\)</span></p>
<ul>
<li><p>The numerator is the difference between sample means.</p></li>
<li><p>The denominator is the standard error of the difference between the sample means. This quantity is a measure of the variability of the data within the two samples.</p></li>
</ul>
<p><span class="math inline">\(S^2_p=\frac{(n_1-1)S^2_1+(n_2-1)S^2_2}{n_1+n_2-2}\)</span></p>
<p><span class="math inline">\(S^2_p=\frac{SS_1+SS_2}{v_1+v_2}\)</span></p>
<p>Here v<sub>1</sub> and v<sub>2</sub> are the degrees of freedom, v<sub>1</sub> = n<sub>1</sub> - 1 and v<sub>2</sub> = n<sub>2</sub> -1</p>
<p>The test value is compared to the critical value at a given <span class="math inline">\(\alpha\)</span></p>
<p><span class="math inline">\(t_{\alpha,2,df}\)</span></p>
<ul>
<li>Need to set <span class="math inline">\(\alpha\)</span> value.</li>
<li>One or two-tailed test?</li>
<li>v<sub>1</sub> = n<sub>1</sub> - 1 and v<sub>2</sub> = n<sub>2</sub> - 1</li>
</ul>
<p>This is a verbose way of describing the calculations, but the take home is that we would like to know if a “two mean model” where <span class="math inline">\(\mu_1 \ne \mu_2\)</span> is better at describing the characteristics of the sample data than is the null model, <span class="math inline">\(\mu_1 = \mu_2\)</span>.</p>
<p>Again, remember, we are testing whether <span class="math inline">\(\mu_1 = \mu_2\)</span> by evaluating whether the difference between them is zero:</p>
<p><span class="math inline">\(\mu_1 - \mu_2 = 0\)</span>.</p>
<p>If the above is true, then a model with only a single mean (the null model) will fit the data better than a model with two means.</p>
<p>Alternatively, if <span class="math inline">\(\mu_1 - \mu_2 \ne 0\)</span>, then a model with two means will fit better than the null model.</p>
</div>
<div id="there-are-a-number-of-variants-of-the-t-test." class="section level3 hasAnchor" number="22.15.3">
<h3><span class="header-section-number">22.15.3</span> There are a number of variants of the <em>t</em>-test.<a href="in-class-assignments.html#there-are-a-number-of-variants-of-the-t-test." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To compare two means we can use variants of the <span class="math inline">\(t\)</span>-test. We are interested in understanding whether the population parameter <span class="math inline">\(\mu\)</span> is equal to a given value (one-sample <span class="math inline">\(t\)</span>-test), equal between two populations (independent two-sample <span class="math inline">\(t\)</span>-test), or equal between “repeated measures” of the same population (dependent two-sample <span class="math inline">\(t\)</span>-test). All of these can be evaluated using one- and two-tailed null hypothesis testing.</p>
</div>
<div id="perform-the-t-test" class="section level3 hasAnchor" number="22.15.4">
<h3><span class="header-section-number">22.15.4</span> Perform the <em>t</em>-test<a href="in-class-assignments.html#perform-the-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Prior to performing any of the statistical tests you will need to perform an exhaustive evaluation of the data - this is the first step in all analytical endeavors prior to performing statistical tests. I would recommend going beyond the “summary” function - which really is not that useful.</p>
<p>Instead, you will want to plot these data using histograms, qq plots, and calculate standard deviation, mean, variance, ect.</p>
<p>Perform statistical tests to evaluate whether parameteric statistics can be used to test the hypothesis <span class="math inline">\(\mu_1 = \mu_2\)</span>.</p>
<p>To start, lets evaluate a the one-sample <em>t</em>-test.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="in-class-assignments.html#cb174-1" tabindex="-1"></a><span class="co"># First, we&#39;ll create some data</span></span>
<span id="cb174-2"><a href="in-class-assignments.html#cb174-2" tabindex="-1"></a>n. <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb174-3"><a href="in-class-assignments.html#cb174-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb174-4"><a href="in-class-assignments.html#cb174-4" tabindex="-1"></a>pop<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="at">n =</span> n., <span class="at">shape1 =</span> <span class="dv">2</span>, <span class="at">shape2 =</span> <span class="dv">3</span>, <span class="at">ncp =</span> <span class="dv">0</span>)</span>
<span id="cb174-5"><a href="in-class-assignments.html#cb174-5" tabindex="-1"></a>pop<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="at">n =</span> n., <span class="at">shape1 =</span> <span class="fl">3.5</span>, <span class="at">shape2 =</span> <span class="dv">3</span>, <span class="at">ncp =</span> <span class="dv">0</span>)</span>
<span id="cb174-6"><a href="in-class-assignments.html#cb174-6" tabindex="-1"></a></span>
<span id="cb174-7"><a href="in-class-assignments.html#cb174-7" tabindex="-1"></a><span class="co"># Perform your analysis of the data here, can it be analyzed with parametric statistics?</span></span></code></pre></div>
<p>Question 1: What is the null hypothesis for the two-sample, two-tail test?</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="in-class-assignments.html#cb175-1" tabindex="-1"></a><span class="co"># What alterations would you need to do so you can do a two sample test? </span></span>
<span id="cb175-2"><a href="in-class-assignments.html#cb175-2" tabindex="-1"></a><span class="co"># I have provided some code below.</span></span>
<span id="cb175-3"><a href="in-class-assignments.html#cb175-3" tabindex="-1"></a></span>
<span id="cb175-4"><a href="in-class-assignments.html#cb175-4" tabindex="-1"></a>n1  <span class="ot">&lt;-</span> <span class="fu">length</span>(pop<span class="fl">.1</span>)    <span class="co"># sample size of population</span></span>
<span id="cb175-5"><a href="in-class-assignments.html#cb175-5" tabindex="-1"></a>yb1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(pop<span class="fl">.1</span>)    <span class="co"># mean of population</span></span>
<span id="cb175-6"><a href="in-class-assignments.html#cb175-6" tabindex="-1"></a>s1  <span class="ot">&lt;-</span> <span class="fu">var</span>(pop<span class="fl">.1</span>)    <span class="co"># variance of population </span></span>
<span id="cb175-7"><a href="in-class-assignments.html#cb175-7" tabindex="-1"></a></span>
<span id="cb175-8"><a href="in-class-assignments.html#cb175-8" tabindex="-1"></a>n2  <span class="ot">&lt;-</span> <span class="fu">length</span>(pop<span class="fl">.2</span>)    <span class="co"># sample size of population</span></span>
<span id="cb175-9"><a href="in-class-assignments.html#cb175-9" tabindex="-1"></a>yb2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(pop<span class="fl">.2</span>)    <span class="co"># mean of population</span></span>
<span id="cb175-10"><a href="in-class-assignments.html#cb175-10" tabindex="-1"></a>s2  <span class="ot">&lt;-</span> <span class="fu">var</span>(pop<span class="fl">.2</span>)    <span class="co"># variance of population </span></span>
<span id="cb175-11"><a href="in-class-assignments.html#cb175-11" tabindex="-1"></a></span>
<span id="cb175-12"><a href="in-class-assignments.html#cb175-12" tabindex="-1"></a><span class="co"># t-statistic = (difference in mean)/(SE of difference)</span></span>
<span id="cb175-13"><a href="in-class-assignments.html#cb175-13" tabindex="-1"></a>tstat.num <span class="ot">&lt;-</span> yb1 <span class="sc">-</span> yb2 <span class="co"># observed - expected</span></span>
<span id="cb175-14"><a href="in-class-assignments.html#cb175-14" tabindex="-1"></a>pooled.v <span class="ot">&lt;-</span> ((n1<span class="dv">-1</span>)<span class="sc">*</span>s1 <span class="sc">+</span> (n2<span class="dv">-1</span>)<span class="sc">*</span>s2)<span class="sc">/</span>(n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb175-15"><a href="in-class-assignments.html#cb175-15" tabindex="-1"></a>tstat.den <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((pooled.v<span class="sc">/</span>n1) <span class="sc">+</span> (pooled.v<span class="sc">/</span>n2))</span>
<span id="cb175-16"><a href="in-class-assignments.html#cb175-16" tabindex="-1"></a></span>
<span id="cb175-17"><a href="in-class-assignments.html#cb175-17" tabindex="-1"></a><span class="co"># SE of the difference of the mean values</span></span>
<span id="cb175-18"><a href="in-class-assignments.html#cb175-18" tabindex="-1"></a>tstat <span class="ot">&lt;-</span> tstat.num<span class="sc">/</span>tstat.den</span>
<span id="cb175-19"><a href="in-class-assignments.html#cb175-19" tabindex="-1"></a></span>
<span id="cb175-20"><a href="in-class-assignments.html#cb175-20" tabindex="-1"></a><span class="co"># Determine the critical value of t for the observed df - can you figure out this code?</span></span>
<span id="cb175-21"><a href="in-class-assignments.html#cb175-21" tabindex="-1"></a>df.val <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb175-22"><a href="in-class-assignments.html#cb175-22" tabindex="-1"></a>critical.t <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, df.val)</span></code></pre></div>
<p>Question 2: What do we conclude from this test?</p>
<p>Question 3: Explain how the numerator and denominator describe the value of the object <em>tstat</em>.</p>
<p>Question 4: What is interesting, surprising, informative? Specifically, what is the relationship of altering the variance of samples, the differences in the means, and the alpha level?</p>
</div>
<div id="built-in-t-test-in-r" class="section level3 hasAnchor" number="22.15.5">
<h3><span class="header-section-number">22.15.5</span> Built-in <em>t</em>-test in R<a href="in-class-assignments.html#built-in-t-test-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the functions that you wrote and compare the results to those of the built in <em>t</em>-test function in R</p>
<p>Question 5: Walk through the output and describe it.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="in-class-assignments.html#cb176-1" tabindex="-1"></a><span class="co"># Fields page 380 has an excellent guide to the function arguments</span></span>
<span id="cb176-2"><a href="in-class-assignments.html#cb176-2" tabindex="-1"></a>?t.test</span>
<span id="cb176-3"><a href="in-class-assignments.html#cb176-3" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> pop<span class="fl">.1</span>, <span class="at">y =</span> pop<span class="fl">.2</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>) <span class="co"># Student&#39;s t-test</span></span></code></pre></div>
</div>
<div id="lets-examine-the-t-test-as-a-glm---my-favorite" class="section level3 hasAnchor" number="22.15.6">
<h3><span class="header-section-number">22.15.6</span> Lets examine the <em>t</em>-test as a GLM - my favorite!<a href="in-class-assignments.html#lets-examine-the-t-test-as-a-glm---my-favorite" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="in-class-assignments.html#cb177-1" tabindex="-1"></a><span class="co"># The function lm (which we know) takes as input, class data.frame</span></span>
<span id="cb177-2"><a href="in-class-assignments.html#cb177-2" tabindex="-1"></a></span>
<span id="cb177-3"><a href="in-class-assignments.html#cb177-3" tabindex="-1"></a>pop.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">observations =</span> <span class="fu">c</span>(pop<span class="fl">.1</span>, pop<span class="fl">.2</span>),</span>
<span id="cb177-4"><a href="in-class-assignments.html#cb177-4" tabindex="-1"></a>                       <span class="at">population =</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">20</span>),<span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">20</span>))))</span>
<span id="cb177-5"><a href="in-class-assignments.html#cb177-5" tabindex="-1"></a></span>
<span id="cb177-6"><a href="in-class-assignments.html#cb177-6" tabindex="-1"></a><span class="fu">names</span>(pop.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;observations&quot;</span>,<span class="st">&quot;population&quot;</span>)</span>
<span id="cb177-7"><a href="in-class-assignments.html#cb177-7" tabindex="-1"></a>pop.data<span class="sc">$</span>population <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">as.character</span>(pop.data<span class="sc">$</span>population))</span>
<span id="cb177-8"><a href="in-class-assignments.html#cb177-8" tabindex="-1"></a></span>
<span id="cb177-9"><a href="in-class-assignments.html#cb177-9" tabindex="-1"></a><span class="co"># Use the lm model</span></span>
<span id="cb177-10"><a href="in-class-assignments.html#cb177-10" tabindex="-1"></a>mod.obj <span class="ot">&lt;-</span> <span class="fu">lm</span>(pop.data<span class="sc">$</span>observations <span class="sc">~</span> pop.data<span class="sc">$</span>population)</span>
<span id="cb177-11"><a href="in-class-assignments.html#cb177-11" tabindex="-1"></a><span class="fu">summary</span>(mod.obj)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = pop.data$observations ~ pop.data$population)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.34130 -0.12144 -0.03708  0.16577  0.33966 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           0.47169    0.04086  11.543 5.47e-14 ***
## pop.data$population2  0.01128    0.05779   0.195    0.846    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1828 on 38 degrees of freedom
## Multiple R-squared:  0.001002,   Adjusted R-squared:  -0.02529 
## F-statistic: 0.03812 on 1 and 38 DF,  p-value: 0.8462</code></pre>
<p>Question 6: Please review and describe all aspects of the output.</p>
</div>
<div id="effect-size" class="section level3 hasAnchor" number="22.15.7">
<h3><span class="header-section-number">22.15.7</span> Effect size<a href="in-class-assignments.html#effect-size" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Effect size is a statistical concept that measures the strength of the relationship between two variables on a numeric scale.</p>
<p>For instance, if we have data on the height of men and women and we notice that, on average, men are taller than women, the difference between the height of men and the height of women is known as the effect size. The greater the effect size, the greater the height difference between men and women will be.</p>
<p>Statistic effect size helps us in determining if the difference is real. In hypothesis testing, effect size, power, sample size, and significance level are related to each other.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="in-class-assignments.html#cb179-1" tabindex="-1"></a><span class="co"># The calculated t value can be translated into an index, r, that describes </span></span>
<span id="cb179-2"><a href="in-class-assignments.html#cb179-2" tabindex="-1"></a><span class="co"># the effect size. Simulate data with varying degrees of difference in the </span></span>
<span id="cb179-3"><a href="in-class-assignments.html#cb179-3" tabindex="-1"></a><span class="co"># mean, and evaluate the resulting effect size.</span></span>
<span id="cb179-4"><a href="in-class-assignments.html#cb179-4" tabindex="-1"></a></span>
<span id="cb179-5"><a href="in-class-assignments.html#cb179-5" tabindex="-1"></a><span class="co"># Use the lm model</span></span>
<span id="cb179-6"><a href="in-class-assignments.html#cb179-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb179-7"><a href="in-class-assignments.html#cb179-7" tabindex="-1"></a>t.dat <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb179-8"><a href="in-class-assignments.html#cb179-8" tabindex="-1"></a>t.dat<span class="sc">$</span>p1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb179-9"><a href="in-class-assignments.html#cb179-9" tabindex="-1"></a>t.dat<span class="sc">$</span>p2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb179-10"><a href="in-class-assignments.html#cb179-10" tabindex="-1"></a></span>
<span id="cb179-11"><a href="in-class-assignments.html#cb179-11" tabindex="-1"></a>t.calc <span class="ot">&lt;-</span> <span class="fu">t.test</span>(t.dat<span class="sc">$</span>p1, t.dat<span class="sc">$</span>p2)[[<span class="dv">1</span>]]</span>
<span id="cb179-12"><a href="in-class-assignments.html#cb179-12" tabindex="-1"></a>df.est <span class="ot">&lt;-</span> <span class="fu">t.test</span>(t.dat<span class="sc">$</span>p1, t.dat<span class="sc">$</span>p2)[[<span class="dv">2</span>]]</span>
<span id="cb179-13"><a href="in-class-assignments.html#cb179-13" tabindex="-1"></a></span>
<span id="cb179-14"><a href="in-class-assignments.html#cb179-14" tabindex="-1"></a>r.val <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(t.calc<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(t.calc<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> df.est))</span></code></pre></div>
<p>Question 7: What is the relationship of the effect size estimate to <span class="math inline">\(\overline{X_1} - \overline{X_2}\)</span></p>
<p>Question 8: What range of values can the effect size have?</p>
<p><span class="math inline">\(r=\sqrt{\frac{t^2}{t^2+df}}\)</span></p>
<p>Question 9: Let’s look at the relationship of varying the population mean and effect size. Describe the pattern you see:</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="in-class-assignments.html#cb180-1" tabindex="-1"></a><span class="co"># The calculated t value can be translated into an index, r, that describes </span></span>
<span id="cb180-2"><a href="in-class-assignments.html#cb180-2" tabindex="-1"></a><span class="co"># the effect size. Simulate data with varying degrees of difference in the </span></span>
<span id="cb180-3"><a href="in-class-assignments.html#cb180-3" tabindex="-1"></a><span class="co"># mean, and evaluate the resulting effect size.</span></span>
<span id="cb180-4"><a href="in-class-assignments.html#cb180-4" tabindex="-1"></a></span>
<span id="cb180-5"><a href="in-class-assignments.html#cb180-5" tabindex="-1"></a><span class="co"># Use the lm model</span></span>
<span id="cb180-6"><a href="in-class-assignments.html#cb180-6" tabindex="-1"></a>r.val <span class="ot">&lt;-</span> t.calc <span class="ot">&lt;-</span> df.est <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb180-7"><a href="in-class-assignments.html#cb180-7" tabindex="-1"></a>int.val <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.5</span>)</span>
<span id="cb180-8"><a href="in-class-assignments.html#cb180-8" tabindex="-1"></a></span>
<span id="cb180-9"><a href="in-class-assignments.html#cb180-9" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(int.val)) {</span>
<span id="cb180-10"><a href="in-class-assignments.html#cb180-10" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb180-11"><a href="in-class-assignments.html#cb180-11" tabindex="-1"></a>t.dat<span class="sc">$</span>p1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="at">mean =</span> int.val[j], <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb180-12"><a href="in-class-assignments.html#cb180-12" tabindex="-1"></a>t.dat<span class="sc">$</span>p2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb180-13"><a href="in-class-assignments.html#cb180-13" tabindex="-1"></a></span>
<span id="cb180-14"><a href="in-class-assignments.html#cb180-14" tabindex="-1"></a>t.calc[j] <span class="ot">&lt;-</span> <span class="fu">t.test</span>(t.dat<span class="sc">$</span>p1, t.dat<span class="sc">$</span>p2, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)[[<span class="dv">1</span>]]</span>
<span id="cb180-15"><a href="in-class-assignments.html#cb180-15" tabindex="-1"></a>df.est[j] <span class="ot">&lt;-</span> <span class="fu">t.test</span>(t.dat<span class="sc">$</span>p1, t.dat<span class="sc">$</span>p2, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)[[<span class="dv">2</span>]]</span>
<span id="cb180-16"><a href="in-class-assignments.html#cb180-16" tabindex="-1"></a>r.val[j] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(t.calc[j]<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(t.calc[j]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> df.est[j]))</span>
<span id="cb180-17"><a href="in-class-assignments.html#cb180-17" tabindex="-1"></a>}</span>
<span id="cb180-18"><a href="in-class-assignments.html#cb180-18" tabindex="-1"></a></span>
<span id="cb180-19"><a href="in-class-assignments.html#cb180-19" tabindex="-1"></a><span class="fu">plot</span>(t.calc, r.val, <span class="at">xlab =</span> <span class="st">&quot;Calculated t value&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;r (the magnitude of the effect size)&quot;</span>)</span>
<span id="cb180-20"><a href="in-class-assignments.html#cb180-20" tabindex="-1"></a><span class="fu">lines</span>(t.calc, r.val)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-220-1.png" width="672" /></p>
</div>
</div>
<div id="one-way-anova" class="section level2 hasAnchor" number="22.16">
<h2><span class="header-section-number">22.16</span> One-Way ANOVA<a href="in-class-assignments.html#one-way-anova" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="we-will" class="section level3 hasAnchor" number="22.16.1">
<h3><span class="header-section-number">22.16.1</span> We will:<a href="in-class-assignments.html#we-will" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>1.) Understand the assumptions of this parameteric statistical approach</p>
<p>2.) Understand the structure and calculations of the one-way ANOVA</p>
</div>
<div id="the-assumptions-of-the-parameteric-anova-approach" class="section level3 hasAnchor" number="22.16.2">
<h3><span class="header-section-number">22.16.2</span> The assumptions of the parameteric ANOVA approach<a href="in-class-assignments.html#the-assumptions-of-the-parameteric-anova-approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>1.) The variables are continuous and independent</p>
<p>2.) The variables are normally distributed</p>
<p>3.) The variances in each group are equal</p>
</div>
<div id="intro-we-are-interested-in-detecting-whether-there-is-a-difference-in-the-means-of-two-or-more-populations" class="section level3 hasAnchor" number="22.16.3">
<h3><span class="header-section-number">22.16.3</span> Intro: We are interested in detecting whether there is a difference in the means of two or more populations<a href="in-class-assignments.html#intro-we-are-interested-in-detecting-whether-there-is-a-difference-in-the-means-of-two-or-more-populations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We are often interested in determining whether the means from more than two populations or groups are equal or not, and this is done using an F-test in ANOVA, the null hypothesis is:</p>
<p><span class="math inline">\(\mu_1 = \mu_2= \mu_3= \mu_4...= \mu_n\)</span>.</p>
<p>Examine how the value of the F statistic is calculated:</p>
<p>What does it mean that the group MS &gt;&gt; error MS?</p>
<p>What does it mean that the error MS is small relative to the group MS?</p>
<p>We would like to know if a “multiple mean model” where (example, if <span class="math inline">\(k\)</span> = 3, ie three groups), then one of these models:</p>
<p><span class="math inline">\(\mu_1 = \mu_2 \ne \mu_3\)</span>,</p>
<p><span class="math inline">\(\mu_1 \ne \mu_2= \mu_3\)</span>,</p>
<p><span class="math inline">\(\mu_3\ne \mu_1= \mu_2\)</span>, or</p>
<p><span class="math inline">\(\mu_1 \ne \mu_2\ne \mu_3\)</span></p>
<p>is better at describing the characteristics of the sample data than is the null model:</p>
<p><span class="math inline">\(\mu_1 = \mu_2= \mu_3\)</span>.</p>
<p>As Zar states “…ANOVA examines several sources of variation among all of the data in an experiment, by determining a sum of squares.</p>
<p>So we need to evaluate multiple sources of error - these are reviewed in Zar and Fields.</p>
<p>We will evaluate a design with (<span class="math inline">\(k\)</span>) experimental groups. Each datum in the experiment <span class="math inline">\(X_{ij}\)</span> can be denoted as the <span class="math inline">\(j^{th}\)</span> observation from the experimental group <span class="math inline">\(i\)</span>.</p>
</div>
<div id="source-of-error-1" class="section level3 hasAnchor" number="22.16.4">
<h3><span class="header-section-number">22.16.4</span> Source of error #1<a href="in-class-assignments.html#source-of-error-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Within-group SS = <span class="math inline">\(\sum_{i = 1}^{k}\sum_{j = 1}^{n_i}[(X_{ij} - \overline{X}_i)^2]\)</span>,</p>
<p>where <span class="math inline">\(\overline{X}_i\)</span> is the mean of group <span class="math inline">\(i\)</span> and <span class="math inline">\(n_i\)</span> is the number of data points in the <span class="math inline">\(i^{th}\)</span> group. The within group error is often referred to as the “error sum of squares”.</p>
<p>Describe what we are calculating…</p>
</div>
<div id="source-of-error-2" class="section level3 hasAnchor" number="22.16.5">
<h3><span class="header-section-number">22.16.5</span> Source of error #2<a href="in-class-assignments.html#source-of-error-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Among-group SS = <span class="math inline">\(\sum_{i = 1}^{k}n_i(\overline{X}_i - \overline{X})^2\)</span></p>
<p>where <span class="math inline">\(\overline{X}\)</span> is the “grand mean”, the mean of all data.</p>
<p>Describe what we are calculating…</p>
</div>
<div id="source-of-error-3" class="section level3 hasAnchor" number="22.16.6">
<h3><span class="header-section-number">22.16.6</span> Source of error #3<a href="in-class-assignments.html#source-of-error-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Total SS = <span class="math inline">\(\sum_{i = 1}^{k}\sum_{j = 1}^{n_i}(X_{ij} - \overline{X})^2\)</span>.</p>
<p>The quantity <span class="math inline">\(\overline{X}\)</span> is the “grand mean”, the mean of all data. This quantity is also called the “groups sum of squares”. It is the sum of the within-group SS and among-group SS.</p>
<p>So, in order to do the ANOVA, the order of operations will be to:</p>
<ol style="list-style-type: decimal">
<li><p>Compute the Within-group SS (<span class="math inline">\(\sigma_{within}^2\)</span>).</p></li>
<li><p>Compute the among-group SS: (<span class="math inline">\(\sigma_{among}^2\)</span>)</p></li>
<li><p>Produce F-statistic as the ratio of <span class="math inline">\(F = \frac{\sigma_{among}^2}{\sigma_{within}^2}\)</span>.</p></li>
</ol>
<p>This is equivalent to <span class="math inline">\(F = \frac{{Group MS}}{Error MS}\)</span></p>
</div>
<div id="alternative-to-the-in-class-assignment" class="section level3 hasAnchor" number="22.16.7">
<h3><span class="header-section-number">22.16.7</span> Alternative to the in-class assignment<a href="in-class-assignments.html#alternative-to-the-in-class-assignment" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This in-class assignment will necessitate rudimentary R knowledege that can be obtained by completing the R tutorial. It is my hope that working through this lesson will help to reinforce the reading. R was developed to perform this type of statistical analysis. Some of you have expressed disinterest in using the R platform as a pedagogical tool. To be responsive to this you can use your class time on an alternative to the in-class assignment. I recommend working through Zar 5th edition problems by hand:</p>
<p>Chapter 10; example 10.1, problems 10.1, 10.2, 10.6.</p>
<p>If attempting these alternative problems are a better fit for your learning style and academic goals then I would encourage you to go this route. The most important thing is to think about what you are doing as you proceed in the in-class assignment or the alternative.</p>
</div>
<div id="perform-the-anova" class="section level3 hasAnchor" number="22.16.8">
<h3><span class="header-section-number">22.16.8</span> Perform the ANOVA<a href="in-class-assignments.html#perform-the-anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Prior to performing any of the statistical tests you will need to perform an exhaustive evaluation of the data - this is the first step in all analytical endeavors prior to performing statistical tests. I would recommend going beyond the “summary” funciton - which really is not that useful. The functions “var”, “length”, “sum”, and “mean” will need to be used below.</p>
<p>Perform statistical tests to evaluate whether parameteric statistics can be used to test the hypothesis <span class="math inline">\(\mu_1 = \mu_2= \mu_3\)</span>.</p>
<p>To start, lets write a script to calculate a the one-way ANOVA.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="in-class-assignments.html#cb181-1" tabindex="-1"></a><span class="co"># First, we&#39;ll create some data, these data are from Zar 10.1</span></span>
<span id="cb181-2"><a href="in-class-assignments.html#cb181-2" tabindex="-1"></a>pig.dat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb181-3"><a href="in-class-assignments.html#cb181-3" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="st">&quot;Feed.01&quot;</span>, <span class="dv">5</span>),<span class="fu">c</span>(<span class="fl">60.8</span>, <span class="dv">57</span>, <span class="dv">65</span>, <span class="fl">58.6</span>, <span class="fl">61.7</span>)),</span>
<span id="cb181-4"><a href="in-class-assignments.html#cb181-4" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="st">&quot;Feed.02&quot;</span>, <span class="dv">5</span>),<span class="fu">c</span>(<span class="fl">68.7</span>,<span class="fl">67.7</span>,<span class="dv">74</span>,<span class="fl">66.3</span>,<span class="fl">69.8</span>)),</span>
<span id="cb181-5"><a href="in-class-assignments.html#cb181-5" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="st">&quot;Feed.03&quot;</span>, <span class="dv">4</span>),<span class="fu">c</span>(<span class="fl">102.6</span>,<span class="fl">102.1</span>,<span class="fl">100.2</span>,<span class="fl">96.5</span>)),</span>
<span id="cb181-6"><a href="in-class-assignments.html#cb181-6" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="st">&quot;Feed.04&quot;</span>, <span class="dv">5</span>),<span class="fu">c</span>(<span class="fl">87.9</span>,<span class="fl">84.2</span>,<span class="fl">83.1</span>,<span class="fl">85.7</span>,<span class="fl">90.3</span>)))</span>
<span id="cb181-7"><a href="in-class-assignments.html#cb181-7" tabindex="-1"></a></span>
<span id="cb181-8"><a href="in-class-assignments.html#cb181-8" tabindex="-1"></a>pig.dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pig.dat)</span>
<span id="cb181-9"><a href="in-class-assignments.html#cb181-9" tabindex="-1"></a><span class="fu">names</span>(pig.dat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;diet&quot;</span>,<span class="st">&quot;weight&quot;</span>)</span>
<span id="cb181-10"><a href="in-class-assignments.html#cb181-10" tabindex="-1"></a>pig.dat<span class="sc">$</span>weight <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(pig.dat<span class="sc">$</span>weight))</span>
<span id="cb181-11"><a href="in-class-assignments.html#cb181-11" tabindex="-1"></a></span>
<span id="cb181-12"><a href="in-class-assignments.html#cb181-12" tabindex="-1"></a><span class="co"># Perform your analysis of the data here and convince yourself that it be analyzed </span></span>
<span id="cb181-13"><a href="in-class-assignments.html#cb181-13" tabindex="-1"></a><span class="co"># with parameteric statistics? Necessary for doing in your own work, </span></span>
<span id="cb181-14"><a href="in-class-assignments.html#cb181-14" tabindex="-1"></a><span class="co"># but we can examine the data quickly:</span></span>
<span id="cb181-15"><a href="in-class-assignments.html#cb181-15" tabindex="-1"></a></span>
<span id="cb181-16"><a href="in-class-assignments.html#cb181-16" tabindex="-1"></a><span class="fu">boxplot</span>(pig.dat<span class="sc">$</span>weight <span class="sc">~</span> pig.dat<span class="sc">$</span>diet, <span class="at">xlab =</span> <span class="st">&quot;Diet&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Weight&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="in-class-assignments.html#cb182-1" tabindex="-1"></a><span class="co"># Next, lets look to see how the ANOVA calculated.</span></span>
<span id="cb182-2"><a href="in-class-assignments.html#cb182-2" tabindex="-1"></a><span class="co"># This section will not make sense unless you have done the reading... </span></span>
<span id="cb182-3"><a href="in-class-assignments.html#cb182-3" tabindex="-1"></a><span class="co"># I used Zar (fifth edition), example 10.1.</span></span>
<span id="cb182-4"><a href="in-class-assignments.html#cb182-4" tabindex="-1"></a></span>
<span id="cb182-5"><a href="in-class-assignments.html#cb182-5" tabindex="-1"></a><span class="co"># Bartlett Test of Homogeneity of Variances</span></span>
<span id="cb182-6"><a href="in-class-assignments.html#cb182-6" tabindex="-1"></a><span class="fu">bartlett.test</span>(weight<span class="sc">~</span>diet, <span class="at">data=</span>pig.dat)</span>
<span id="cb182-7"><a href="in-class-assignments.html#cb182-7" tabindex="-1"></a></span>
<span id="cb182-8"><a href="in-class-assignments.html#cb182-8" tabindex="-1"></a><span class="co"># We can visualize the Bartlett Test - you must install.package HH</span></span>
<span id="cb182-9"><a href="in-class-assignments.html#cb182-9" tabindex="-1"></a><span class="co"># hov is &quot;homogeneity of variances&quot;</span></span>
<span id="cb182-10"><a href="in-class-assignments.html#cb182-10" tabindex="-1"></a><span class="fu">require</span>(HH)</span>
<span id="cb182-11"><a href="in-class-assignments.html#cb182-11" tabindex="-1"></a><span class="fu">hov</span>(weight<span class="sc">~</span>diet, <span class="at">data=</span>pig.dat)</span>
<span id="cb182-12"><a href="in-class-assignments.html#cb182-12" tabindex="-1"></a><span class="fu">hovPlot</span>(weight<span class="sc">~</span>diet, <span class="at">data=</span>pig.dat)</span>
<span id="cb182-13"><a href="in-class-assignments.html#cb182-13" tabindex="-1"></a></span>
<span id="cb182-14"><a href="in-class-assignments.html#cb182-14" tabindex="-1"></a><span class="co"># This identifies the data in each of the three treatment levels...</span></span>
<span id="cb182-15"><a href="in-class-assignments.html#cb182-15" tabindex="-1"></a>yA <span class="ot">&lt;-</span> pig.dat<span class="sc">$</span>weight[<span class="fu">which</span>(pig.dat<span class="sc">$</span>diet <span class="sc">==</span> <span class="st">&quot;Feed.01&quot;</span>)]</span>
<span id="cb182-16"><a href="in-class-assignments.html#cb182-16" tabindex="-1"></a>yB <span class="ot">&lt;-</span> pig.dat<span class="sc">$</span>weight[<span class="fu">which</span>(pig.dat<span class="sc">$</span>diet <span class="sc">==</span> <span class="st">&quot;Feed.02&quot;</span>)]</span>
<span id="cb182-17"><a href="in-class-assignments.html#cb182-17" tabindex="-1"></a>yC <span class="ot">&lt;-</span> pig.dat<span class="sc">$</span>weight[<span class="fu">which</span>(pig.dat<span class="sc">$</span>diet <span class="sc">==</span> <span class="st">&quot;Feed.03&quot;</span>)]</span>
<span id="cb182-18"><a href="in-class-assignments.html#cb182-18" tabindex="-1"></a>yD <span class="ot">&lt;-</span> pig.dat<span class="sc">$</span>weight[<span class="fu">which</span>(pig.dat<span class="sc">$</span>diet <span class="sc">==</span> <span class="st">&quot;Feed.04&quot;</span>)]</span>
<span id="cb182-19"><a href="in-class-assignments.html#cb182-19" tabindex="-1"></a></span>
<span id="cb182-20"><a href="in-class-assignments.html#cb182-20" tabindex="-1"></a>nA   <span class="ot">&lt;-</span> <span class="fu">length</span>(yA)    <span class="co"># sample size of group A</span></span>
<span id="cb182-21"><a href="in-class-assignments.html#cb182-21" tabindex="-1"></a>meanA <span class="ot">&lt;-</span> <span class="fu">mean</span>(yA)     <span class="co"># mean of group A</span></span>
<span id="cb182-22"><a href="in-class-assignments.html#cb182-22" tabindex="-1"></a><span class="fu">shapiro.test</span>(yA)</span>
<span id="cb182-23"><a href="in-class-assignments.html#cb182-23" tabindex="-1"></a><span class="fu">hist</span>(yA)</span>
<span id="cb182-24"><a href="in-class-assignments.html#cb182-24" tabindex="-1"></a><span class="fu">qqnorm</span>(yA)</span>
<span id="cb182-25"><a href="in-class-assignments.html#cb182-25" tabindex="-1"></a><span class="fu">qqline</span>(yA)</span>
<span id="cb182-26"><a href="in-class-assignments.html#cb182-26" tabindex="-1"></a></span>
<span id="cb182-27"><a href="in-class-assignments.html#cb182-27" tabindex="-1"></a>nB   <span class="ot">&lt;-</span> <span class="fu">length</span>(yB)    <span class="co"># sample size of group B</span></span>
<span id="cb182-28"><a href="in-class-assignments.html#cb182-28" tabindex="-1"></a>meanB <span class="ot">&lt;-</span> <span class="fu">mean</span>(yB)     <span class="co"># mean of group B</span></span>
<span id="cb182-29"><a href="in-class-assignments.html#cb182-29" tabindex="-1"></a></span>
<span id="cb182-30"><a href="in-class-assignments.html#cb182-30" tabindex="-1"></a>nC   <span class="ot">&lt;-</span> <span class="fu">length</span>(yC)    <span class="co"># sample size of sample C</span></span>
<span id="cb182-31"><a href="in-class-assignments.html#cb182-31" tabindex="-1"></a>meanC <span class="ot">&lt;-</span> <span class="fu">mean</span>(yC)     <span class="co"># mean of sample C</span></span>
<span id="cb182-32"><a href="in-class-assignments.html#cb182-32" tabindex="-1"></a></span>
<span id="cb182-33"><a href="in-class-assignments.html#cb182-33" tabindex="-1"></a>nD   <span class="ot">&lt;-</span> <span class="fu">length</span>(yD)    <span class="co"># sample size of sample D</span></span>
<span id="cb182-34"><a href="in-class-assignments.html#cb182-34" tabindex="-1"></a>meanD <span class="ot">&lt;-</span> <span class="fu">mean</span>(yD)     <span class="co"># mean of sample D</span></span>
<span id="cb182-35"><a href="in-class-assignments.html#cb182-35" tabindex="-1"></a></span>
<span id="cb182-36"><a href="in-class-assignments.html#cb182-36" tabindex="-1"></a><span class="co"># Next determine the number of total elements &quot;N&quot;</span></span>
<span id="cb182-37"><a href="in-class-assignments.html#cb182-37" tabindex="-1"></a>N. <span class="ot">&lt;-</span>  <span class="fu">sum</span>(<span class="fu">c</span>(nA, nB, nC, nD))</span>
<span id="cb182-38"><a href="in-class-assignments.html#cb182-38" tabindex="-1"></a>grand.mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(pig.dat<span class="sc">$</span>weight)</span></code></pre></div>
<p>So we have calculated <span class="math inline">\(n_i\)</span>, <span class="math inline">\(\overline{X}_i\)</span>, <span class="math inline">\(\overline{X}\)</span>, and <span class="math inline">\(N\)</span>.</p>
<p>We can use the above quantities to calculate the different sources of error:</p>
<p>Residual (Within-group) SS = <span class="math inline">\(\sum_{i = 1}^{k}\sum_{j = 1}^{n_i}[(X_{ij} - \overline{X}_i)^2]\)</span>,</p>
<p>Model (Among-group) SS = <span class="math inline">\(\sum_{i = 1}^{k}n_i(\overline{X}_i - \overline{X})^2\)</span>, and</p>
<p>Total SS = <span class="math inline">\(\sum_{i = 1}^{k}\sum_{j = 1}^{n_i}(X_{ij} - \overline{X})^2\)</span>.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="in-class-assignments.html#cb183-1" tabindex="-1"></a><span class="co"># Residual SS (&quot;I use wg.SS to label the object &quot;within group&quot;)</span></span>
<span id="cb183-2"><a href="in-class-assignments.html#cb183-2" tabindex="-1"></a>wg.SS <span class="ot">&lt;-</span> <span class="fu">c</span>((yA <span class="sc">-</span> meanA)<span class="sc">^</span><span class="dv">2</span>, (yB <span class="sc">-</span> meanB)<span class="sc">^</span><span class="dv">2</span>, (yC <span class="sc">-</span> meanC)<span class="sc">^</span><span class="dv">2</span>, (yD <span class="sc">-</span> meanD)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb183-3"><a href="in-class-assignments.html#cb183-3" tabindex="-1"></a>wg.SS <span class="ot">&lt;-</span> <span class="fu">sum</span>(wg.SS)</span></code></pre></div>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="in-class-assignments.html#cb184-1" tabindex="-1"></a><span class="co"># Model SS (&quot;I use ag.SS to label the object &quot;among group&quot;)</span></span>
<span id="cb184-2"><a href="in-class-assignments.html#cb184-2" tabindex="-1"></a>ag.SS <span class="ot">&lt;-</span> <span class="fu">c</span>(nA<span class="sc">*</span>(meanA <span class="sc">-</span> grand.mean)<span class="sc">^</span><span class="dv">2</span>, nB<span class="sc">*</span>(meanB <span class="sc">-</span> grand.mean)<span class="sc">^</span><span class="dv">2</span>, </span>
<span id="cb184-3"><a href="in-class-assignments.html#cb184-3" tabindex="-1"></a>           nC<span class="sc">*</span>(meanC <span class="sc">-</span> grand.mean)<span class="sc">^</span><span class="dv">2</span>, nD<span class="sc">*</span>(meanD <span class="sc">-</span> grand.mean)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb184-4"><a href="in-class-assignments.html#cb184-4" tabindex="-1"></a>ag.SS <span class="ot">&lt;-</span> <span class="fu">sum</span>(ag.SS)</span></code></pre></div>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="in-class-assignments.html#cb185-1" tabindex="-1"></a><span class="co"># Total SS</span></span>
<span id="cb185-2"><a href="in-class-assignments.html#cb185-2" tabindex="-1"></a>tot.SS <span class="ot">&lt;-</span> <span class="fu">c</span>(pig.dat<span class="sc">$</span>weight <span class="sc">-</span> grand.mean)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb185-3"><a href="in-class-assignments.html#cb185-3" tabindex="-1"></a>tot.SS <span class="ot">&lt;-</span> <span class="fu">sum</span>(tot.SS)</span></code></pre></div>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="in-class-assignments.html#cb186-1" tabindex="-1"></a><span class="co"># Check our arithmatic, does total SS equal the sum of it&#39;s components</span></span>
<span id="cb186-2"><a href="in-class-assignments.html#cb186-2" tabindex="-1"></a>tot.SS <span class="sc">==</span> ag.SS <span class="sc">+</span> wg.SS</span></code></pre></div>
<p>I will let you finish the calculations:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="in-class-assignments.html#cb187-1" tabindex="-1"></a><span class="co"># Calculate the degrees of freedom - you will fill these in</span></span>
<span id="cb187-2"><a href="in-class-assignments.html#cb187-2" tabindex="-1"></a><span class="co"># Total df</span></span>
<span id="cb187-3"><a href="in-class-assignments.html#cb187-3" tabindex="-1"></a>tot.df <span class="ot">&lt;-</span>            </span>
<span id="cb187-4"><a href="in-class-assignments.html#cb187-4" tabindex="-1"></a><span class="co"># Residual df</span></span>
<span id="cb187-5"><a href="in-class-assignments.html#cb187-5" tabindex="-1"></a>group.df <span class="ot">&lt;-</span>          </span>
<span id="cb187-6"><a href="in-class-assignments.html#cb187-6" tabindex="-1"></a><span class="co"># Model df</span></span>
<span id="cb187-7"><a href="in-class-assignments.html#cb187-7" tabindex="-1"></a>error.df <span class="ot">&lt;-</span>          </span></code></pre></div>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="in-class-assignments.html#cb188-1" tabindex="-1"></a><span class="co"># Calculate the mean square model and residual - you need to fill the values in</span></span>
<span id="cb188-2"><a href="in-class-assignments.html#cb188-2" tabindex="-1"></a><span class="co"># among.group</span></span>
<span id="cb188-3"><a href="in-class-assignments.html#cb188-3" tabindex="-1"></a>mean.sq.model <span class="ot">&lt;-</span>        </span>
<span id="cb188-4"><a href="in-class-assignments.html#cb188-4" tabindex="-1"></a><span class="co"># within.group </span></span>
<span id="cb188-5"><a href="in-class-assignments.html#cb188-5" tabindex="-1"></a>mean.sq.residual <span class="ot">&lt;-</span>     </span>
<span id="cb188-6"><a href="in-class-assignments.html#cb188-6" tabindex="-1"></a><span class="co"># Calculate the F value</span></span>
<span id="cb188-7"><a href="in-class-assignments.html#cb188-7" tabindex="-1"></a><span class="co"># </span></span></code></pre></div>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="in-class-assignments.html#cb189-1" tabindex="-1"></a><span class="co"># Lets examine the F-distribution</span></span>
<span id="cb189-2"><a href="in-class-assignments.html#cb189-2" tabindex="-1"></a>df1.v <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb189-3"><a href="in-class-assignments.html#cb189-3" tabindex="-1"></a>df2.v <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb189-4"><a href="in-class-assignments.html#cb189-4" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="dv">5</span>,<span class="at">by =</span> <span class="fl">0.01</span>), <span class="fu">df</span>(<span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="dv">5</span>,<span class="at">by =</span> <span class="fl">0.01</span>), <span class="at">df1=</span>df1.v, <span class="at">df2=</span>df2.v), <span class="at">ylab =</span> <span class="st">&quot;f(x)&quot;</span>, </span>
<span id="cb189-5"><a href="in-class-assignments.html#cb189-5" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Quantile&quot;</span>, <span class="at">cex =</span> <span class="fl">0.2</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;F distribution for numerator df = &quot;</span>,df1.v, <span class="st">&quot; and denom. df = &quot;</span>,df2.v, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb189-6"><a href="in-class-assignments.html#cb189-6" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="dv">5</span>,<span class="at">by =</span> <span class="fl">0.01</span>), <span class="fu">df</span>(<span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="dv">5</span>,<span class="at">by =</span> <span class="fl">0.01</span>), <span class="at">df1=</span><span class="dv">5</span>, <span class="at">df2=</span><span class="dv">2</span>))</span>
<span id="cb189-7"><a href="in-class-assignments.html#cb189-7" tabindex="-1"></a></span>
<span id="cb189-8"><a href="in-class-assignments.html#cb189-8" tabindex="-1"></a><span class="co"># This distribution is striking - it is the first non-symmetric one we have seen...</span></span></code></pre></div>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="in-class-assignments.html#cb190-1" tabindex="-1"></a><span class="co"># Determine the critical value for the F distribution.</span></span>
<span id="cb190-2"><a href="in-class-assignments.html#cb190-2" tabindex="-1"></a><span class="co"># This should look very familiar... it is the quantile </span></span>
<span id="cb190-3"><a href="in-class-assignments.html#cb190-3" tabindex="-1"></a><span class="co"># against which we will compare our calculated F statistic.</span></span>
<span id="cb190-4"><a href="in-class-assignments.html#cb190-4" tabindex="-1"></a><span class="co"># Replace the &quot;XXX&quot; in teh equation below</span></span>
<span id="cb190-5"><a href="in-class-assignments.html#cb190-5" tabindex="-1"></a>critical.F <span class="ot">&lt;-</span> <span class="fu">qf</span>(<span class="fl">0.975</span>, df.val, df.val.) </span></code></pre></div>
<p>What is interesting, suprising, informative (not rhetorical questions)? Understanding the components of the model is necessary for understanding the ANOVA.</p>
</div>
<div id="built-in-anova-in-r" class="section level3 hasAnchor" number="22.16.9">
<h3><span class="header-section-number">22.16.9</span> Built-in ANOVA in R<a href="in-class-assignments.html#built-in-anova-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the functions that you wrote and compare the results to those of the built in t-test function in R</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="in-class-assignments.html#cb191-1" tabindex="-1"></a>lm.obj <span class="ot">&lt;-</span> <span class="fu">lm</span>(pig.dat<span class="sc">$</span>weight <span class="sc">~</span> pig.dat<span class="sc">$</span>diet)</span>
<span id="cb191-2"><a href="in-class-assignments.html#cb191-2" tabindex="-1"></a><span class="fu">anova</span>(lm.obj)</span></code></pre></div>
</div>
<div id="for-you-to-do" class="section level3 hasAnchor" number="22.16.10">
<h3><span class="header-section-number">22.16.10</span> For you to do:<a href="in-class-assignments.html#for-you-to-do" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For a data set that you create, show (using math) that MSE is equal to the pooled variance in the <span class="math inline">\(t\)</span> test. This is done as easily in excel or a piece of paper as in R.</p>
</div>
<div id="what-are-the-tests-we-can-use-to-determine-if-mu_k-1-mu_k-2-from-the-above-example" class="section level3 hasAnchor" number="22.16.11">
<h3><span class="header-section-number">22.16.11</span> What are the tests we can use to determine if <span class="math inline">\(\mu_{k = 1} = \mu_{k = 2}\)</span> from the above example?<a href="in-class-assignments.html#what-are-the-tests-we-can-use-to-determine-if-mu_k-1-mu_k-2-from-the-above-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Tukey Post-hoc test (from R-bloggers By Flavio Barros)</p>
<p>First create some data</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="in-class-assignments.html#cb192-1" tabindex="-1"></a>chocolate <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb192-2"><a href="in-class-assignments.html#cb192-2" tabindex="-1"></a>  <span class="at">Sabor =</span></span>
<span id="cb192-3"><a href="in-class-assignments.html#cb192-3" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">3</span>,</span>
<span id="cb192-4"><a href="in-class-assignments.html#cb192-4" tabindex="-1"></a>    <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">6</span>,</span>
<span id="cb192-5"><a href="in-class-assignments.html#cb192-5" tabindex="-1"></a>    <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">6</span>,</span>
<span id="cb192-6"><a href="in-class-assignments.html#cb192-6" tabindex="-1"></a>    <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">0</span>,</span>
<span id="cb192-7"><a href="in-class-assignments.html#cb192-7" tabindex="-1"></a>    <span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">0</span>,</span>
<span id="cb192-8"><a href="in-class-assignments.html#cb192-8" tabindex="-1"></a>    <span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">0</span>,</span>
<span id="cb192-9"><a href="in-class-assignments.html#cb192-9" tabindex="-1"></a>    <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">0</span>,</span>
<span id="cb192-10"><a href="in-class-assignments.html#cb192-10" tabindex="-1"></a>    <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">1</span>,</span>
<span id="cb192-11"><a href="in-class-assignments.html#cb192-11" tabindex="-1"></a>    <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">0</span>,</span>
<span id="cb192-12"><a href="in-class-assignments.html#cb192-12" tabindex="-1"></a>    <span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">0</span>,</span>
<span id="cb192-13"><a href="in-class-assignments.html#cb192-13" tabindex="-1"></a>    <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">0</span>,</span>
<span id="cb192-14"><a href="in-class-assignments.html#cb192-14" tabindex="-1"></a>    <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">4</span>,</span>
<span id="cb192-15"><a href="in-class-assignments.html#cb192-15" tabindex="-1"></a>    <span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">0</span>,</span>
<span id="cb192-16"><a href="in-class-assignments.html#cb192-16" tabindex="-1"></a>    <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">0</span>,</span>
<span id="cb192-17"><a href="in-class-assignments.html#cb192-17" tabindex="-1"></a>    <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">3</span></span>
<span id="cb192-18"><a href="in-class-assignments.html#cb192-18" tabindex="-1"></a>  ),</span>
<span id="cb192-19"><a href="in-class-assignments.html#cb192-19" tabindex="-1"></a><span class="at">Tipo =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="dv">15</span>)),</span>
<span id="cb192-20"><a href="in-class-assignments.html#cb192-20" tabindex="-1"></a><span class="at">Provador =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, <span class="fu">rep</span>(<span class="dv">3</span>, <span class="dv">15</span>))))</span></code></pre></div>
<p>Construct the linear model and examine output</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="in-class-assignments.html#cb193-1" tabindex="-1"></a>ajuste <span class="ot">&lt;-</span> <span class="fu">lm</span>(chocolate<span class="sc">$</span>Sabor <span class="sc">~</span> chocolate<span class="sc">$</span>Tipo)</span>
<span id="cb193-2"><a href="in-class-assignments.html#cb193-2" tabindex="-1"></a><span class="fu">summary</span>(ajuste)</span>
<span id="cb193-3"><a href="in-class-assignments.html#cb193-3" tabindex="-1"></a><span class="fu">anova</span>(ajuste)</span>
<span id="cb193-4"><a href="in-class-assignments.html#cb193-4" tabindex="-1"></a><span class="fu">boxplot</span>(chocolate<span class="sc">$</span>Sabor <span class="sc">~</span> chocolate<span class="sc">$</span>Tipo)</span></code></pre></div>
<p>The post-hoc test</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="in-class-assignments.html#cb194-1" tabindex="-1"></a>a1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(chocolate<span class="sc">$</span>Sabor <span class="sc">~</span> chocolate<span class="sc">$</span>Tipo)</span>
<span id="cb194-2"><a href="in-class-assignments.html#cb194-2" tabindex="-1"></a>posthoc <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(<span class="at">x=</span>a1, <span class="st">&#39;chocolate$Tipo&#39;</span>, <span class="at">conf.level=</span><span class="fl">0.95</span>)</span>
<span id="cb194-3"><a href="in-class-assignments.html#cb194-3" tabindex="-1"></a>posthoc</span></code></pre></div>
</div>
</div>
<div id="factorial-anova" class="section level2 hasAnchor" number="22.17">
<h2><span class="header-section-number">22.17</span> Factorial ANOVA<a href="in-class-assignments.html#factorial-anova" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="to-round-out-your-ability-to-perform-linear-modeling-in-r-the-following-is-and-in-class-assignment-to-promote-understanding-of-factorial-anova." class="section level3 hasAnchor" number="22.17.1">
<h3><span class="header-section-number">22.17.1</span> To round out your ability to perform linear modeling in R, the following is and in class assignment to promote understanding of factorial ANOVA.<a href="in-class-assignments.html#to-round-out-your-ability-to-perform-linear-modeling-in-r-the-following-is-and-in-class-assignment-to-promote-understanding-of-factorial-anova." class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="in-this-in-class-assignment-we-will-1" class="section level3 hasAnchor" number="22.17.2">
<h3><span class="header-section-number">22.17.2</span> In this in class assignment we will:<a href="in-class-assignments.html#in-this-in-class-assignment-we-will-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>1.) Understand the assumptions of this parameteric statistical approach.</p>
<p>2.) Understand the structure and calculations of the factorial ANOVA.</p>
<p>3.) Understand the causes and interpretation of interaction effects.</p>
</div>
<div id="the-assumptions-of-factorial-anova" class="section level3 hasAnchor" number="22.17.3">
<h3><span class="header-section-number">22.17.3</span> The assumptions of factorial ANOVA<a href="in-class-assignments.html#the-assumptions-of-factorial-anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>1.) The variables independent</p>
<p>2.) The variables are normally distributed</p>
<p>3.) The variances in observations in each group are equal</p>
</div>
<div id="we-are-interested-in-detecting-whether-there-is-a-difference-in-the-means-of-two-or-more-populations" class="section level3 hasAnchor" number="22.17.4">
<h3><span class="header-section-number">22.17.4</span> We are interested in detecting whether there is a difference in the means of two or more populations<a href="in-class-assignments.html#we-are-interested-in-detecting-whether-there-is-a-difference-in-the-means-of-two-or-more-populations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will extend our linear model to accomodate an increase in the number of independent factors that can be evaluated.</p>
<p>So for example we have this experimental design, where <span class="math inline">\(n\)</span> is the number of observations in each cell:</p>
<p>In this design we have two factors (Feed and Life Stage [LS]) consisting of three feed treatments and two life stage treatments. The design is balanced - we have an equal number of represenative samples from each pairwise combination of observations.</p>
<p>The 2-way ANOVA is probably the most popular layout in the design of experiments, both manipuative and mensurative: It utilizes every combination of factor levels hence it is called “factorial ANOVA”.</p>
<p>The experiment has two “levels” for the factor “LS” (<span class="math inline">\(a = 2\)</span>) and three “levels” for the factor “Feed” (<span class="math inline">\(b = 3\)</span>). Thus, there are <span class="math inline">\(ab\)</span> = 2 x 3 = 6 different combinations of Feed and LS With each combination you have <span class="math inline">\(r = 4\)</span> observations. <span class="math inline">\(r\)</span> is called the number of replicates, in each cell.</p>
<p>The total number of replicates <span class="math inline">\((N)\)</span> is:</p>
<p><span class="math inline">\(N = abr = 24\)</span></p>
<p>The amounts <span class="math inline">\(Y_{ijk}\)</span> is the amount of weight gain for each replicate <span class="math inline">\((k = 1, 2, 3, 4)\)</span> with LS <span class="math inline">\(i\)</span>, <span class="math inline">\((i = 1, 2)\)</span> at feed <span class="math inline">\(j\)</span>, <span class="math inline">\((j = 1, 2, 3)\)</span>.</p>
<p>What do you think is the minimum number of replicates we need in each cell the table? Why?</p>
</div>
<div id="what-does-this-statistival-test-do" class="section level3 hasAnchor" number="22.17.5">
<h3><span class="header-section-number">22.17.5</span> What does this statistival test do?<a href="in-class-assignments.html#what-does-this-statistival-test-do" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Using this design we can test three different hypotheses simultaneously:</p>
<p><span class="math inline">\(\mu_{Feed = 1} = \mu_{Feed = 2}= \mu_{Feed = 3}\)</span>,</p>
<p><span class="math inline">\(\mu_{Juvenile} = \mu_{Adult}\)</span>,</p>
<p>and,</p>
<p>that there is no interaction between Feed and Life Stage treatments.</p>
<p>Given the linear model:</p>
<p><span class="math inline">\(y_i = \beta_0 + \beta_{Feed}X_{Feed_i} + \beta_{Lifestage}X_{Lifestage_i} + \beta_{Interaction}X_{Feed_i}X_{Lifestage_i}\)</span>,</p>
<p>we will test:</p>
<p><span class="math inline">\(\beta_{Feed} = 0\)</span>,</p>
<p><span class="math inline">\(\beta_{Lifestage} = 0\)</span>,</p>
<p>and <span class="math inline">\(\beta_{Interaction} = 0\)</span>.</p>
<p>This is equivalent to testing the equality of means of the population, but now we test the whether the parameters of the linear model are equal to zero. So we are using the data to inform the model, deriving parameters, and making population-level inferences.</p>
</div>
<div id="sum-of-squares-calculations" class="section level3 hasAnchor" number="22.17.6">
<h3><span class="header-section-number">22.17.6</span> Sum of Squares Calculations<a href="in-class-assignments.html#sum-of-squares-calculations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To test model fit and determine linear model parameter values (and determine if they are signficantly different from zero), we will perform some calculations. Similiar to the one-way ANOVA, we will be partitioning the variance among groups: “Factor A”, “Factor B”, “interaction of Factor A and Factor B”, and “within subgroups”. These sources of variation sum to the “Total” variation.</p>
</div>
<div id="anova-table" class="section level3 hasAnchor" number="22.17.7">
<h3><span class="header-section-number">22.17.7</span> ANOVA Table<a href="in-class-assignments.html#anova-table" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math inline">\(\underbrace{\sum_{i=1}^a\sum_{j=1}^b\sum_{k=1}^r(X_{ijk} - \overline{X})^2}_{SS_{Total}} = \underbrace{{rb}\sum_{i=1}^a(\overline{X}_{i} - \overline{X})^2}_{SS_{A}} + \underbrace{ra\sum_{j=1}^b(\overline{X}_{j} - \overline{X})^2}_{SS_{B}} + \underbrace{\sum_{i=1}^a\sum_{j=1}^b(\overline{X}_{ij} - \overline{X}_{i}- \overline{X}_{j} + \overline{X})^2}_{SS_{A \times B}} + \underbrace{ \sum_{i=1}^a\sum_{j=1}^b\sum_{k=1}^r(X_{ijk} - \overline{X}_{ij})^2}_{SS_{within}}\)</span></p>
<p>We are using the relationship of the variance explained by each component to determine our model fit (Fields et al. 12.4).</p>
</div>
<div id="if-you-prefer-to-work-through-the-r-code-it-is-here" class="section level3 hasAnchor" number="22.17.8">
<h3><span class="header-section-number">22.17.8</span> If you prefer to work through the R code it is here<a href="in-class-assignments.html#if-you-prefer-to-work-through-the-r-code-it-is-here" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="in-class-assignments.html#cb195-1" tabindex="-1"></a><span class="co"># Lets make some observed data - each of these cells is the </span></span>
<span id="cb195-2"><a href="in-class-assignments.html#cb195-2" tabindex="-1"></a></span>
<span id="cb195-3"><a href="in-class-assignments.html#cb195-3" tabindex="-1"></a>Feed <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;01&quot;</span>,<span class="dv">4</span>), <span class="fu">rep</span>(<span class="st">&quot;02&quot;</span>,<span class="dv">4</span>), <span class="fu">rep</span>(<span class="st">&quot;03&quot;</span>,<span class="dv">4</span>)),<span class="dv">2</span>)</span>
<span id="cb195-4"><a href="in-class-assignments.html#cb195-4" tabindex="-1"></a>Lifestage <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;Juv.&quot;</span>,<span class="dv">12</span>), <span class="fu">rep</span>(<span class="st">&quot;Adult&quot;</span>,<span class="dv">12</span>))</span>
<span id="cb195-5"><a href="in-class-assignments.html#cb195-5" tabindex="-1"></a>weight.gain <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">5</span>, <span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">8</span>,<span class="dv">12</span>,</span>
<span id="cb195-6"><a href="in-class-assignments.html#cb195-6" tabindex="-1"></a>                 <span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">11</span>,<span class="dv">9</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">4</span>, </span>
<span id="cb195-7"><a href="in-class-assignments.html#cb195-7" tabindex="-1"></a>                 <span class="dv">13</span>,<span class="dv">15</span>,<span class="dv">12</span>,<span class="dv">12</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">10</span>,<span class="dv">13</span>)</span>
<span id="cb195-8"><a href="in-class-assignments.html#cb195-8" tabindex="-1"></a></span>
<span id="cb195-9"><a href="in-class-assignments.html#cb195-9" tabindex="-1"></a>pig.dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(Feed, Lifestage, weight.gain))</span>
<span id="cb195-10"><a href="in-class-assignments.html#cb195-10" tabindex="-1"></a>pig.dat<span class="sc">$</span>weight.gain <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(pig.dat<span class="sc">$</span>weight.gain))</span></code></pre></div>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="in-class-assignments.html#cb196-1" tabindex="-1"></a><span class="co"># Lets do some preliminary examination of the data</span></span>
<span id="cb196-2"><a href="in-class-assignments.html#cb196-2" tabindex="-1"></a><span class="fu">boxplot</span>(pig.dat<span class="sc">$</span>weight.gain <span class="sc">~</span> pig.dat<span class="sc">$</span>Feed <span class="sc">+</span> pig.dat<span class="sc">$</span>Lifestage, </span>
<span id="cb196-3"><a href="in-class-assignments.html#cb196-3" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Diet and Lifestage&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Weight&quot;</span>)</span>
<span id="cb196-4"><a href="in-class-assignments.html#cb196-4" tabindex="-1"></a></span>
<span id="cb196-5"><a href="in-class-assignments.html#cb196-5" tabindex="-1"></a><span class="co"># Or maybe you prefer this?</span></span>
<span id="cb196-6"><a href="in-class-assignments.html#cb196-6" tabindex="-1"></a></span>
<span id="cb196-7"><a href="in-class-assignments.html#cb196-7" tabindex="-1"></a><span class="fu">boxplot</span>(pig.dat<span class="sc">$</span>weight.gain <span class="sc">~</span> pig.dat<span class="sc">$</span>Lifestage <span class="sc">+</span> pig.dat<span class="sc">$</span>Feed, </span>
<span id="cb196-8"><a href="in-class-assignments.html#cb196-8" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Diet and Lifestage&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Weight&quot;</span>)</span></code></pre></div>
<p>Which figure makes more sense to you, why (remember the objectives of the analysis)?</p>
</div>
<div id="construct-the-linear-model-fields-12.3.1" class="section level3 hasAnchor" number="22.17.9">
<h3><span class="header-section-number">22.17.9</span> Construct the linear model (Fields 12.3.1)<a href="in-class-assignments.html#construct-the-linear-model-fields-12.3.1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="in-class-assignments.html#cb197-1" tabindex="-1"></a>lm.obj <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight.gain <span class="sc">~</span> Lifestage <span class="sc">+</span> Feed <span class="sc">+</span> Lifestage<span class="sc">*</span>Feed, <span class="at">data =</span> pig.dat)</span>
<span id="cb197-2"><a href="in-class-assignments.html#cb197-2" tabindex="-1"></a></span>
<span id="cb197-3"><a href="in-class-assignments.html#cb197-3" tabindex="-1"></a>lm.obj</span>
<span id="cb197-4"><a href="in-class-assignments.html#cb197-4" tabindex="-1"></a></span>
<span id="cb197-5"><a href="in-class-assignments.html#cb197-5" tabindex="-1"></a><span class="co"># Given your understanding of ANOVA as a linear model, how do you </span></span>
<span id="cb197-6"><a href="in-class-assignments.html#cb197-6" tabindex="-1"></a><span class="co"># interepret the coefficients?</span></span>
<span id="cb197-7"><a href="in-class-assignments.html#cb197-7" tabindex="-1"></a><span class="co"># Look at the last term of the linear model... how is this model different?</span></span>
<span id="cb197-8"><a href="in-class-assignments.html#cb197-8" tabindex="-1"></a>lm.obj.main.effects.only <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight.gain <span class="sc">~</span> Lifestage <span class="sc">+</span> Feed, <span class="at">data =</span> pig.dat)</span>
<span id="cb197-9"><a href="in-class-assignments.html#cb197-9" tabindex="-1"></a></span>
<span id="cb197-10"><a href="in-class-assignments.html#cb197-10" tabindex="-1"></a>lm.obj.main.effects.only</span></code></pre></div>
</div>
<div id="evaluate-the-model" class="section level3 hasAnchor" number="22.17.10">
<h3><span class="header-section-number">22.17.10</span> Evaluate the model<a href="in-class-assignments.html#evaluate-the-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="in-class-assignments.html#cb198-1" tabindex="-1"></a><span class="fu">summary</span>(lm.obj)</span></code></pre></div>
<p>Make some statements about theh model fit to the data.</p>
</div>
<div id="construct-the-anova-table" class="section level3 hasAnchor" number="22.17.11">
<h3><span class="header-section-number">22.17.11</span> Construct the ANOVA Table<a href="in-class-assignments.html#construct-the-anova-table" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="in-class-assignments.html#cb199-1" tabindex="-1"></a><span class="fu">anova</span>(lm.obj)</span></code></pre></div>
<p>Given your understanding of partitioning the variance, how do you interpret ALL components of the “Sum Sq” and “Mean Sq”… this is the key to understanding the factorial ANOVA. See Fields 12.4, 12.9</p>
</div>
<div id="evaluate-the-anova-table" class="section level3 hasAnchor" number="22.17.12">
<h3><span class="header-section-number">22.17.12</span> Evaluate the ANOVA Table<a href="in-class-assignments.html#evaluate-the-anova-table" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Calculate the critical F values and double check the resulting probabilities using R functionality (hint FDist {stats}).</p>
<p>Make statements about the ability of the test to falsify each of the null hypothesis (n = 3).</p>
</div>
<div id="evaluate-the-interaction" class="section level3 hasAnchor" number="22.17.13">
<h3><span class="header-section-number">22.17.13</span> Evaluate the interaction<a href="in-class-assignments.html#evaluate-the-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="in-class-assignments.html#cb200-1" tabindex="-1"></a><span class="fu">interaction.plot</span>(pig.dat<span class="sc">$</span>Feed, pig.dat<span class="sc">$</span>Lifestage, pig.dat<span class="sc">$</span>weight.gain)</span></code></pre></div>
<p>Discuss the interaction term with your classmates, what do you think it tells you? See Fields Fig. 12.4, 12.8 and Fields section 12.4.2.3.</p>
</div>
<div id="perform-a-post-hoc-test" class="section level3 hasAnchor" number="22.17.14">
<h3><span class="header-section-number">22.17.14</span> Perform a <em>post hoc</em> test<a href="in-class-assignments.html#perform-a-post-hoc-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="in-class-assignments.html#cb201-1" tabindex="-1"></a><span class="fu">TukeyHSD</span>(<span class="fu">aov</span>(lm.obj), <span class="at">ordered =</span> T, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<p>There is a lot of output here. What is being done, what is being reported? Understand this in detail by evaluating the output. Refer to Fields section 12.5.11 (Tukey HSD).</p>
</div>
</div>
<div id="chi-square" class="section level2 hasAnchor" number="22.18">
<h2><span class="header-section-number">22.18</span> Chi square<a href="in-class-assignments.html#chi-square" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="in-this-in-class-assignment-we-will-learn-about-using-the-chi-square-test" class="section level3 hasAnchor" number="22.18.1">
<h3><span class="header-section-number">22.18.1</span> In this in class assignment we will learn about using the chi square test<a href="in-class-assignments.html#in-this-in-class-assignment-we-will-learn-about-using-the-chi-square-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Chi-Square test in R is a statistical method which used to determine if two categorical variables have a significant relationship between them. The two variables are selected from the same population.</p>
</div>
<div id="we-are-interested-in-detecting-whether-there-is-a-relationship-between-variables." class="section level3 hasAnchor" number="22.18.2">
<h3><span class="header-section-number">22.18.2</span> We are interested in detecting whether there is a relationship between variables.<a href="in-class-assignments.html#we-are-interested-in-detecting-whether-there-is-a-relationship-between-variables." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The input data is in the form of a table that contains the count value of the variables in the observation.</p>
<p>We use <em>chisq.test</em> function to perform the chi-square test of independence in the native stats package in R.</p>
<p>For this test, the function requires the contingency table to be in the form of a matrix. Depending on the form of the data, to begin with, this can need an extra step, either combining vectors into a matrix or cross-tabulating the counts among factors in a data frame.</p>
<p>We use read.table and as.matrix to read a table as a matrix. While using this, be careful of extra spaces at the end of lines.</p>
</div>
<div id="hypothetical-example-effectiveness-of-a-drug-treatment" class="section level3 hasAnchor" number="22.18.3">
<h3><span class="header-section-number">22.18.3</span> Hypothetical Example: Effectiveness of a Drug Treatment<a href="in-class-assignments.html#hypothetical-example-effectiveness-of-a-drug-treatment" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To test the effectiveness of a drug for a certain medical condition, we will consider a hypothetical case.</p>
<p>Suppose we have 105 patients under study and 50 of them were treated with the drug. The remaining 55 patients were kept under control samples. Thus, the health condition of all patients was checked after a week.</p>
<p>With the following table, we can assess if their condition has improved or not. By observing this table, one can you tell if the drug had a positive effect on the patient?</p>
<p>Here in this example, we can see that 35 out of the 50 patients showed improvement. Suppose if the drug had no effect, the 50 will split the same proportion of the patients who were not given the treatment. Here, in this case, improvement of the control case is high as about 70% of patients showed improvement, since both categorical variables which we have already defined must have only 2 levels. Also, it was sort of perceptive today that the drug treatment and health condition are dependent.</p>
</div>
<div id="worked-example-chi-square-test" class="section level3 hasAnchor" number="22.18.4">
<h3><span class="header-section-number">22.18.4</span> Worked Example Chi square test<a href="in-class-assignments.html#worked-example-chi-square-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Particularly in this test, we have to check the p-values. Moreover, like all statistical tests, we assume this test as a null hypothesis and an alternate hypothesis.</p>
<p>The main thing is, we reject the null hypothesis if the p-value that comes out in the result is less than a predetermined significance level, which is 0.05 usually, then we reject the null hypothesis.</p>
<p><span class="math inline">\(H_0\)</span>: The two variables are independent.</p>
<p>In the case of a null hypothesis, a chi-square test is to test the two variables that are independent.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="in-class-assignments.html#cb202-1" tabindex="-1"></a>data_frame <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://goo.gl/j6lRXD&quot;</span>)  <span class="co"># Reading CSV</span></span>
<span id="cb202-2"><a href="in-class-assignments.html#cb202-2" tabindex="-1"></a><span class="fu">table</span>(data_frame<span class="sc">$</span>treatment, data_frame<span class="sc">$</span>improvement)</span></code></pre></div>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="in-class-assignments.html#cb203-1" tabindex="-1"></a><span class="fu">chisq.test</span>(data_frame<span class="sc">$</span>treatment, data_frame<span class="sc">$</span>improvement, <span class="at">correct=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p>Let’s look at the output:</p>
<p>We have a chi-squared value of 5.5569. Since we get a p-Value less than the significance level of 0.05, we reject the null hypothesis and conclude that the two variables are in fact dependent.</p>
</div>
<div id="worked-example-2" class="section level3 hasAnchor" number="22.18.5">
<h3><span class="header-section-number">22.18.5</span> Worked Example 2<a href="in-class-assignments.html#worked-example-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Particularly for this challenge, first, find out if the ‘cyl’ and ‘carb’ variables are in ‘mtcars’ dataset and whether it is dependent or not.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="in-class-assignments.html#cb204-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;mtcars&quot;</span>)</span>
<span id="cb204-2"><a href="in-class-assignments.html#cb204-2" tabindex="-1"></a><span class="fu">table</span>(mtcars<span class="sc">$</span>carb, mtcars<span class="sc">$</span>cyl) </span></code></pre></div>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="in-class-assignments.html#cb205-1" tabindex="-1"></a><span class="fu">chisq.test</span>(mtcars<span class="sc">$</span>carb, mtcars<span class="sc">$</span>cyl)</span></code></pre></div>
</div>
<div id="use-following-dta-to-perform-the-chi-square-test" class="section level3 hasAnchor" number="22.18.6">
<h3><span class="header-section-number">22.18.6</span> Use following dta to perform the chi-square test<a href="in-class-assignments.html#use-following-dta-to-perform-the-chi-square-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Note, you will need to instal the package “gplots”</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="in-class-assignments.html#cb206-1" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="st">&quot;http://www.sthda.com/sthda/RDoc/data/housetasks.txt&quot;</span></span>
<span id="cb206-2"><a href="in-class-assignments.html#cb206-2" tabindex="-1"></a>housetasks <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(file_path, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb206-3"><a href="in-class-assignments.html#cb206-3" tabindex="-1"></a><span class="fu">head</span>(housetasks)</span></code></pre></div>
<p>Visualization:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="in-class-assignments.html#cb207-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;gplots&quot;</span>)</span>
<span id="cb207-2"><a href="in-class-assignments.html#cb207-2" tabindex="-1"></a><span class="co"># 1. convert the data as a table</span></span>
<span id="cb207-3"><a href="in-class-assignments.html#cb207-3" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">as.table</span>(<span class="fu">as.matrix</span>(housetasks))</span>
<span id="cb207-4"><a href="in-class-assignments.html#cb207-4" tabindex="-1"></a></span>
<span id="cb207-5"><a href="in-class-assignments.html#cb207-5" tabindex="-1"></a><span class="co"># 2. Graph</span></span>
<span id="cb207-6"><a href="in-class-assignments.html#cb207-6" tabindex="-1"></a><span class="fu">balloonplot</span>(<span class="fu">t</span>(dt), <span class="at">main =</span><span class="st">&quot;housetasks&quot;</span>, <span class="at">xlab =</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb207-7"><a href="in-class-assignments.html#cb207-7" tabindex="-1"></a>            <span class="at">label =</span> <span class="cn">FALSE</span>, <span class="at">show.margins =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>More visualization:</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="in-class-assignments.html#cb208-1" tabindex="-1"></a><span class="fu">mosaicplot</span>(dt, <span class="at">shade =</span> <span class="cn">TRUE</span>, <span class="at">las=</span><span class="dv">2</span>,</span>
<span id="cb208-2"><a href="in-class-assignments.html#cb208-2" tabindex="-1"></a>           <span class="at">main =</span> <span class="st">&quot;housetasks&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="in-class-assignments.html#cb209-1" tabindex="-1"></a>chisq <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(housetasks)</span>
<span id="cb209-2"><a href="in-class-assignments.html#cb209-2" tabindex="-1"></a>chisq<span class="sc">$</span>observed             <span class="co"># Observed counts</span></span>
<span id="cb209-3"><a href="in-class-assignments.html#cb209-3" tabindex="-1"></a><span class="fu">round</span>(chisq<span class="sc">$</span>expected,<span class="dv">2</span>)    <span class="co"># Expected counts</span></span>
<span id="cb209-4"><a href="in-class-assignments.html#cb209-4" tabindex="-1"></a><span class="fu">round</span>(chisq<span class="sc">$</span>residuals, <span class="dv">3</span>)  <span class="co"># How are these calculated and why do we want these values?</span></span>
<span id="cb209-5"><a href="in-class-assignments.html#cb209-5" tabindex="-1"></a></span>
<span id="cb209-6"><a href="in-class-assignments.html#cb209-6" tabindex="-1"></a><span class="co"># Contibution in percentage (%)</span></span>
<span id="cb209-7"><a href="in-class-assignments.html#cb209-7" tabindex="-1"></a>contrib <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span>chisq<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>chisq<span class="sc">$</span>statistic</span>
<span id="cb209-8"><a href="in-class-assignments.html#cb209-8" tabindex="-1"></a><span class="fu">round</span>(contrib, <span class="dv">3</span>)</span></code></pre></div>
<p>Using our analysis of residuals it can be seen that the most contributing cells to the Chi-square are Wife/Laundry (7.74%), Wife/Main_meal (4.98%), Husband/Repairs (21.9%), Jointly/Holidays (12.44%).</p>
<p>These cells contribute about 47.06% to the total Chi-square score and thus account for most of the difference between expected and observed values.</p>
<p>In this case, the contribution of one cell to the total Chi-square score becomes a useful way of establishing the nature of dependency.</p>
<p>If we would like to report estimates and p-values for hypothesis texting</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="in-class-assignments.html#cb210-1" tabindex="-1"></a><span class="co"># printing the p-value</span></span>
<span id="cb210-2"><a href="in-class-assignments.html#cb210-2" tabindex="-1"></a>chisq<span class="sc">$</span>p.value</span>
<span id="cb210-3"><a href="in-class-assignments.html#cb210-3" tabindex="-1"></a><span class="co"># printing the mean</span></span>
<span id="cb210-4"><a href="in-class-assignments.html#cb210-4" tabindex="-1"></a>chisq<span class="sc">$</span>estimate</span></code></pre></div>
</div>
<div id="worked-example---goodness-of-fit-testing" class="section level3 hasAnchor" number="22.18.7">
<h3><span class="header-section-number">22.18.7</span> Worked Example - goodness of fit testing<a href="in-class-assignments.html#worked-example---goodness-of-fit-testing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Null hypothesis (<span class="math inline">\(H_0\)</span>): There is no significant difference between the observed and the expected value.</p>
<p>Answer to Q1: Are the colors equally common?</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="in-class-assignments.html#cb211-1" tabindex="-1"></a>tulip <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">81</span>, <span class="dv">50</span>, <span class="dv">27</span>)</span>
<span id="cb211-2"><a href="in-class-assignments.html#cb211-2" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(tulip, <span class="at">p =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>))</span>
<span id="cb211-3"><a href="in-class-assignments.html#cb211-3" tabindex="-1"></a>res</span>
<span id="cb211-4"><a href="in-class-assignments.html#cb211-4" tabindex="-1"></a></span>
<span id="cb211-5"><a href="in-class-assignments.html#cb211-5" tabindex="-1"></a><span class="co"># The function returns: the value of chi-square test statistic (&quot;X-squared&quot;) and a a p-value.</span></span>
<span id="cb211-6"><a href="in-class-assignments.html#cb211-6" tabindex="-1"></a><span class="co"># What do we conclude?</span></span></code></pre></div>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="in-class-assignments.html#cb212-1" tabindex="-1"></a>tulip <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">81</span>, <span class="dv">50</span>, <span class="dv">27</span>)</span>
<span id="cb212-2"><a href="in-class-assignments.html#cb212-2" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(tulip, <span class="at">p =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>))</span>
<span id="cb212-3"><a href="in-class-assignments.html#cb212-3" tabindex="-1"></a>res</span>
<span id="cb212-4"><a href="in-class-assignments.html#cb212-4" tabindex="-1"></a></span>
<span id="cb212-5"><a href="in-class-assignments.html#cb212-5" tabindex="-1"></a><span class="co"># The function returns: the value of chi-square test statistic (&quot;X-squared&quot;) and a a p-value.</span></span>
<span id="cb212-6"><a href="in-class-assignments.html#cb212-6" tabindex="-1"></a><span class="co"># What do we conclude? Perform these tests by hand, can you see how the values are derived?</span></span></code></pre></div>
</div>
<div id="chi-squared-distribution" class="section level3 hasAnchor" number="22.18.8">
<h3><span class="header-section-number">22.18.8</span> Chi-squared Distribution<a href="in-class-assignments.html#chi-squared-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here is a graph of the Chi-Squared distribution 7 degrees of freedom.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="in-class-assignments.html#cb213-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">30</span>), <span class="fu">dchisq</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">30</span>), <span class="at">df =</span> <span class="dv">7</span>), <span class="at">type =</span> <span class="st">&#39;b&#39;</span>, <span class="at">xlab =</span> <span class="st">&quot;Probability&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;q&quot;</span>)</span></code></pre></div>
<p>Problem:
Find the 95th percentile of the Chi-Squared distribution with 7 degrees of freedom.</p>
<p>Solution:
We apply the quantile function qchisq of the Chi-Squared distribution against the decimal values 0.95.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="in-class-assignments.html#cb214-1" tabindex="-1"></a><span class="fu">qchisq</span>(<span class="fl">0.95</span>, <span class="at">df=</span><span class="dv">7</span>)</span></code></pre></div>
</div>
</div>
<div id="resampling-statistics" class="section level2 hasAnchor" number="22.19">
<h2><span class="header-section-number">22.19</span> Resampling Statistics<a href="in-class-assignments.html#resampling-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="instructors-note" class="section level3 hasAnchor" number="22.19.1">
<h3><span class="header-section-number">22.19.1</span> Instructor’s note<a href="in-class-assignments.html#instructors-note" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Many statistical methods, other than the classical ones presented by Zar and others that rely on the characteristics of the t-, Z-, F-, and normal distributions are not able to “handle” some statistical approaches including the non-parameteric ones presented below. Becasue R is a tool that not everyone is interested in using, and frankly I don’t know how to do these tests without some programming language, please use your class time to your benefit. If you are not interested in using R, then I suggest to 1.) Refine your project ideas and objectives, 2.) review the chapter on transformations in Zar and Fields et al., and 3.) Spend some time reviewing the statistical approaches that you would like to use in your own work.</p>
</div>
<div id="why-are-we-interested-in-using-resampling-techniques" class="section level3 hasAnchor" number="22.19.2">
<h3><span class="header-section-number">22.19.2</span> Why are we interested in using resampling techniques<a href="in-class-assignments.html#why-are-we-interested-in-using-resampling-techniques" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>1.) Resampling provides clear advantages when assumptions of traditional parametric tests are not met.</p>
<p>2.) Resampling methods can be used for testing means, medians, ratios, or other parameters are the same, so we do not need new methods for these different applications.</p>
<p>3.) Resampling has advantages of conceptual simplicity (but a bit of learning curve for computation)</p>
</div>
<div id="parametric-statistical-approaches-have-some-issues" class="section level3 hasAnchor" number="22.19.3">
<h3><span class="header-section-number">22.19.3</span> Parametric statistical approaches have some issues:<a href="in-class-assignments.html#parametric-statistical-approaches-have-some-issues" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>1.) Restrictive assumptions</p>
<p>2.) Tests can be difficult to interpret</p>
<p>3.) Recall that the <span class="math inline">\(p\)</span>-value is defined as the probability of getting data as extreme as the observed data when the null hypothesis is true.</p>
<p>4.) If the data are shuffled many times in accordance with the null hypothesis being true, the number of cases with data as extreme as the observed data can be counted, and a <span class="math inline">\(p\)</span>-value can be calculated.</p>
</div>
<div id="common-resampling-methods" class="section level3 hasAnchor" number="22.19.4">
<h3><span class="header-section-number">22.19.4</span> Common resampling methods<a href="in-class-assignments.html#common-resampling-methods" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Three resampling methods are commonly used for different purposes:</p>
<ol style="list-style-type: decimal">
<li><p>Permutation methods - use sampling without replacement to test hypotheses of “no effect”.</p></li>
<li><p>Bootstrap methods - use sampling with replacement to establish confidence intervals.</p></li>
<li><p>Monte Carlo methods - use repeated sampling from populations with known characteristics.</p></li>
</ol>
</div>
<div id="permutation-methods" class="section level3 hasAnchor" number="22.19.5">
<h3><span class="header-section-number">22.19.5</span> 1. Permutation methods<a href="in-class-assignments.html#permutation-methods" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Approach to randomly redistribute the observations and calculate a statistic of interest. If we do this many times, say 1,000 times or 10,000 times, we generate a distribution of observed values for the statistic of interest under the null hypothesis of no difference between the two populations. We compare our observed statistic to the sampling distribution to determine how likely our observed statistic is. The benefit of this approach is that we can generate a sampling distribution for any parameter of interest and then determine the percentile of our observed parameter relative to those of the permutation samples.</p>
</div>
<div id="bootstrap-methods" class="section level3 hasAnchor" number="22.19.6">
<h3><span class="header-section-number">22.19.6</span> 2. Bootstrap methods<a href="in-class-assignments.html#bootstrap-methods" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Assuming we have some representative samples, we can sample, with replacement, to generate confidence intervals. We randomly sample with replacement from the observed scores to produce a new sample of the same size as our original sample. Now we can calculate the statistic of interest (e.g., median) from the new sample. With a large number of new samples, at least 10,000, we generate an empirical sampling distribution for the statistic of interest and we can determine upper and lower confidence limits for this statistic.</p>
</div>
<div id="monte-carlo-methods" class="section level3 hasAnchor" number="22.19.7">
<h3><span class="header-section-number">22.19.7</span> 3. Monte Carlo methods<a href="in-class-assignments.html#monte-carlo-methods" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With Monte Carlo techniques, we can specify several populations with known characteristics, and sample randomly from these distributions. With many replications, we generate sampling distributions for the statistics of interest. For example, we may be interested in the sensitivity of the t-test to violations of the assumption of equal variance or normality. We can generate populations that have specific characteristics, and then with multiple resampling we can generatesampling distributions for the statistics of interest.</p>
</div>
<div id="permutation-methods-in-practice" class="section level3 hasAnchor" number="22.19.8">
<h3><span class="header-section-number">22.19.8</span> Permutation methods in practice<a href="in-class-assignments.html#permutation-methods-in-practice" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A permutation test builds - rather than assumes - sampling distribution (called the “permutation distribution”) by resampling the observed data. Specifically, we can “shuffle” or permute the observed data (e.g., by assigning different outcome values to each observation from among the set of actually observed outcomes).</p>
<p>Permutation tests are particularly relevant in null hypothesis significance testing (NHST) approaches. In these situations, the permutation test represents our process of inference because our null hypothesis is that the two treatment groups do not impact the outcome. When we permute the outcome values we see all of the possible alternative treatment assignments we could have had. While a permutation test requires that we see all possible permutations of the data (which can become quite large), we can easily conduct “approximate permutation tests” by simply conducting a vary large number of resamples.</p>
</div>
<div id="a-simple-permutation-test" class="section level3 hasAnchor" number="22.19.9">
<h3><span class="header-section-number">22.19.9</span> A simple permutation test:<a href="in-class-assignments.html#a-simple-permutation-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We have randomly sampled the data from a log-normal distribution with equal mean and variance. We set the seed to ensure the results are repeatable. So in this case, we are looking to find there is no significant difference between the two populations.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="in-class-assignments.html#cb215-1" tabindex="-1"></a>diff.in.mean <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb215-2"><a href="in-class-assignments.html#cb215-2" tabindex="-1"></a>mean.pop<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb215-3"><a href="in-class-assignments.html#cb215-3" tabindex="-1"></a>mean.pop<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">abs</span>(mean.pop<span class="fl">.1</span> <span class="sc">-</span> diff.in.mean)</span>
<span id="cb215-4"><a href="in-class-assignments.html#cb215-4" tabindex="-1"></a></span>
<span id="cb215-5"><a href="in-class-assignments.html#cb215-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="at">seed =</span> <span class="dv">3</span>) </span>
<span id="cb215-6"><a href="in-class-assignments.html#cb215-6" tabindex="-1"></a><span class="co"># Run the code below, do you see what &quot;set.seed&quot; does to the random number generator?</span></span>
<span id="cb215-7"><a href="in-class-assignments.html#cb215-7" tabindex="-1"></a>pop<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">meanlog =</span> mean.pop<span class="fl">.1</span>, <span class="at">sdlog =</span> <span class="dv">2</span>)</span>
<span id="cb215-8"><a href="in-class-assignments.html#cb215-8" tabindex="-1"></a>pop<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">meanlog =</span> mean.pop<span class="fl">.2</span>, <span class="at">sdlog =</span> <span class="dv">2</span>)</span>
<span id="cb215-9"><a href="in-class-assignments.html#cb215-9" tabindex="-1"></a></span>
<span id="cb215-10"><a href="in-class-assignments.html#cb215-10" tabindex="-1"></a>pop<span class="fl">.1</span>[<span class="dv">1</span>]</span>
<span id="cb215-11"><a href="in-class-assignments.html#cb215-11" tabindex="-1"></a>pop<span class="fl">.2</span>[<span class="dv">1</span>]</span></code></pre></div>
<p>The classic statistical approach here would be to use a t-test. Let’s instead apply our random permutation test.
First, let’s compute the difference between the means of the two groups:</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="in-class-assignments.html#cb216-1" tabindex="-1"></a>obs.diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(pop<span class="fl">.1</span>) <span class="sc">-</span> <span class="fu">mean</span>(pop<span class="fl">.2</span>)</span></code></pre></div>
<p>What we want to do is randomly shuffle our data between the two groups. If we were to sample (without replacement) once and compute the difference using the randomly shuffled version of groups, we would have the difference in population means, but only one iteration</p>
<p>So, we will put this in a loop to get many values…</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="in-class-assignments.html#cb217-1" tabindex="-1"></a>perm.diff <span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb217-2"><a href="in-class-assignments.html#cb217-2" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>) {</span>
<span id="cb217-3"><a href="in-class-assignments.html#cb217-3" tabindex="-1"></a>  sample.ind <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="at">length.out =</span> <span class="fu">length</span>(<span class="fu">c</span>(pop<span class="fl">.1</span>, pop<span class="fl">.2</span>)))</span>
<span id="cb217-4"><a href="in-class-assignments.html#cb217-4" tabindex="-1"></a>  ind<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="at">length.out =</span> <span class="fu">length</span>(<span class="fu">c</span>(pop<span class="fl">.1</span>, pop<span class="fl">.2</span>))), </span>
<span id="cb217-5"><a href="in-class-assignments.html#cb217-5" tabindex="-1"></a>                  <span class="at">size =</span> <span class="fu">length</span>(pop<span class="fl">.1</span>), <span class="at">replace =</span> F)</span>
<span id="cb217-6"><a href="in-class-assignments.html#cb217-6" tabindex="-1"></a>  ind<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="sc">!</span>(sample.ind <span class="sc">%in%</span> ind<span class="fl">.1</span>))</span>
<span id="cb217-7"><a href="in-class-assignments.html#cb217-7" tabindex="-1"></a>  </span>
<span id="cb217-8"><a href="in-class-assignments.html#cb217-8" tabindex="-1"></a>  perm.diff[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(pop<span class="fl">.1</span>,pop<span class="fl">.2</span>)[ind<span class="fl">.1</span>]) <span class="sc">-</span> <span class="fu">mean</span>(<span class="fu">c</span>(pop<span class="fl">.1</span>,pop<span class="fl">.2</span>)[ind<span class="fl">.2</span>])</span>
<span id="cb217-9"><a href="in-class-assignments.html#cb217-9" tabindex="-1"></a>}</span></code></pre></div>
<p>If we plot the examples, along with where our observed difference falls:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="in-class-assignments.html#cb218-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb218-2"><a href="in-class-assignments.html#cb218-2" tabindex="-1"></a><span class="fu">hist</span>(pop<span class="fl">.1</span>, <span class="dv">100</span>, <span class="at">main =</span> <span class="st">&quot;Histogram of population 1&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))</span>
<span id="cb218-3"><a href="in-class-assignments.html#cb218-3" tabindex="-1"></a><span class="fu">hist</span>(pop<span class="fl">.2</span>, <span class="dv">100</span>, <span class="at">main =</span> <span class="st">&quot;Histogram of population 2&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))</span>
<span id="cb218-4"><a href="in-class-assignments.html#cb218-4" tabindex="-1"></a><span class="fu">hist</span>(perm.diff,<span class="dv">100</span>, <span class="at">main =</span> <span class="st">&quot;Histogram of perumuted differences in population means&quot;</span>)</span>
<span id="cb218-5"><a href="in-class-assignments.html#cb218-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> obs.diff, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb218-6"><a href="in-class-assignments.html#cb218-6" tabindex="-1"></a>perm.p <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">sort</span>(perm.diff) <span class="sc">&gt;</span> obs.diff)[<span class="dv">1</span>]<span class="sc">/</span><span class="dv">10000</span></span></code></pre></div>
<p>How does this result compare to using a parametric and alternative non-parametric test to test the equality of means of the two populations?</p>
<p>Discuss and understand how the number of iterations you specify in the simulation impacts your assessment of the precision of your estimate.</p>
</div>
<div id="a-simple-bootstrap-example" class="section level3 hasAnchor" number="22.19.10">
<h3><span class="header-section-number">22.19.10</span> A simple bootstrap example:<a href="in-class-assignments.html#a-simple-bootstrap-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here, we will estimate the size of the confidence interval by applying the bootstrap and sampling many samples with replacement from the original sample, each the same size as the original sample, computing a point estimate for each, and finding the CI of this distribution of bootstrap statistics.</p>
<p>To construct the confidence interval we need to find the point estimate (sample mean) from the original sample.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="in-class-assignments.html#cb219-1" tabindex="-1"></a>mean.pop<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb219-2"><a href="in-class-assignments.html#cb219-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="at">seed =</span> <span class="dv">3</span>) </span>
<span id="cb219-3"><a href="in-class-assignments.html#cb219-3" tabindex="-1"></a>pop<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">meanlog =</span> mean.pop<span class="fl">.1</span>, <span class="at">sdlog =</span> <span class="dv">2</span>)</span>
<span id="cb219-4"><a href="in-class-assignments.html#cb219-4" tabindex="-1"></a>m.pop<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">mean</span>(pop<span class="fl">.1</span>)</span></code></pre></div>
<p>To find the standard error, we will create a large vector to store all of the samples. Note, here we are sampling with replacement.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="in-class-assignments.html#cb220-1" tabindex="-1"></a>boot.samp <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb220-2"><a href="in-class-assignments.html#cb220-2" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb220-3"><a href="in-class-assignments.html#cb220-3" tabindex="-1"></a>  boot.samp[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sample</span>(pop<span class="fl">.1</span>, <span class="at">size =</span> <span class="fu">length</span>(pop<span class="fl">.1</span>), <span class="at">replace =</span> T))</span>
<span id="cb220-4"><a href="in-class-assignments.html#cb220-4" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we plot the distribution of sample means and determine the 95% CI.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="in-class-assignments.html#cb221-1" tabindex="-1"></a><span class="fu">hist</span>(boot.samp, <span class="dv">100</span>)</span>
<span id="cb221-2"><a href="in-class-assignments.html#cb221-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">sort</span>(boot.samp)[<span class="fu">c</span>(<span class="dv">25</span>,<span class="dv">975</span>)], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb221-3"><a href="in-class-assignments.html#cb221-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> m.pop<span class="fl">.1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>We are 95% confident that the mean of the population is in the interval from 6.4 to 12.2.</p>
<p>How do these 95% CI estimates compare to those derived using the <span class="math inline">\(t\)</span>-distribution?</p>
</div>
<div id="using-the-boot-package-to-bootstrap-95-ci-for-r-squared" class="section level3 hasAnchor" number="22.19.11">
<h3><span class="header-section-number">22.19.11</span> Using the “boot” package to Bootstrap 95% CI for R-Squared<a href="in-class-assignments.html#using-the-boot-package-to-bootstrap-95-ci-for-r-squared" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="in-class-assignments.html#cb222-1" tabindex="-1"></a><span class="fu">require</span>(boot)</span>
<span id="cb222-2"><a href="in-class-assignments.html#cb222-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb222-3"><a href="in-class-assignments.html#cb222-3" tabindex="-1"></a></span>
<span id="cb222-4"><a href="in-class-assignments.html#cb222-4" tabindex="-1"></a><span class="co"># function to obtain R-Squared from the data </span></span>
<span id="cb222-5"><a href="in-class-assignments.html#cb222-5" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(formula, data, indices) {</span>
<span id="cb222-6"><a href="in-class-assignments.html#cb222-6" tabindex="-1"></a>  d <span class="ot">&lt;-</span> data[indices,] <span class="co"># allows boot to select sample </span></span>
<span id="cb222-7"><a href="in-class-assignments.html#cb222-7" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula, <span class="at">data=</span>d)</span>
<span id="cb222-8"><a href="in-class-assignments.html#cb222-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">summary</span>(fit)<span class="sc">$</span>r.square)  } </span>
<span id="cb222-9"><a href="in-class-assignments.html#cb222-9" tabindex="-1"></a></span>
<span id="cb222-10"><a href="in-class-assignments.html#cb222-10" tabindex="-1"></a><span class="co"># bootstrapping with 1000 replications </span></span>
<span id="cb222-11"><a href="in-class-assignments.html#cb222-11" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>mtcars, <span class="at">statistic=</span>rsq, <span class="at">R=</span><span class="dv">1000</span>, <span class="at">formula=</span>mpg<span class="sc">~</span>wt<span class="sc">+</span>disp)</span>
<span id="cb222-12"><a href="in-class-assignments.html#cb222-12" tabindex="-1"></a></span>
<span id="cb222-13"><a href="in-class-assignments.html#cb222-13" tabindex="-1"></a><span class="co"># view results</span></span>
<span id="cb222-14"><a href="in-class-assignments.html#cb222-14" tabindex="-1"></a>results</span>
<span id="cb222-15"><a href="in-class-assignments.html#cb222-15" tabindex="-1"></a><span class="fu">class</span>(results)</span>
<span id="cb222-16"><a href="in-class-assignments.html#cb222-16" tabindex="-1"></a></span>
<span id="cb222-17"><a href="in-class-assignments.html#cb222-17" tabindex="-1"></a><span class="co"># get 95% confidence interval </span></span>
<span id="cb222-18"><a href="in-class-assignments.html#cb222-18" tabindex="-1"></a><span class="fu">boot.ci</span>(results, <span class="at">type=</span><span class="st">&quot;bca&quot;</span>)</span></code></pre></div>
<p>Why do we choose type “bca”, how do these compare to the other varieties of CI?</p>
</div>
<div id="challenge" class="section level3 hasAnchor" number="22.19.12">
<h3><span class="header-section-number">22.19.12</span> Challenge:<a href="in-class-assignments.html#challenge" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Write a script that will bootstrap the residuals values, such that given the linear model we can get the bootstrapped confidence intervals of the intercept and slope:</p>
<p><span class="math inline">\(y_{ij} = \alpha+\beta\times{x_i} + \epsilon_{ij}\)</span>.</p>
<p><span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are the unknown intercept and slope and <span class="math inline">\(\epsilon_{ij}\)</span> are normally distributed errors.</p>
<p>The residuals from the least squares fit are given by:</p>
<p><span class="math inline">\(\epsilon_{ij} =y_{ij} - \alpha+\beta\times{x_i}\)</span>.</p>
<p>Steps:</p>
<p>1.) Bootstrap the residuals</p>
<p>2.) Produce a vector of <span class="math inline">\(\epsilon_{ij}^{*}\)</span> by taking random draws, with replacement.</p>
<p>3.) <span class="math inline">\(y_{ij}^* = y_{ij} + \epsilon_{ij}^{*}\)</span>.</p>
<p>4.) Determine mean <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> based on <span class="math inline">\(y_{ij}^*\)</span></p>
<p>5.) Repeat steps 1 to 4, <span class="math inline">\(n\)</span> = 1,000 times.</p>
</div>
<div id="finally-lets-take-a-look-at-doing-a-monte-carlo-simulation" class="section level3 hasAnchor" number="22.19.13">
<h3><span class="header-section-number">22.19.13</span> Finally, lets take a look at doing a Monte Carlo simulation:<a href="in-class-assignments.html#finally-lets-take-a-look-at-doing-a-monte-carlo-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Monte Carlo method is a way to solve problems through simulation. In this case, we will used it to calculate the number <span class="math inline">\(\pi\)</span>. You could approximate <span class="math inline">\(\pi\)</span> by simulation.</p>
<p>The surface area of a quarter of a circle inscribe in [0,1] <span class="math inline">\(\times\)</span> [0,1] is <span class="math inline">\(\pi/4\)</span>.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="in-class-assignments.html#cb223-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span>, <span class="at">type =</span> <span class="st">&#39;n&#39;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb223-2"><a href="in-class-assignments.html#cb223-2" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb223-3"><a href="in-class-assignments.html#cb223-3" tabindex="-1"></a></span>
<span id="cb223-4"><a href="in-class-assignments.html#cb223-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb223-5"><a href="in-class-assignments.html#cb223-5" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb223-6"><a href="in-class-assignments.html#cb223-6" tabindex="-1"></a><span class="fu">lines</span>(x,y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-263-1.png" width="672" /></p>
<ol style="list-style-type: decimal">
<li>Let’s generate a great many points uniformly distributed in the square [0, 1] ? [0, 1].</li>
</ol>
<p>Reminder, that the equation for a circle is <span class="math inline">\(x^2 + y^2 = r^2\)</span></p>
<ol start="2" style="list-style-type: decimal">
<li>Compute the proportion of those falling inside the quarter circle, that should be approximately the proportion
of areas of the quarter circle and the inscribing square.</li>
<li>Clever right?!</li>
</ol>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="in-class-assignments.html#cb224-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb224-2"><a href="in-class-assignments.html#cb224-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb224-3"><a href="in-class-assignments.html#cb224-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb224-4"><a href="in-class-assignments.html#cb224-4" tabindex="-1"></a></span>
<span id="cb224-5"><a href="in-class-assignments.html#cb224-5" tabindex="-1"></a>Inside <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb224-6"><a href="in-class-assignments.html#cb224-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb224-7"><a href="in-class-assignments.html#cb224-7" tabindex="-1"></a>  <span class="cf">if</span> (x[i]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y[i]<span class="sc">^</span><span class="dv">2</span> <span class="sc">&lt;</span> <span class="dv">1</span>) {</span>
<span id="cb224-8"><a href="in-class-assignments.html#cb224-8" tabindex="-1"></a>    Inside <span class="ot">&lt;-</span> Inside <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb224-9"><a href="in-class-assignments.html#cb224-9" tabindex="-1"></a>    <span class="fu">points</span>(x[i],y[i], <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb224-10"><a href="in-class-assignments.html#cb224-10" tabindex="-1"></a>  }</span>
<span id="cb224-11"><a href="in-class-assignments.html#cb224-11" tabindex="-1"></a>    <span class="cf">if</span> (x[i]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y[i]<span class="sc">^</span><span class="dv">2</span> <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb224-12"><a href="in-class-assignments.html#cb224-12" tabindex="-1"></a>    <span class="fu">points</span>(x[i],y[i], <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb224-13"><a href="in-class-assignments.html#cb224-13" tabindex="-1"></a>  }</span>
<span id="cb224-14"><a href="in-class-assignments.html#cb224-14" tabindex="-1"></a>}</span></code></pre></div>
<p>Now determine the proportion of points inside vs. outside of the circle…</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="in-class-assignments.html#cb225-1" tabindex="-1"></a>poportion.in <span class="ot">&lt;-</span> Inside<span class="sc">/</span>N</span></code></pre></div>
</div>
<div id="challenge-1" class="section level3 hasAnchor" number="22.19.14">
<h3><span class="header-section-number">22.19.14</span> Challenge:<a href="in-class-assignments.html#challenge-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Compute the probability under the <span class="math inline">\(N(0,1)\)</span> distribution of a certain interval.</p>
<p>So, we want to obtain the approximate integral of such function over the interval [0, 1] using simulation, so, instead of using the equation for the circle we will use:</p>
<p><span class="math inline">\(f(x) = \frac{1}{2\pi}e^{\frac{-x^2}{2}}\)</span>.</p>
<p>How does the equation above compare to what you know about the form of the normal distribution?</p>
<p>How can we check our work?</p>
</div>
</div>
<div id="permutation-of-the-slope" class="section level2 hasAnchor" number="22.20">
<h2><span class="header-section-number">22.20</span> Permutation of the Slope<a href="in-class-assignments.html#permutation-of-the-slope" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="we-will-examine-the-nonparametric-approach-to-a-test-of-the-slope-of-a-regression-line." class="section level3 hasAnchor" number="22.20.1">
<h3><span class="header-section-number">22.20.1</span> We will examine the nonparametric approach to a test of the slope of a regression line.<a href="in-class-assignments.html#we-will-examine-the-nonparametric-approach-to-a-test-of-the-slope-of-a-regression-line." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>From 1969 - 1972, the United States Selective Service conducted draft lotteries to determine the order of call for induction into the armed forces. For this lottery, 366 blue plastic capsules containing birth days (January 1 - December 31) were placed in a large glass container. Capsules were then drawn by hand to assign order-of-call numbers to all eligible men as specified by Selective Service law.</p>
<p>For this lab, you will be investigating whether the lotteries conducted in 1970 and 1971 were fair.</p>
<p>The 1970 lottery applied to men born in 1951. The 1971 lottery applied to men born in 1952.</p>
<p>The file draft70.csv contains sequential birthday number (1=Jan1, 2=Jan2, etc) and order-of-call number for each of the 366 possible birthdays selected in 1970. The file draft71.csv contains this same information for the birthdays selected in 1971.</p>
</div>
<div id="linear-regression-approach" class="section level3 hasAnchor" number="22.20.2">
<h3><span class="header-section-number">22.20.2</span> Linear regression approach<a href="in-class-assignments.html#linear-regression-approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In order to determine whether these lotteries were fair, we are going to fit a regression line with the goal of predicting order-of-call number from sequential birthday number. That is, we are going to fit the model:</p>
<p><span class="math inline">\(y = \beta_0+\beta_1x + \epsilon\)</span>,</p>
<p>where <span class="math inline">\(x\)</span> is the sequential birthday number and <span class="math inline">\(y\)</span> is the order-of-call number for that birthday. We will begin by examining the data from the 1970 draft lottery, so load draft70.csv into R.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="in-class-assignments.html#cb226-1" tabindex="-1"></a>draft.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">file.choose</span>())</span></code></pre></div>
<p>Examine the data, what order-of-call number was assigned to your birthday?</p>
<p>In a fair, random lottery, what should be the value of <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_0\)</span>? Use this answer to state appropriate null and alternative hypotheses in terms of ??1.</p>
<p>To test the hypotheses you listed above, you will fit the regression model (using R or any program you choose).</p>
<p>Make a plot of order-of-call number versus sequential birthday number. Does this plot appear to provide evidence against your null hypothesis?</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="in-class-assignments.html#cb227-1" tabindex="-1"></a><span class="fu">plot</span>(callorder <span class="sc">~</span> birthday, <span class="at">data =</span> draft.data, </span>
<span id="cb227-2"><a href="in-class-assignments.html#cb227-2" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Day of Birth&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Call Order&quot;</span>)</span></code></pre></div>
<p>Fit the linear regression model for predicting order-of-call from sequential birthday number. Report the estimated slope of the regression line. Comment on how this compares to your null hypothesis.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="in-class-assignments.html#cb228-1" tabindex="-1"></a>mod.obj <span class="ot">&lt;-</span> <span class="fu">lm</span>(callorder <span class="sc">~</span> birthday, <span class="at">data =</span> draft.data)</span>
<span id="cb228-2"><a href="in-class-assignments.html#cb228-2" tabindex="-1"></a><span class="fu">summary</span>(mod.obj)</span></code></pre></div>
<p>Report your test statistic and p-value. State a conclusion in context based on this <span class="math inline">\(p\)</span>-value.</p>
<p>One of the assumptions necessary for this test statistic distribution is that the residuals must have a normal distribution. The residuals are the difference between the actual y-value and the predicted <span class="math inline">\(y\)</span>-value. If this assumption is violated, the stated <span class="math inline">\(t\)</span>-distribution is not valid. We can check this assumption by making a histogram of the residuals and checking whether they appear to be normally distributed.</p>
<p>Make a histogram of the residuals. Do these residuals appear to be normally distributed?</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="in-class-assignments.html#cb229-1" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">residuals</span>(mod.obj))</span></code></pre></div>
<p>Is the assumption of normality violated? If so, your previously stated p-value is not correct.</p>
<p>An alternative, we must approach this problem using nonparametric tools. We can still work with the slope of the regression line, but we will perform a permutation test to determine whether we have sufficient evidence that the slope if different from zero.</p>
</div>
<div id="permutation-test-of-slope" class="section level3 hasAnchor" number="22.20.3">
<h3><span class="header-section-number">22.20.3</span> Permutation test of slope<a href="in-class-assignments.html#permutation-test-of-slope" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This permutation test will work as follows. We will estimate the slope from our observed data. Then we will shuffle the y-values (the order-of-call numbers) between the x-values (the birthday numbers) and re-estimate the slope. We will repeat this shuffling process a total of 1000 times to get an estimate of the permutation distribution for the slope. The idea is that if the slope truly is zero, then x has no effect on y, so each y could be paired with any of the x-values!</p>
<p>The following code runs a permutation test on the slope of the regression line:</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="in-class-assignments.html#cb230-1" tabindex="-1"></a>x <span class="ot">=</span> draft.data<span class="sc">$</span>birthday; y <span class="ot">=</span> draft.data<span class="sc">$</span>callorder</span>
<span id="cb230-2"><a href="in-class-assignments.html#cb230-2" tabindex="-1"></a></span>
<span id="cb230-3"><a href="in-class-assignments.html#cb230-3" tabindex="-1"></a><span class="co"># estimate the slope for the observed data </span></span>
<span id="cb230-4"><a href="in-class-assignments.html#cb230-4" tabindex="-1"></a>draft.lm <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb230-5"><a href="in-class-assignments.html#cb230-5" tabindex="-1"></a>teststat.obs <span class="ot">=</span> draft.lm<span class="sc">$</span>coeff[<span class="dv">2</span>]</span>
<span id="cb230-6"><a href="in-class-assignments.html#cb230-6" tabindex="-1"></a></span>
<span id="cb230-7"><a href="in-class-assignments.html#cb230-7" tabindex="-1"></a>teststat <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">1000</span>) </span>
<span id="cb230-8"><a href="in-class-assignments.html#cb230-8" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb230-9"><a href="in-class-assignments.html#cb230-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb230-10"><a href="in-class-assignments.html#cb230-10" tabindex="-1"></a></span>
<span id="cb230-11"><a href="in-class-assignments.html#cb230-11" tabindex="-1"></a><span class="co"># randomly &quot;shuffle&quot; the y-values for different x-values </span></span>
<span id="cb230-12"><a href="in-class-assignments.html#cb230-12" tabindex="-1"></a>ySHUFFLE <span class="ot">=</span> <span class="fu">sample</span>(y)</span>
<span id="cb230-13"><a href="in-class-assignments.html#cb230-13" tabindex="-1"></a></span>
<span id="cb230-14"><a href="in-class-assignments.html#cb230-14" tabindex="-1"></a><span class="co"># compute the F-statistic for the shuffled data </span></span>
<span id="cb230-15"><a href="in-class-assignments.html#cb230-15" tabindex="-1"></a>SHUFFLE.lm <span class="ot">=</span> <span class="fu">lm</span>(ySHUFFLE <span class="sc">~</span> x)</span>
<span id="cb230-16"><a href="in-class-assignments.html#cb230-16" tabindex="-1"></a>teststat[i] <span class="ot">=</span> SHUFFLE.lm<span class="sc">$</span>coeff[<span class="dv">2</span>]  }</span>
<span id="cb230-17"><a href="in-class-assignments.html#cb230-17" tabindex="-1"></a></span>
<span id="cb230-18"><a href="in-class-assignments.html#cb230-18" tabindex="-1"></a><span class="co"># Create histogram</span></span>
<span id="cb230-19"><a href="in-class-assignments.html#cb230-19" tabindex="-1"></a><span class="fu">hist</span>(teststat,<span class="dv">100</span>, <span class="at">main =</span> <span class="st">&quot;Permutation Distribution of Slopes&quot;</span>)</span>
<span id="cb230-20"><a href="in-class-assignments.html#cb230-20" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> teststat.obs, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb230-21"><a href="in-class-assignments.html#cb230-21" tabindex="-1"></a></span>
<span id="cb230-22"><a href="in-class-assignments.html#cb230-22" tabindex="-1"></a>alpha.val <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb230-23"><a href="in-class-assignments.html#cb230-23" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">c</span>(alpha.val<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span> <span class="sc">-</span> alpha.val<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb230-24"><a href="in-class-assignments.html#cb230-24" tabindex="-1"></a>CI.ind <span class="ot">&lt;-</span> <span class="fu">round</span>(CI<span class="sc">*</span>n)</span>
<span id="cb230-25"><a href="in-class-assignments.html#cb230-25" tabindex="-1"></a>CI.ind <span class="ot">&lt;-</span> <span class="fu">sort</span>(teststat)[CI.ind]</span>
<span id="cb230-26"><a href="in-class-assignments.html#cb230-26" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> CI.ind, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p>State a conclusion (in context) about the result of this permutation test.</p>
<p>Now you are going to repeat this process using the draft lottery data from 1971.</p>
<p>Because the columns of data have the same names as the 1970 data set, be sure to clear your workspace.</p>
<p>Use a permutation test to determine whether there is a relationship between order-of-call and birthday order in the 1971 draft. Define your parameter of interest, state appropriate hypotheses, and report your test statistic and p-value. Finally, state a conclusion (in context) about the result of your test.</p>
</div>
</div>
<div id="multimodel-analysis-and-selection" class="section level2 hasAnchor" number="22.21">
<h2><span class="header-section-number">22.21</span> Multimodel Analysis and Selection<a href="in-class-assignments.html#multimodel-analysis-and-selection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this lab we will evaluate the role of AIC to help us understand how this index can assist in model selection and model averaging. We will use the mtcars data included in R base.</p>
<ol style="list-style-type: decimal">
<li>Inspect the data using R functionality, describe its structure, ranges, relationships…</li>
</ol>
<p>We are interested in building linear models that have independent variables that can predict the mpg of a car.</p>
<p>2a.
Using your knowledge and the data - what do you think is the “best” model? What makes it so - your answer should involve quantitative work and explananation of model output.</p>
<div id="preliminary-model-evalation" class="section level3 hasAnchor" number="22.21.1">
<h3><span class="header-section-number">22.21.1</span> Preliminary Model Evalation<a href="in-class-assignments.html#preliminary-model-evalation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="in-class-assignments.html#cb231-1" tabindex="-1"></a>lm.cand<span class="fl">.01</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> cyl, <span class="at">data =</span> mtcars)</span>
<span id="cb231-2"><a href="in-class-assignments.html#cb231-2" tabindex="-1"></a><span class="fu">summary</span>(lm.cand<span class="fl">.01</span>)</span>
<span id="cb231-3"><a href="in-class-assignments.html#cb231-3" tabindex="-1"></a></span>
<span id="cb231-4"><a href="in-class-assignments.html#cb231-4" tabindex="-1"></a>lm.cand<span class="fl">.02</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> cyl <span class="sc">+</span> drat, <span class="at">data =</span> mtcars)</span>
<span id="cb231-5"><a href="in-class-assignments.html#cb231-5" tabindex="-1"></a><span class="fu">summary</span>(lm.cand<span class="fl">.02</span>)</span>
<span id="cb231-6"><a href="in-class-assignments.html#cb231-6" tabindex="-1"></a></span>
<span id="cb231-7"><a href="in-class-assignments.html#cb231-7" tabindex="-1"></a><span class="co"># Some tricks in lm</span></span>
<span id="cb231-8"><a href="in-class-assignments.html#cb231-8" tabindex="-1"></a><span class="fu">lm</span>(mpg <span class="sc">~</span> ., <span class="at">data =</span> mtcars)</span>
<span id="cb231-9"><a href="in-class-assignments.html#cb231-9" tabindex="-1"></a><span class="fu">lm</span>(mpg <span class="sc">~</span> gear <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> mtcars)</span></code></pre></div>
<p>Your answer to #2a may have (should have) involved evaluating some candidate models output and input.</p>
<p>2b.
In the above box I give some more “lm” functionality using “.” and “-1”. What does this code do? Likely you will need to examine the model output in detail to make an informed answer. This question is for those interested in R programming only! Skip if that does not apply to you!</p>
<ol start="3" style="list-style-type: decimal">
<li>How many possible models can you derive from these data to predict the mpg? The short answer is “many”. However, not all of these will be of interst. Derive some of these (i.e. create some linear models) and report the associated Pearson-product moment correlation coefficient) and plot the effect of adding predictors on the <span class="math inline">\(R^2\)</span> value.</li>
</ol>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="in-class-assignments.html#cb232-1" tabindex="-1"></a>r.sq.vect <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb232-2"><a href="in-class-assignments.html#cb232-2" tabindex="-1"></a>num.pred.vect <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb232-3"><a href="in-class-assignments.html#cb232-3" tabindex="-1"></a>r.sq.vect[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">summary</span>(lm.cand<span class="fl">.01</span>)<span class="sc">$</span>r.squared</span>
<span id="cb232-4"><a href="in-class-assignments.html#cb232-4" tabindex="-1"></a>r.sq.vect[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">summary</span>(lm.cand<span class="fl">.02</span>)<span class="sc">$</span>r.squared</span>
<span id="cb232-5"><a href="in-class-assignments.html#cb232-5" tabindex="-1"></a><span class="co"># Specify more linear models and determine the associated r.squared:</span></span>
<span id="cb232-6"><a href="in-class-assignments.html#cb232-6" tabindex="-1"></a><span class="co"># ...r.sq.vect[3] &lt;- summary(lm.cand.03)$r.squared... now run some more</span></span>
<span id="cb232-7"><a href="in-class-assignments.html#cb232-7" tabindex="-1"></a></span>
<span id="cb232-8"><a href="in-class-assignments.html#cb232-8" tabindex="-1"></a><span class="co"># For each of the models, also determine the number of estimated parameters.</span></span>
<span id="cb232-9"><a href="in-class-assignments.html#cb232-9" tabindex="-1"></a>num.pred.vect[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(lm.cand<span class="fl">.01</span><span class="sc">$</span>coef)</span>
<span id="cb232-10"><a href="in-class-assignments.html#cb232-10" tabindex="-1"></a>num.pred.vect[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(lm.cand<span class="fl">.02</span><span class="sc">$</span>coef)</span>
<span id="cb232-11"><a href="in-class-assignments.html#cb232-11" tabindex="-1"></a><span class="co"># ...num.pred.vect[3] &lt;- length(lm.cand.03$coef)... now run some more</span></span>
<span id="cb232-12"><a href="in-class-assignments.html#cb232-12" tabindex="-1"></a></span>
<span id="cb232-13"><a href="in-class-assignments.html#cb232-13" tabindex="-1"></a><span class="co"># Finally, plot and understand the relationship of the r.squared value and the associated number of parameters:</span></span>
<span id="cb232-14"><a href="in-class-assignments.html#cb232-14" tabindex="-1"></a><span class="co"># plot(x = num.pred.vect, y = r.sq.vect)</span></span></code></pre></div>
</div>
<div id="aic-in-r" class="section level3 hasAnchor" number="22.21.2">
<h3><span class="header-section-number">22.21.2</span> AIC in R<a href="in-class-assignments.html#aic-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lets use some built-in R functionality to evaluate AIC. Use the code below as a guide for you to evaluate the AIC value of each of the candidtate model you derived above.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="in-class-assignments.html#cb233-1" tabindex="-1"></a>AIC.vect <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb233-2"><a href="in-class-assignments.html#cb233-2" tabindex="-1"></a>AIC.vect[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">AIC</span>(lm.cand<span class="fl">.01</span>)</span>
<span id="cb233-3"><a href="in-class-assignments.html#cb233-3" tabindex="-1"></a>AIC.vect[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">AIC</span>(lm.cand<span class="fl">.02</span>)</span>
<span id="cb233-4"><a href="in-class-assignments.html#cb233-4" tabindex="-1"></a><span class="co"># Determine values of AIC.vect for the lm.cand models you made above.</span></span>
<span id="cb233-5"><a href="in-class-assignments.html#cb233-5" tabindex="-1"></a><span class="co"># Calculate the AIC value of the candidate models you derived in #3 </span></span>
<span id="cb233-6"><a href="in-class-assignments.html#cb233-6" tabindex="-1"></a><span class="co"># and plot the AIC values as a function of the number of coefficient values:</span></span>
<span id="cb233-7"><a href="in-class-assignments.html#cb233-7" tabindex="-1"></a></span>
<span id="cb233-8"><a href="in-class-assignments.html#cb233-8" tabindex="-1"></a><span class="co"># plot(x = num.pred.vect, y = AIC.vect)</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Make a table:</li>
</ol>
<p>Column 1. the model formulation, “mpg ~ wt + qsec + am” (for example),</p>
<p>Column 2. AIC value,</p>
<p>Column 3. Delta AIC,</p>
<p>Column 4. Relative model weight,</p>
<p>Column 5. Provide the number of predictors used in the model</p>
<ol start="5" style="list-style-type: decimal">
<li>Identify four candidate models that have at least on predictor in common and derive the weighted (using the weights from #4) predicted value of Y-hat with respect to the common variable.</li>
</ol>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="in-class-assignments.html#cb234-1" tabindex="-1"></a><span class="co"># Determine length of predicted output</span></span>
<span id="cb234-2"><a href="in-class-assignments.html#cb234-2" tabindex="-1"></a>num.pred. <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">predict</span>(lm.cand<span class="fl">.01</span>))</span>
<span id="cb234-3"><a href="in-class-assignments.html#cb234-3" tabindex="-1"></a></span>
<span id="cb234-4"><a href="in-class-assignments.html#cb234-4" tabindex="-1"></a><span class="co"># Initialize a matrix to hold the values - you will fill this matrix with predictors</span></span>
<span id="cb234-5"><a href="in-class-assignments.html#cb234-5" tabindex="-1"></a>predict.mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> num.pred., <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb234-6"><a href="in-class-assignments.html#cb234-6" tabindex="-1"></a></span>
<span id="cb234-7"><a href="in-class-assignments.html#cb234-7" tabindex="-1"></a><span class="co"># Populate the model with predicted values</span></span>
<span id="cb234-8"><a href="in-class-assignments.html#cb234-8" tabindex="-1"></a>predict.mat[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm.cand<span class="fl">.01</span>)</span>
<span id="cb234-9"><a href="in-class-assignments.html#cb234-9" tabindex="-1"></a>predict.mat[,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm.cand<span class="fl">.02</span>)</span>
<span id="cb234-10"><a href="in-class-assignments.html#cb234-10" tabindex="-1"></a><span class="co">#... predict.mat[,3]</span></span>
<span id="cb234-11"><a href="in-class-assignments.html#cb234-11" tabindex="-1"></a><span class="co">#... predict.mat[,4]</span></span>
<span id="cb234-12"><a href="in-class-assignments.html#cb234-12" tabindex="-1"></a></span>
<span id="cb234-13"><a href="in-class-assignments.html#cb234-13" tabindex="-1"></a><span class="co"># Use the model weights you derived in #4. Put them in a vector</span></span>
<span id="cb234-14"><a href="in-class-assignments.html#cb234-14" tabindex="-1"></a>mod.wt <span class="ot">&lt;-</span> <span class="fu">c</span>(wt.cand.mod<span class="fl">.01</span>, wt.cand.mod<span class="fl">.02</span>, wt.cand.mod<span class="fl">.03</span>, wt.cand.mod<span class="fl">.04</span>)</span>
<span id="cb234-15"><a href="in-class-assignments.html#cb234-15" tabindex="-1"></a></span>
<span id="cb234-16"><a href="in-class-assignments.html#cb234-16" tabindex="-1"></a>predict.mat[,<span class="dv">1</span>] <span class="ot">&lt;-</span> wt.cand.mod<span class="fl">.01</span>[<span class="dv">1</span>]<span class="sc">*</span>predict.mat[,<span class="dv">1</span>]</span>
<span id="cb234-17"><a href="in-class-assignments.html#cb234-17" tabindex="-1"></a>pred.vect <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(predict.mat)</span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>We will use the “step” function in base R, package “stats”. The R function step() can be used to perform variable selection. To perform selection we need to begin by specifying a starting model and the range of models which we want to examine in the search. How does this approach compare to the one above - PS this selection approach is a bit controversial…</li>
</ol>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="in-class-assignments.html#cb235-1" tabindex="-1"></a>?stats<span class="sc">::</span>step</span>
<span id="cb235-2"><a href="in-class-assignments.html#cb235-2" tabindex="-1"></a><span class="co"># Use the function to evaluate this model:</span></span>
<span id="cb235-3"><a href="in-class-assignments.html#cb235-3" tabindex="-1"></a><span class="fu">step</span>(<span class="fu">lm</span>(mpg <span class="sc">~</span> ., <span class="at">data =</span> mtcars), <span class="at">direction =</span> <span class="st">&quot;both&quot;</span>, <span class="at">trace =</span> T)</span></code></pre></div>
</div>
</div>
<div id="multilevel-model" class="section level2 hasAnchor" number="22.22">
<h2><span class="header-section-number">22.22</span> Multilevel Model<a href="in-class-assignments.html#multilevel-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="instructors-note-1" class="section level3 hasAnchor" number="22.22.1">
<h3><span class="header-section-number">22.22.1</span> Instructor’s note<a href="in-class-assignments.html#instructors-note-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Multilevel models, like many statistical methods, require programming. Becasue R is a tool that not everyone is interested in using, you will need to decide if this is an aspect of statistical analysis that will benefit you. If you are not interested in working on this module, then I suggest that you 1.) Refine your project ideas and objectives, 2.) review the chapter on regression in Zar and Fields et al., and 3.) Spend some time reviewing the statistical approaches that you would like to use in your own work.</p>
</div>
<div id="the-signature-component-of-multilevel-modeling" class="section level3 hasAnchor" number="22.22.2">
<h3><span class="header-section-number">22.22.2</span> The signature component of Multilevel Modeling<a href="in-class-assignments.html#the-signature-component-of-multilevel-modeling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Multilevel models have at their heart, group level indicators, <span class="math inline">\(i\)</span>.</p>
<p>Alternative formulations with group level indicators:</p>
<p>Varying intercept model: <span class="math inline">\(y_{i} = \alpha_{j[i]}+\beta{x_i}+\epsilon_i\)</span></p>
<p>Varying slope model: <span class="math inline">\(y_{i} = \alpha+\beta_{j[i]}{x_i}+\epsilon_i\)</span></p>
<p>Varying intercept and slope model: <span class="math inline">\(y_{i} = \alpha_{j[i]}+\beta_{j[i]}{x_i}+\epsilon_i\)</span></p>
<p><img src="_main_files/figure-html/unnamed-chunk-276-1.png" width="672" /></p>
<p>1.) The first step in a multilevel model is to set up a regression model with varying coefficients.</p>
<p>2.) The second step in a multilevel model is to set up a regression model of the coefficents.</p>
</div>
<div id="group-level-predictor-models" class="section level3 hasAnchor" number="22.22.3">
<h3><span class="header-section-number">22.22.3</span> Group level predictor models:<a href="in-class-assignments.html#group-level-predictor-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Multilevel models can be considered in two different ways:</p>
<p>1.) Generalization of lineqar regression whtere intercepts and/or slopes are allowed to vary by group.</p>
<p>2.) Equivalently, we can think of multilevel modeling as a regression that includes a categorical input variable representing group membership. So, the group index is a factor with <span class="math inline">\(J\)</span> levels, corresponding to <span class="math inline">\(J\)</span> predictors in the regression model (or 2<span class="math inline">\(J\)</span>) in a varying intercept and slope model.</p>
<p>In either case, <span class="math inline">\(J-1\)</span> linear predictors are added to the model. The crucial step is that the <span class="math inline">\(J\)</span> coefficients are also given a model.</p>
<p>Multilevel models are a compromise between <em>complete pooling</em> and <em>no pooling</em>.</p>
<p>The code below is uses the radon data from Gelman (2007) and performs the regression for the <em>complete pooling</em> model.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="in-class-assignments.html#cb236-1" tabindex="-1"></a>srrs2 <span class="ot">&lt;-</span> <span class="fu">read.delim</span> (<span class="st">&quot;srrs2.dat&quot;</span>, <span class="at">header=</span>T, <span class="at">sep=</span><span class="st">&quot;,&quot;</span>)</span>
<span id="cb236-2"><a href="in-class-assignments.html#cb236-2" tabindex="-1"></a>mn <span class="ot">&lt;-</span> srrs2<span class="sc">$</span>state<span class="sc">==</span><span class="st">&quot;MN&quot;</span></span>
<span id="cb236-3"><a href="in-class-assignments.html#cb236-3" tabindex="-1"></a>radon <span class="ot">&lt;-</span> srrs2<span class="sc">$</span>activity[mn]</span>
<span id="cb236-4"><a href="in-class-assignments.html#cb236-4" tabindex="-1"></a>log.radon <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fu">ifelse</span> (radon<span class="sc">==</span><span class="dv">0</span>, .<span class="dv">1</span>, radon))</span>
<span id="cb236-5"><a href="in-class-assignments.html#cb236-5" tabindex="-1"></a></span>
<span id="cb236-6"><a href="in-class-assignments.html#cb236-6" tabindex="-1"></a>y <span class="ot">&lt;-</span> log.radon</span>
<span id="cb236-7"><a href="in-class-assignments.html#cb236-7" tabindex="-1"></a>x <span class="ot">&lt;-</span> srrs2<span class="sc">$</span>floor[mn]</span>
<span id="cb236-8"><a href="in-class-assignments.html#cb236-8" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x))</span></code></pre></div>
<p>The code below is uses the radon data from Gelman (2007) and performs the regression for the <em>no pooling</em> model.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="in-class-assignments.html#cb237-1" tabindex="-1"></a>srrs2 <span class="ot">&lt;-</span> <span class="fu">read.table</span> (<span class="st">&quot;srrs2.dat&quot;</span>, <span class="at">header=</span>T, <span class="at">sep=</span><span class="st">&quot;,&quot;</span>)</span>
<span id="cb237-2"><a href="in-class-assignments.html#cb237-2" tabindex="-1"></a>mn <span class="ot">&lt;-</span> srrs2<span class="sc">$</span>state<span class="sc">==</span><span class="st">&quot;MN&quot;</span></span>
<span id="cb237-3"><a href="in-class-assignments.html#cb237-3" tabindex="-1"></a>radon <span class="ot">&lt;-</span> srrs2<span class="sc">$</span>activity[mn]</span>
<span id="cb237-4"><a href="in-class-assignments.html#cb237-4" tabindex="-1"></a>log.radon <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fu">ifelse</span> (radon<span class="sc">==</span><span class="dv">0</span>, .<span class="dv">1</span>, radon))</span>
<span id="cb237-5"><a href="in-class-assignments.html#cb237-5" tabindex="-1"></a>county <span class="ot">&lt;-</span> srrs2<span class="sc">$</span>county[mn]</span>
<span id="cb237-6"><a href="in-class-assignments.html#cb237-6" tabindex="-1"></a>y <span class="ot">&lt;-</span> log.radon</span>
<span id="cb237-7"><a href="in-class-assignments.html#cb237-7" tabindex="-1"></a>x <span class="ot">&lt;-</span> srrs2<span class="sc">$</span>floor[mn]</span>
<span id="cb237-8"><a href="in-class-assignments.html#cb237-8" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x <span class="sc">+</span> <span class="fu">factor</span>(county) <span class="sc">-</span> <span class="dv">1</span>))</span></code></pre></div>
<p>Describe the output of the summary functions for the <em>complete</em> and <em>no</em> pooling models.</p>
<p>Both of the above models have problems. The complete pooling analysis ignores variation in average radon levels between counties. The goal of the anaysis is to identify counties with high radon homes…</p>
<p>The no pooling model has problems as well, We are parsing the data so much that the inference made for some counties is based on very low sample sizes.</p>
<p>Multilevel models are a compormise and considers partial pooling for unit-level predictors.</p>
<p>The simplest multilevel model is:</p>
<p><span class="math inline">\(y_{i} \sim N( \alpha_{j[i]}+\beta x_i,\sigma_y^2 )\)</span>, for <span class="math inline">\(i = 1, ..., n\)</span>.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="two-way-independent-anova.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="book_assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
